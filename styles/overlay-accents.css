/* ═══════════════════════════════════════════════════════════════
   OVERLAY ACCENT SYSTEM — CSS-only layers on top of visualizer canvases
   Coordinated with scroll position and visualizer parameters.
   All layers use pointer-events:none + position:absolute.
   No canvas resize — effects are pure CSS overlays.
   ═══════════════════════════════════════════════════════════════ */

/* ─── Gradient Wash Layer ──────────────────────────────────── */
.overlay-gradient-wash {
  border-radius: inherit;
}

/* ─── Multi-Instance Echo ──────────────────────────────────── */
.overlay-multi-echo {
  border-radius: inherit;
  overflow: hidden;
}

.overlay-multi-echo canvas {
  image-rendering: auto;
}

/* ─── Edge Glow Ring ───────────────────────────────────────── */
.overlay-edge-glow {
  border-radius: inherit;
}

/* ─── Particle Field ───────────────────────────────────────── */
.overlay-particle-field {
  border-radius: inherit;
}

/* Reuse the existing particle-drift keyframes if present,
   otherwise define them here */
@keyframes overlay-particle-drift {
  0%   { transform: translate(0, 0) scale(1); opacity: 0.6; }
  25%  { opacity: 0.5; }
  50%  { opacity: 0.35; }
  75%  { opacity: 0.15; }
  100% { transform: translate(var(--dx, 30px), var(--dy, -60px)) scale(0.3); opacity: 0; }
}

.overlay-particle-field span {
  animation-name: overlay-particle-drift;
}

/* ─── Crossfade Bridge ─────────────────────────────────────── */
.overlay-crossfade-bridge {
  backdrop-filter: blur(2px);
  -webkit-backdrop-filter: blur(2px);
}

/* ─── Transition Ripple ────────────────────────────────────── */
.overlay-transition-ripple {
  border-radius: 50%;
}

/* ═══════════════════════════════════════════════════════════════
   ENHANCED SECTION TRANSITION EFFECTS
   Smooth coordinated animations at section boundaries
   ═══════════════════════════════════════════════════════════════ */

/* ─── Luminance Streak: horizontal light bar at section junctions ── */
.section-divider::after {
  content: '';
  position: absolute;
  bottom: 0; left: 0; right: 0;
  height: 1px;
  background: linear-gradient(90deg,
    transparent 0%,
    hsla(var(--scroll-hue, 210), 70%, 55%, 0.0) 10%,
    hsla(var(--scroll-hue, 210), 70%, 55%, var(--divider-glow, 0)) 50%,
    hsla(var(--scroll-hue, 210), 70%, 55%, 0.0) 90%,
    transparent 100%
  );
  pointer-events: none;
  z-index: 21;
  transition: --divider-glow 0.3s ease-out;
}

/* ─── Section Entry Glow: radial light pulse on section headers ── */
.section-reveal[data-animate]::before {
  content: '';
  position: absolute;
  top: -50%; left: -25%; right: -25%;
  height: 200%;
  background: radial-gradient(
    ellipse 60% 40% at 50% 50%,
    hsla(var(--scroll-hue, 210), 60%, 50%, 0.04) 0%,
    transparent 70%
  );
  pointer-events: none;
  opacity: 0;
  transition: opacity 0.8s cubic-bezier(0.23, 1, 0.32, 1);
  z-index: -1;
}

.section-reveal[data-animate].revealed::before {
  opacity: 1;
}

/* ═══════════════════════════════════════════════════════════════
   INTER-SECTION BRIDGE EFFECTS
   Smooth visual continuity between sections without canvas resize
   ═══════════════════════════════════════════════════════════════ */

/* ─── Breath Line: subtle animated line between sections ──── */
@keyframes breath-line {
  0%, 100% { opacity: 0.1; transform: scaleX(0.3); }
  50%      { opacity: 0.4; transform: scaleX(1); }
}

.section-divider .breath-line {
  position: absolute;
  bottom: 50%; left: 10%; right: 10%;
  height: 1px;
  background: linear-gradient(90deg,
    transparent,
    hsla(var(--scroll-hue, 210), 80%, 60%, 0.5),
    transparent
  );
  animation: breath-line 3s ease-in-out infinite;
  pointer-events: none;
  z-index: 22;
}

/* ─── Cascade Card Entrance Stagger ──────────────────────── */
.cascade-card {
  will-change: transform, opacity, filter;
}

/* ─── UI Element Coordination ────────────────────────────── */

/* Morph stage labels: glass shimmer on transition */
@keyframes glass-shimmer {
  0%   { background-position: -200% center; }
  100% { background-position: 200% center; }
}

.morph-voice-label {
  background-image: linear-gradient(
    110deg,
    transparent 25%,
    rgba(255,255,255,0.06) 37%,
    transparent 63%
  );
  background-size: 200% 100%;
  background-clip: text;
  -webkit-background-clip: text;
}

.morph-voice.active .morph-voice-label {
  animation: glass-shimmer 2s ease-in-out;
}

/* ─── Triptych Content Stats: glow on reveal ─────────────── */
.stat-number {
  text-shadow: 0 0 0 transparent;
  transition: text-shadow 0.6s ease-out;
}

.stat-number.revealed {
  text-shadow: 0 0 20px hsla(var(--scroll-hue, 210), 70%, 55%, 0.3);
}

/* ─── Energy Section: Pulse ring on button ────────────────── */
@keyframes energy-pulse-ring {
  0%   { transform: scale(1); opacity: 0.4; }
  100% { transform: scale(2.2); opacity: 0; }
}

#energyBtn::after {
  content: '';
  position: absolute;
  inset: -4px;
  border-radius: inherit;
  border: 1px solid hsla(var(--scroll-hue, 210), 70%, 55%, 0.3);
  animation: energy-pulse-ring 2.5s ease-out infinite;
  pointer-events: none;
}

/* ─── Agent Cards: subtle depth shadow on hover ──────────── */
.agent-card {
  transition: transform 0.3s ease-out, box-shadow 0.3s ease-out;
}

.agent-card:hover {
  box-shadow:
    0 8px 32px rgba(0,0,0,0.4),
    0 0 20px hsla(var(--scroll-hue, 210), 60%, 50%, 0.08);
}

/* ═══════════════════════════════════════════════════════════════
   SCROLL-DRIVEN CSS CUSTOM PROPERTY ANIMATIONS
   These are set by JS and consumed by CSS for coordinated effects
   ═══════════════════════════════════════════════════════════════ */

:root {
  --divider-glow: 0;
  --overlay-hue: 210;
  --overlay-intensity: 0;
  --section-depth: 0;
}

/* ─── Canvas Wrapper: Subtle breathing scale at rest ─────── */
@keyframes canvas-breathe {
  0%, 100% { transform: scale(1); }
  50%      { transform: scale(1.003); }
}

.canvas-wrap {
  animation: canvas-breathe 8s ease-in-out infinite;
  animation-play-state: paused;
}

.canvas-wrap.breathing {
  animation-play-state: running;
}

/* ─── Reduced Motion ─────────────────────────────────────── */
@media (prefers-reduced-motion: reduce) {
  .overlay-gradient-wash,
  .overlay-multi-echo,
  .overlay-edge-glow,
  .overlay-particle-field,
  .overlay-crossfade-bridge,
  .overlay-transition-ripple {
    display: none !important;
  }

  .section-divider .breath-line {
    animation: none;
  }

  #energyBtn::after {
    animation: none;
  }

  .canvas-wrap.breathing {
    animation: none;
  }
}
