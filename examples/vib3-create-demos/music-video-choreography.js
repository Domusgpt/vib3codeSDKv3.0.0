/**
 * Music Video Choreography — Generated by /vib3-create skill
 *
 * A complete 80-second, 5-scene choreography spec ready to load
 * into ChoreographyPlayer. Synced to 120 BPM (500ms per beat).
 *
 * Usage:
 *   import { ChoreographyPlayer } from '../../src/creative/ChoreographyPlayer.js';
 *   import { MUSIC_VIDEO_SPEC } from './music-video-choreography.js';
 *
 *   const player = new ChoreographyPlayer(engine, {
 *       onSceneChange: (i, scene) => console.log(`Scene ${i}: ${scene.system}`),
 *       onComplete: () => console.log('Choreography finished')
 *   });
 *   player.load(MUSIC_VIDEO_SPEC);
 *   player.play();
 */

export const MUSIC_VIDEO_SPEC = {
    id: 'music-video-demo-001',
    name: 'Hyperspace Anthem',
    duration_ms: 80000,
    bpm: 120,
    scene_count: 5,
    scenes: [

        // ── INTRO (0-8s) ────────────────────────────────────────
        // Gentle ocean sphere slowly gaining density.
        // 16 beats at 120bpm. Quantum system for organic feel.
        {
            index: 0,
            time_start: 0,
            time_end: 8000,
            system: 'quantum',
            geometry: 2,           // sphere — smooth organic
            transition_in: {
                type: 'fade',
                duration: 1000
            },
            color_preset: 'Ocean',
            post_processing: ['vignette'],
            audio: null,
            tracks: {
                gridDensity: [
                    { time: 0, value: 10, easing: 'easeIn' },
                    { time: 8000, value: 30, easing: 'easeOut' }
                ],
                rot4dXW: [
                    { time: 0, value: 0, easing: 'linear' },
                    { time: 8000, value: 0.6, easing: 'easeInOut' }
                ],
                intensity: [
                    { time: 0, value: 0.0, easing: 'easeIn' },
                    { time: 2000, value: 0.6, easing: 'easeOut' }
                ],
                chaos: [
                    { time: 0, value: 0.0, easing: 'linear' },
                    { time: 8000, value: 0.05, easing: 'linear' }
                ]
            }
        },

        // ── VERSE (8-30s) ────────────────────────────────────────
        // Architectural hypercube with precise clean geometry.
        // 44 beats. Faceted system for crisp lines.
        // gridDensity builds from 20→60 creating sense of approach.
        {
            index: 1,
            time_start: 8000,
            time_end: 30000,
            system: 'faceted',
            geometry: 1,           // hypercube = tesseract
            transition_in: {
                type: 'crossfade',
                duration: 2000
            },
            color_preset: 'Monochrome',
            post_processing: [],
            audio: null,
            tracks: {
                gridDensity: [
                    { time: 0, value: 20, easing: 'linear' },
                    { time: 22000, value: 60, easing: 'easeInOut' }
                ],
                rot4dXY: [
                    { time: 0, value: 0, easing: 'linear' },
                    { time: 22000, value: 3.14159, easing: 'linear' }
                ],
                rot4dXW: [
                    { time: 0, value: 0.6, easing: 'easeInOut' },
                    { time: 11000, value: 1.2, easing: 'easeInOut' },
                    { time: 22000, value: 0.6, easing: 'easeInOut' }
                ],
                speed: [
                    { time: 0, value: 0.5, easing: 'linear' },
                    { time: 22000, value: 0.8, easing: 'linear' }
                ],
                dimension: [
                    { time: 0, value: 4.0, easing: 'easeInOut' },
                    { time: 22000, value: 3.5, easing: 'easeInOut' }
                ]
            }
        },

        // ── CHORUS (30-50s) ──────────────────────────────────────
        // FULL ENERGY. Holographic hypersphere+torus with neon colors,
        // bloom + chromatic aberration, and full audio reactivity.
        // 40 beats. This is the peak.
        {
            index: 2,
            time_start: 30000,
            time_end: 50000,
            system: 'holographic',
            geometry: 11,          // hypersphere + torus = flowing energy
            transition_in: {
                type: 'crossfade',
                duration: 1500
            },
            color_preset: 'Neon',
            post_processing: ['bloom', 'chromaticAberration'],
            audio: {
                bass: { target: 'morphFactor', weight: 0.8, mode: 'add' },
                mid: { target: 'rot4dXW', weight: 0.5, mode: 'add' },
                high: { target: 'intensity', weight: 0.3, mode: 'add' }
            },
            tracks: {
                speed: [
                    { time: 0, value: 1.5, easing: 'easeIn' },
                    { time: 10000, value: 2.0, easing: 'linear' },
                    { time: 20000, value: 1.5, easing: 'easeOut' }
                ],
                chaos: [
                    { time: 0, value: 0.2, easing: 'linear' },
                    { time: 10000, value: 0.4, easing: 'easeInOut' },
                    { time: 20000, value: 0.2, easing: 'linear' }
                ],
                rot4dYW: [
                    { time: 0, value: 0, easing: 'linear' },
                    { time: 20000, value: 6.2831853, easing: 'linear' }
                ],
                gridDensity: [
                    { time: 0, value: 40, easing: 'linear' },
                    { time: 10000, value: 60, easing: 'easeInOut' },
                    { time: 20000, value: 40, easing: 'linear' }
                ]
            }
        },

        // ── BRIDGE (50-65s) ──────────────────────────────────────
        // Chaotic breakdown. Hypertetra+fractal with elastic/bounce
        // easing on chaos parameter. Cyberpunk colors.
        // 30 beats. Chaos rises then falls dramatically.
        {
            index: 3,
            time_start: 50000,
            time_end: 65000,
            system: 'quantum',
            geometry: 21,          // hypertetra + fractal = jagged recursion
            transition_in: {
                type: 'cut',
                duration: 0
            },
            color_preset: 'Cyberpunk',
            post_processing: ['glitch', 'rgbShift'],
            audio: null,
            tracks: {
                chaos: [
                    { time: 0, value: 0.0, easing: 'elastic' },
                    { time: 7500, value: 0.8, easing: 'bounce' },
                    { time: 15000, value: 0.0, easing: 'easeOut' }
                ],
                rot4dXW: [
                    { time: 0, value: 0, easing: 'linear' },
                    { time: 15000, value: 6.2831853, easing: 'linear' }
                ],
                rot4dZW: [
                    { time: 0, value: 0, easing: 'linear' },
                    { time: 15000, value: 3.14159, easing: 'linear' }
                ],
                morphFactor: [
                    { time: 0, value: 0.0, easing: 'easeIn' },
                    { time: 5000, value: 1.5, easing: 'elastic' },
                    { time: 10000, value: 0.5, easing: 'bounce' },
                    { time: 15000, value: 0.0, easing: 'easeOut' }
                ],
                gridDensity: [
                    { time: 0, value: 30, easing: 'linear' },
                    { time: 7500, value: 80, easing: 'easeIn' },
                    { time: 15000, value: 30, easing: 'easeOut' }
                ],
                dimension: [
                    { time: 0, value: 3.5, easing: 'easeInOut' },
                    { time: 7500, value: 3.0, easing: 'easeIn' },
                    { time: 15000, value: 3.5, easing: 'easeOut' }
                ]
            }
        },

        // ── OUTRO (65-80s) ───────────────────────────────────────
        // Return to intro sphere. Fade to black.
        // 30 beats. Full circle — ocean sphere dissolving.
        {
            index: 4,
            time_start: 65000,
            time_end: 80000,
            system: 'quantum',
            geometry: 2,           // back to sphere
            transition_in: {
                type: 'crossfade',
                duration: 3000
            },
            color_preset: 'Ocean',
            post_processing: ['vignette'],
            audio: null,
            tracks: {
                intensity: [
                    { time: 0, value: 0.8, easing: 'linear' },
                    { time: 15000, value: 0.0, easing: 'easeOut' }
                ],
                gridDensity: [
                    { time: 0, value: 30, easing: 'linear' },
                    { time: 15000, value: 8, easing: 'easeOut' }
                ],
                rot4dXW: [
                    { time: 0, value: 0.6, easing: 'linear' },
                    { time: 15000, value: 0.0, easing: 'easeOut' }
                ],
                speed: [
                    { time: 0, value: 0.8, easing: 'linear' },
                    { time: 15000, value: 0.1, easing: 'easeOut' }
                ],
                chaos: [
                    { time: 0, value: 0.05, easing: 'linear' },
                    { time: 15000, value: 0.0, easing: 'linear' }
                ]
            }
        }
    ]
};

// ── Scene Descriptions (for describe_visual_state context) ───────────

export const SCENE_DESCRIPTIONS = [
    'Intro: Serene ocean sphere emerging from darkness, gentle 4D drift, slowly gaining density',
    'Verse: Architectural monochrome tesseract rotating through XY and XW planes, density building',
    'Chorus: PEAK ENERGY — neon holographic torus on hypersphere, audio-reactive, bloom + chromatic aberration',
    'Bridge: Chaotic cyberpunk breakdown — elastic/bounce chaos on hypertetra fractal, glitch + RGB shift',
    'Outro: Return to ocean sphere, all parameters fading to zero, dissolving into silence'
];

// ── Quick play helper ────────────────────────────────────────────────

/**
 * One-liner to load and play this choreography.
 * @param {Object} engine - VIB3Engine instance
 * @returns {ChoreographyPlayer} The player instance for control
 */
export function playMusicVideo(engine) {
    // Dynamic import to avoid bundling if unused
    return import('../../src/creative/ChoreographyPlayer.js').then(({ ChoreographyPlayer }) => {
        const player = new ChoreographyPlayer(engine, {
            onSceneChange: (i, scene) => {
                console.log(`[MusicVideo] Scene ${i}: ${SCENE_DESCRIPTIONS[i]}`);
            },
            onComplete: () => {
                console.log('[MusicVideo] Performance complete');
            }
        });
        player.load(MUSIC_VIDEO_SPEC);
        player.play();
        return player;
    });
}
