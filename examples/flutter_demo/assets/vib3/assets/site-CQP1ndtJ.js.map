{"version":3,"file":"site-CQP1ndtJ.js","sources":["../../site/js/ContextPool.js","../../site/js/adapters.js","../../site/js/CardTiltSystem.js","../../site/js/config.js","../../site/js/choreography.js","../../site/js/overlay-choreography.js","../../site/js/reveal-choreography.js","../../site/js/main.js"],"sourcesContent":["/**\n * GPU Context Pool\n *\n * Manages a limited number of WebGL contexts to stay within browser limits.\n * Handles acquire/release lifecycle with automatic eviction and canvas reset.\n *\n * Supports both single-canvas and 5-layer adapters. For 5-layer adapters\n * (Quantum, Holographic), the adapter's dispose() handles layer canvas cleanup.\n * The pool manages the placeholder canvas lifecycle.\n *\n * @example\n *   const pool = new ContextPool(3);\n *   const viz = pool.acquire('hero', 'hero-canvas', QuantumAdapter, opts);\n *   pool.release('hero');\n */\nexport class ContextPool {\n  constructor(max = 2) {\n    this.max = max;\n    this.slots = new Map();\n  }\n\n  has(key) { return this.slots.has(key); }\n  get(key) { return this.slots.get(key)?.adapter || null; }\n\n  acquire(key, canvasId, Factory, opts) {\n    if (this.slots.has(key)) return this.slots.get(key).adapter;\n\n    while (this.slots.size >= this.max) {\n      const oldest = this.slots.keys().next().value;\n      this.release(oldest);\n    }\n\n    this._resetCanvas(canvasId);\n\n    try {\n      const adapter = new Factory(canvasId, opts);\n      if (!adapter.active) {\n        console.warn(`[ContextPool] ${key} init failed on #${canvasId}`);\n        return null;\n      }\n      this.slots.set(key, { adapter, canvasId });\n      return adapter;\n    } catch (e) {\n      console.warn(`[ContextPool] ${key} threw:`, e);\n      return null;\n    }\n  }\n\n  release(key) {\n    const entry = this.slots.get(key);\n    if (!entry) return;\n    // Adapter.dispose() handles 5-layer cleanup (destroyLayerCanvases)\n    // and single-canvas WebGL context loss\n    try { entry.adapter.dispose(); } catch (_) { /* ignore */ }\n    // For single-canvas adapters, also force-lose the main canvas context\n    this._loseContext(entry.canvasId);\n    this.slots.delete(key);\n  }\n\n  releaseAll() {\n    for (const key of [...this.slots.keys()]) this.release(key);\n  }\n\n  _loseContext(canvasId) {\n    const canvas = document.getElementById(canvasId);\n    if (!canvas) return;\n    try {\n      const gl = canvas.getContext('webgl2') || canvas.getContext('webgl');\n      if (gl && !gl.isContextLost()) {\n        const ext = gl.getExtension('WEBGL_lose_context');\n        if (ext) ext.loseContext();\n      }\n    } catch (_) { /* ignore */ }\n  }\n\n  _resetCanvas(canvasId) {\n    const old = document.getElementById(canvasId);\n    if (!old) return;\n\n    // If a previous 5-layer setup left layer canvases, clean them up\n    const parent = old.parentElement;\n    if (parent && parent._vib3Layers) {\n      parent._vib3Layers.forEach(el => {\n        try {\n          const gl = el.getContext('webgl2') || el.getContext('webgl');\n          if (gl && !gl.isContextLost()) {\n            const ext = gl.getExtension('WEBGL_lose_context');\n            if (ext) ext.loseContext();\n          }\n        } catch (_) { /* ignore */ }\n        el.remove();\n      });\n      parent._vib3Layers = null;\n    }\n\n    // Restore placeholder visibility (may have been hidden by 5-layer setup)\n    old.style.display = '';\n\n    this._loseContext(canvasId);\n    const fresh = document.createElement('canvas');\n    fresh.id = canvasId;\n    fresh.className = old.className;\n    if (old.style.cssText) fresh.style.cssText = old.style.cssText;\n    const parentEl = old.parentElement;\n    if (parentEl) {\n      const dpr = Math.min(devicePixelRatio || 1, 2);\n      fresh.width = parentEl.clientWidth * dpr;\n      fresh.height = parentEl.clientHeight * dpr;\n    }\n    old.parentNode.replaceChild(fresh, old);\n  }\n}\n","/**\n * VIB3+ System Adapters — 5-Layer Architecture\n *\n * Each GPU adapter (Quantum, Holographic) creates a full 5-layer canvas stack:\n *   background → shadow → content → highlight → accent\n *\n * This matches the REAL VIB3+ visualization architecture with per-layer\n * role params (density, speed, color shift, reactivity multipliers).\n *\n * Faceted uses single-canvas mode (its shader is a unified fragment program).\n * AmbientLattice is a lightweight Canvas2D accent — NOT a visualization system.\n */\n\nimport { QuantumEngine } from '../../src/quantum/QuantumEngine.js';\nimport { RealHolographicSystem } from '../../src/holograms/RealHolographicSystem.js';\nimport { FacetedSystem } from '../../src/faceted/FacetedSystem.js';\n\nconst DEFAULT_PARAMS = {\n  geometry: 3, hue: 200, gridDensity: 24, speed: 1.0,\n  morphFactor: 0.5, chaos: 0.2, intensity: 0.7, saturation: 0.8,\n  rot4dXW: 0, rot4dYW: 0, rot4dZW: 0, rot4dXY: 0, rot4dXZ: 0, rot4dYZ: 0,\n  dimension: 3.5,\n};\n\n// 5-layer roles with CSS compositing properties\nconst LAYER_ROLES = [\n  { role: 'background', zIndex: 1, opacity: 0.35 },\n  { role: 'shadow',     zIndex: 2, opacity: 0.25 },\n  { role: 'content',    zIndex: 3, opacity: 0.95 },\n  { role: 'highlight',  zIndex: 4, opacity: 0.6  },\n  { role: 'accent',     zIndex: 5, opacity: 0.5  },\n];\n\n/**\n * Create 5 stacked canvases inside a parent container.\n * Returns an object mapping role name → HTMLCanvasElement.\n * Also stores references on the parent element for cleanup.\n */\nfunction createLayerCanvases(parentCanvasId) {\n  const placeholder = document.getElementById(parentCanvasId);\n  if (!placeholder) return null;\n\n  const parent = placeholder.parentElement;\n  if (!parent) return null;\n\n  const dpr = Math.min(devicePixelRatio || 1, 2);\n  const w = parent.clientWidth * dpr;\n  const h = parent.clientHeight * dpr;\n\n  // Hide the original single canvas — we replace it with 5 layers\n  placeholder.style.display = 'none';\n\n  const canvases = {};\n  const createdEls = [];\n\n  LAYER_ROLES.forEach(({ role, zIndex, opacity }) => {\n    const canvas = document.createElement('canvas');\n    canvas.className = 'vib3-canvas vib3-layer';\n    canvas.dataset.role = role;\n    canvas.dataset.parentId = parentCanvasId;\n    canvas.width = w;\n    canvas.height = h;\n    canvas.style.cssText = `\n      display: block; position: absolute; top: 0; left: 0;\n      width: 100%; height: 100%;\n      z-index: ${zIndex};\n      opacity: ${opacity};\n      pointer-events: ${role === 'content' ? 'auto' : 'none'};\n    `;\n    parent.appendChild(canvas);\n    canvases[role] = canvas;\n    createdEls.push(canvas);\n  });\n\n  // Store refs for cleanup\n  parent._vib3Layers = createdEls;\n  parent._vib3Placeholder = placeholder;\n\n  return canvases;\n}\n\n/**\n * Remove 5-layer canvases and restore the original placeholder canvas.\n */\nfunction destroyLayerCanvases(parentCanvasId) {\n  const placeholder = document.getElementById(parentCanvasId);\n  if (!placeholder) return;\n\n  const parent = placeholder.parentElement;\n  if (!parent) return;\n\n  // Remove created layer canvases\n  if (parent._vib3Layers) {\n    parent._vib3Layers.forEach(el => {\n      // Force-lose WebGL context before removing\n      try {\n        const gl = el.getContext('webgl2') || el.getContext('webgl');\n        if (gl && !gl.isContextLost()) {\n          const ext = gl.getExtension('WEBGL_lose_context');\n          if (ext) ext.loseContext();\n        }\n      } catch (_) { /* ignore */ }\n      el.remove();\n    });\n    parent._vib3Layers = null;\n  }\n\n  // Restore placeholder visibility\n  placeholder.style.display = '';\n}\n\n/** Wire mouse/touch interaction to a callback */\nfunction wireInteraction(canvas, onMove, onLeave) {\n  const handlers = {};\n  handlers.mouse = (e) => {\n    const r = canvas.getBoundingClientRect();\n    onMove((e.clientX - r.left) / r.width, (e.clientY - r.top) / r.height, 0.8);\n  };\n  handlers.touch = (e) => {\n    if (!e.touches.length) return;\n    const t = e.touches[0], r = canvas.getBoundingClientRect();\n    onMove((t.clientX - r.left) / r.width, (t.clientY - r.top) / r.height, 0.9);\n  };\n  handlers.leave = () => onLeave();\n  canvas.addEventListener('mousemove', handlers.mouse);\n  canvas.addEventListener('touchmove', handlers.touch, { passive: true });\n  canvas.addEventListener('mouseleave', handlers.leave);\n  return handlers;\n}\n\nfunction unwireInteraction(canvas, handlers) {\n  if (!canvas || !handlers) return;\n  canvas.removeEventListener('mousemove', handlers.mouse);\n  canvas.removeEventListener('touchmove', handlers.touch);\n  canvas.removeEventListener('mouseleave', handlers.leave);\n}\n\nfunction observeResize(el, onResize) {\n  const parent = el.parentElement || el;\n  if (!parent) return null;\n  const obs = new ResizeObserver(() => {\n    onResize(parent.clientWidth, parent.clientHeight, Math.min(devicePixelRatio || 1, 2));\n  });\n  obs.observe(parent);\n  return obs;\n}\n\n// ─── Quantum Adapter (5-Layer) ───────────────────────────────────\n\nexport class QuantumAdapter {\n  constructor(canvasId, opts = {}) {\n    this.canvasId = canvasId;\n    this.active = true;\n    this.params = { ...DEFAULT_PARAMS, ...opts };\n\n    // Create 5-layer canvas stack\n    const canvases = createLayerCanvases(canvasId);\n    if (!canvases) {\n      this.active = false;\n      return;\n    }\n    this._layerCanvases = canvases;\n\n    // Content layer is the interaction target\n    this.canvas = canvases.content;\n\n    try {\n      // Pass 5 canvases → engine creates 5 visualizers with proper roles\n      this.engine = new QuantumEngine({ canvases, autoStart: true });\n      this.engine.setActive(true);\n      this.engine.updateParameters(this.params);\n    } catch (e) {\n      console.warn('Quantum 5-layer init failed', e);\n      this.active = false;\n      destroyLayerCanvases(canvasId);\n      return;\n    }\n\n    this._handlers = wireInteraction(this.canvas,\n      (x, y, i) => this.engine.updateInteraction(x, y, i),\n      () => this.engine.updateInteraction(0.5, 0.5, 0),\n    );\n    this._resizeObs = observeResize(this.canvas, (w, h, dpr) => {\n      this.engine.resize(w, h, dpr);\n      // Also resize all layer canvases\n      Object.values(this._layerCanvases).forEach(c => {\n        c.width = w * dpr;\n        c.height = h * dpr;\n      });\n    });\n  }\n\n  setParam(k, v) { this.params[k] = v; this.engine?.updateParameter(k, v); }\n  setParams(o) { Object.assign(this.params, o); this.engine?.updateParameters(o); }\n  render() { if (this.active) this.engine?.updateParameters(this.params); }\n  dispose() {\n    this.active = false;\n    unwireInteraction(this.canvas, this._handlers);\n    this._resizeObs?.disconnect();\n    try { this.engine?.dispose(); } catch (_) { /* ignore */ }\n    destroyLayerCanvases(this.canvasId);\n  }\n}\n\n// ─── Holographic Adapter (5-Layer) ───────────────────────────────\n\nexport class HolographicAdapter {\n  constructor(canvasId, opts = {}) {\n    this.canvasId = canvasId;\n    this.active = true;\n    this.params = { ...DEFAULT_PARAMS, ...opts };\n\n    // Create 5-layer canvas stack\n    const canvases = createLayerCanvases(canvasId);\n    if (!canvases) {\n      this.active = false;\n      return;\n    }\n    this._layerCanvases = canvases;\n    this.canvas = canvases.content;\n\n    try {\n      // Pass 5 canvases → system creates 5 visualizers with proper roles\n      this.system = new RealHolographicSystem({ canvases });\n      this.system.setActive(true);\n      for (const [k, v] of Object.entries(this.params)) {\n        this.system.updateParameter(k, v);\n      }\n    } catch (e) {\n      console.warn('Holographic 5-layer init failed', e);\n      this.active = false;\n      destroyLayerCanvases(canvasId);\n      return;\n    }\n\n    // Holographic system is audio-reactive, no mouse/touch interaction API\n    this._resizeObs = observeResize(this.canvas, (w, h, dpr) => {\n      this.system.resize(w, h, dpr);\n      Object.values(this._layerCanvases).forEach(c => {\n        c.width = w * dpr;\n        c.height = h * dpr;\n      });\n    });\n  }\n\n  setParam(k, v) { this.params[k] = v; this.system?.updateParameter(k, v); }\n  setParams(o) {\n    Object.assign(this.params, o);\n    for (const [k, v] of Object.entries(o)) this.system?.updateParameter(k, v);\n  }\n  render() {\n    if (!this.active) return;\n    for (const [k, v] of Object.entries(this.params)) this.system?.updateParameter(k, v);\n  }\n  dispose() {\n    this.active = false;\n    this._resizeObs?.disconnect();\n    try { this.system?.dispose(); } catch (_) { /* ignore */ }\n    destroyLayerCanvases(this.canvasId);\n  }\n}\n\n// ─── Faceted Adapter (Single Canvas — unified fragment shader) ───\n\nexport class FacetedAdapter {\n  constructor(canvasId, opts = {}) {\n    const canvas = document.getElementById(canvasId);\n    if (!canvas) { this.active = false; return; }\n    this.canvas = canvas;\n    this.canvasId = canvasId;\n    this.params = { ...DEFAULT_PARAMS, ...opts };\n\n    try {\n      this.faceted = new FacetedSystem();\n      const ok = this.faceted.initDirect(canvas);\n      if (ok) {\n        this.active = true;\n        this.faceted.updateParameters(this.params);\n      } else {\n        console.warn('Faceted initDirect failed');\n        this.active = false;\n        return;\n      }\n    } catch (e) {\n      console.warn('Faceted init error', e);\n      this.active = false;\n      return;\n    }\n\n    this._resizeObs = observeResize(canvas, (w, h, dpr) => this.faceted.resize(w, h, dpr));\n  }\n\n  setParam(k, v) { this.params[k] = v; this.faceted?.updateParameters({ [k]: v }); }\n  setParams(o) { Object.assign(this.params, o); this.faceted?.updateParameters(o); }\n  render() { if (this.active) this.faceted?.updateParameters(this.params); }\n  dispose() {\n    this.active = false;\n    this._resizeObs?.disconnect();\n    try { this.faceted?.stop(); this.faceted?.dispose(); } catch (_) { /* ignore */ }\n  }\n}\n\n// ─── Ambient Lattice (Canvas 2D accent — no GPU context) ────────\n// Complementary accent renderer: ambient nebula → lattice geometry → glow pass\n// NOT a visualization system — a lightweight parallax-ready atmosphere layer.\n// Uses globalCompositeOperation 'lighter' for additive glow.\n\nexport class AmbientLattice {\n  constructor(canvasId, opts = {}) {\n    this.canvas = document.getElementById(canvasId);\n    if (!this.canvas) { this.active = false; return; }\n    this.ctx = this.canvas.getContext('2d');\n    this.active = true;\n    this.params = {\n      geometry: 3, hue: 180, gridDensity: 24, speed: 1.0,\n      morphFactor: 0.5, chaos: 0.2, intensity: 0.7,\n      rot4dXW: 0, rot4dYW: 0, rot4dZW: 0, dimension: 3.5,\n      saturation: 0.8, ...opts,\n    };\n    this.resize();\n    this._ro = new ResizeObserver(() => this.resize());\n    this._ro.observe(this.canvas.parentElement);\n  }\n\n  resize() {\n    if (!this.canvas) return;\n    const p = this.canvas.parentElement;\n    const dpr = Math.min(devicePixelRatio || 1, 2);\n    this.canvas.width = p.clientWidth * dpr;\n    this.canvas.height = p.clientHeight * dpr;\n    this.w = this.canvas.width;\n    this.h = this.canvas.height;\n  }\n\n  setParam(k, v) { this.params[k] = v; }\n  setParams(o) { Object.assign(this.params, o); }\n\n  render(time) {\n    if (!this.active || !this.ctx) return;\n    const { ctx, w, h, params: p } = this;\n    const t = time * p.speed * 0.001;\n    const geo = Math.floor(p.geometry) % 24;\n    const base = geo % 8, core = Math.floor(geo / 8);\n    const cx = w / 2, cy = h / 2;\n    const sc = Math.max(w, h) * 0.55;\n    const density = Math.max(4, Math.floor(p.gridDensity));\n    const dim = p.dimension || 3.5;\n    const sat = Math.round((p.saturation ?? 0.8) * 100);\n    const mx = p.mouseX ?? 0.5, my = p.mouseY ?? 0.5;\n    const mouseShift = (mx - 0.5) * 0.3;\n\n    // ── Layer 0: Deep background ──\n    ctx.globalCompositeOperation = 'source-over';\n    ctx.globalAlpha = 1;\n    const bgR = Math.max(w, h) * 0.85;\n    const bg = ctx.createRadialGradient(cx + (mx - 0.5) * w * 0.2, cy + (my - 0.5) * h * 0.2, 0, cx, cy, bgR);\n    bg.addColorStop(0, `hsla(${p.hue}, ${sat}%, 12%, 1)`);\n    bg.addColorStop(0.4, `hsla(${(p.hue + 20) % 360}, ${sat}%, 6%, 1)`);\n    bg.addColorStop(1, `hsla(${(p.hue + 40) % 360}, ${Math.max(0, sat - 20)}%, 2%, 1)`);\n    ctx.fillStyle = bg;\n    ctx.fillRect(0, 0, w, h);\n\n    // ── Layer 1: Nebula clouds ──\n    const nebulaAlpha = 0.25 + p.intensity * 0.35;\n    for (let n = 0; n < 4; n++) {\n      const nAng = t * 0.12 + n * 1.57 + (p.rot4dZW || 0) * 0.5 + mouseShift;\n      const nR = sc * (0.7 + Math.sin(t * 0.25 + n * 1.2) * 0.4);\n      const nx = cx + Math.cos(nAng) * sc * 0.35;\n      const ny = cy + Math.sin(nAng) * sc * 0.3;\n      const nGrad = ctx.createRadialGradient(nx, ny, 0, nx, ny, nR);\n      const nHue = (p.hue + n * 80 + core * 50) % 360;\n      nGrad.addColorStop(0, `hsla(${nHue}, ${sat}%, 50%, ${nebulaAlpha})`);\n      nGrad.addColorStop(0.3, `hsla(${nHue}, ${Math.max(0, sat - 10)}%, 35%, ${nebulaAlpha * 0.6})`);\n      nGrad.addColorStop(0.7, `hsla(${(nHue + 30) % 360}, ${sat}%, 20%, ${nebulaAlpha * 0.2})`);\n      nGrad.addColorStop(1, `hsla(${nHue}, ${sat}%, 10%, 0)`);\n      ctx.fillStyle = nGrad;\n      ctx.fillRect(0, 0, w, h);\n    }\n\n    // ── Layer 2: Primary geometry ──\n    ctx.globalAlpha = Math.min(1, p.intensity * 1.2);\n    const halfDensity = Math.ceil(density / 2);\n\n    for (let i = 0; i < density; i++) {\n      const f = i / density;\n      const ang = f * Math.PI * 2 + t + (p.rot4dXW || 0) + mouseShift * 2;\n      const hShift = (p.hue + f * 120 + core * 60) % 360;\n      const w4 = Math.sin(t * 0.5 + f * 3.14 + (p.rot4dYW || 0)) * 0.4;\n      const pf = 1.0 / (dim - w4);\n      const strokeAlpha = 0.45 + p.chaos * 0.4 + p.intensity * 0.15;\n      const fillAlpha = 0.12 + p.chaos * 0.15 + (i < halfDensity ? 0.08 : 0);\n      ctx.strokeStyle = `hsla(${hShift}, ${sat}%, 65%, ${strokeAlpha})`;\n      ctx.fillStyle = `hsla(${hShift}, ${Math.max(0, sat - 5)}%, 45%, ${fillAlpha})`;\n      ctx.lineWidth = 2 + p.morphFactor * 1.5 + (i === 0 ? 1.5 : 0);\n      ctx.beginPath();\n      this._drawGeometry(ctx, base, cx, cy, sc, pf, f, ang, t, w, h, p);\n      ctx.fill();\n      ctx.stroke();\n\n      if (core > 0 && i % 2 === 0) {\n        const warpHue = (hShift + 180) % 360;\n        ctx.strokeStyle = `hsla(${warpHue}, ${sat}%, 60%, ${0.25 + p.chaos * 0.25})`;\n        ctx.lineWidth = 1.5 + p.morphFactor * 0.8;\n        ctx.beginPath();\n        if (core === 1) {\n          const hR = sc * f * pf * 1.2;\n          const wobble = Math.sin(t + f * 5 + (p.rot4dZW || 0)) * sc * 0.08;\n          ctx.arc(cx + wobble, cy - wobble * 0.7, Math.max(3, hR), 0, Math.PI * 2);\n        } else {\n          for (let v = 0; v < 5; v++) {\n            const a = f * Math.PI * 2 / 5 * v + t * 0.3 + (p.rot4dZW || 0);\n            const r = sc * (0.35 + f * 0.35) * pf;\n            v === 0 ? ctx.moveTo(cx + Math.cos(a) * r, cy + Math.sin(a) * r)\n                     : ctx.lineTo(cx + Math.cos(a) * r, cy + Math.sin(a) * r);\n          }\n          ctx.closePath();\n        }\n        ctx.stroke();\n      }\n    }\n\n    // ── Layer 3: Additive glow ──\n    ctx.globalCompositeOperation = 'lighter';\n    ctx.globalAlpha = Math.min(1, p.intensity * 0.8);\n    const glowR = sc * (0.55 + Math.sin(t * 0.7) * 0.2);\n    const glowGrad = ctx.createRadialGradient(\n      cx + (mx - 0.5) * sc * 0.3, cy + (my - 0.5) * sc * 0.3, 0, cx, cy, glowR\n    );\n    const glowHue = (p.hue + Math.sin(t * 0.3) * 30) % 360;\n    glowGrad.addColorStop(0, `hsla(${glowHue}, ${sat}%, 65%, ${0.3 + p.chaos * 0.2})`);\n    glowGrad.addColorStop(0.4, `hsla(${glowHue}, ${sat}%, 45%, ${0.12 + p.chaos * 0.1})`);\n    glowGrad.addColorStop(1, `hsla(${glowHue}, ${sat}%, 20%, 0)`);\n    ctx.fillStyle = glowGrad;\n    ctx.fillRect(0, 0, w, h);\n\n    const glowCount = Math.min(12, Math.floor(density / 2));\n    for (let i = 0; i < glowCount; i++) {\n      const f = i / glowCount;\n      const ang = f * Math.PI * 2 + t * 0.8 + (p.rot4dXW || 0);\n      const w4 = Math.sin(t * 0.5 + f * 3.14 + (p.rot4dYW || 0)) * 0.4;\n      const pf = 1.0 / (dim - w4);\n      const hShift = (p.hue + f * 120 + core * 60) % 360;\n      const gx = cx + Math.cos(ang) * sc * (0.2 + f * 0.6) * pf;\n      const gy = cy + Math.sin(ang) * sc * (0.2 + f * 0.6) * pf;\n      const dotR = 5 + p.morphFactor * 6 + Math.sin(t * 2 + f * 10) * 3;\n      const dotGrad = ctx.createRadialGradient(gx, gy, 0, gx, gy, dotR * 4);\n      dotGrad.addColorStop(0, `hsla(${hShift}, ${sat}%, 80%, 0.6)`);\n      dotGrad.addColorStop(0.25, `hsla(${hShift}, ${sat}%, 60%, 0.25)`);\n      dotGrad.addColorStop(1, `hsla(${hShift}, ${sat}%, 40%, 0)`);\n      ctx.fillStyle = dotGrad;\n      ctx.fillRect(gx - dotR * 4, gy - dotR * 4, dotR * 8, dotR * 8);\n    }\n\n    // ── Layer 4: Edge highlights ──\n    ctx.globalCompositeOperation = 'source-over';\n    ctx.globalAlpha = Math.min(1, p.intensity * 0.9);\n    const edgeCount = Math.min(density, 16);\n    for (let i = 0; i < edgeCount; i++) {\n      const f = i / edgeCount;\n      const ang = f * Math.PI * 2 + t * 1.1 + (p.rot4dXW || 0) * 1.2;\n      const hShift = (p.hue + f * 80 + 30) % 360;\n      const w4 = Math.sin(t * 0.5 + f * 3.14 + (p.rot4dYW || 0)) * 0.4;\n      const pf = 1.0 / (dim - w4);\n      ctx.strokeStyle = `hsla(${hShift}, ${Math.min(100, sat + 15)}%, 78%, ${0.35 + p.chaos * 0.3})`;\n      ctx.lineWidth = 0.8 + p.morphFactor * 0.5;\n      ctx.beginPath();\n      this._drawGeometry(ctx, base, cx, cy, sc * 0.92, pf, f, ang + 0.1, t, w, h, p);\n      ctx.stroke();\n    }\n\n    ctx.globalCompositeOperation = 'source-over';\n    ctx.globalAlpha = 1;\n  }\n\n  _drawGeometry(ctx, base, cx, cy, sc, pf, f, ang, t, w, h, p) {\n    switch (base) {\n      case 0: {\n        const sides = 3 + Math.floor(p.morphFactor);\n        for (let j = 0; j <= sides; j++) {\n          const a = ang + j * (Math.PI * 2 / sides), r = sc * (0.3 + f * 0.7) * pf;\n          j === 0 ? ctx.moveTo(cx + Math.cos(a) * r, cy + Math.sin(a) * r)\n                   : ctx.lineTo(cx + Math.cos(a) * r, cy + Math.sin(a) * r);\n        }\n        ctx.closePath();\n        break;\n      }\n      case 1: {\n        const s = sc * (0.2 + f * 0.6) * pf;\n        const rot = t * 0.3 + f * 0.5 + (p.rot4dXW || 0);\n        ctx.save();\n        ctx.translate(cx, cy);\n        ctx.rotate(rot);\n        ctx.rect(-s / 2, -s / 2, s, s);\n        const s2 = s * 0.55;\n        const off = Math.sin(t + f * 2) * s * 0.15;\n        ctx.rect(-s2 / 2 + off, -s2 / 2 + off, s2, s2);\n        ctx.restore();\n        break;\n      }\n      case 2: {\n        const wobX = Math.sin(t + f * 2) * sc * 0.05;\n        const wobY = Math.cos(t + f * 2) * sc * 0.05;\n        ctx.arc(cx + wobX, cy + wobY, Math.max(2, sc * f * pf), 0, Math.PI * 2);\n        break;\n      }\n      case 3: {\n        const tr = sc * 0.5 * pf, to = sc * (0.15 + f * 0.15);\n        const tx = cx + Math.cos(ang) * tr;\n        const ty = cy + Math.sin(ang) * tr;\n        ctx.arc(tx, ty, Math.max(2, to * pf), 0, Math.PI * 2);\n        break;\n      }\n      case 4:\n        for (let k = 0; k <= 48; k++) {\n          const kt = k / 48 * Math.PI * 2;\n          const kr = sc * (0.3 + 0.15 * Math.sin(kt * 2 + t)) * pf;\n          const twist = 1 + 0.4 * Math.sin(kt * 3 + t * 1.5);\n          const kx = cx + Math.cos(kt + ang) * kr * twist;\n          const ky = cy + Math.sin(kt + ang) * kr;\n          k === 0 ? ctx.moveTo(kx, ky) : ctx.lineTo(kx, ky);\n        }\n        ctx.closePath();\n        break;\n      case 5: {\n        const fl = sc * 0.5 * pf, fa = ang + t * 0.2;\n        const depth = 1 + Math.floor(p.morphFactor * 2);\n        this._fractalTriangle(ctx, cx, cy, fl * (0.3 + f * 0.7), fa, depth);\n        break;\n      }\n      case 6:\n        for (let x = 0; x < w; x += 3) {\n          const wf = x / w;\n          const wave1 = Math.sin(wf * p.gridDensity * 0.5 + t + f * 3);\n          const wave2 = Math.sin(wf * p.gridDensity * 0.3 - t * 0.7 + f * 5) * 0.5;\n          const wy = cy + (wave1 + wave2) * sc * 0.25 * pf * (0.5 + f);\n          x === 0 ? ctx.moveTo(x, wy) : ctx.lineTo(x, wy);\n        }\n        break;\n      case 7: {\n        const cl = sc * 0.45 * pf, ca = ang + f * 0.5;\n        for (let ci = 0; ci < 8; ci++) {\n          const a2 = ca + ci * Math.PI / 4;\n          const len = cl * (0.4 + f * 0.6) * (ci % 2 === 0 ? 1 : 0.6);\n          ctx.moveTo(cx, cy);\n          ctx.lineTo(cx + Math.cos(a2) * len, cy + Math.sin(a2) * len);\n          if (ci > 0) {\n            const prevA = ca + (ci - 1) * Math.PI / 4;\n            const prevLen = cl * (0.4 + f * 0.6) * ((ci - 1) % 2 === 0 ? 1 : 0.6);\n            ctx.moveTo(cx + Math.cos(prevA) * prevLen * 0.7, cy + Math.sin(prevA) * prevLen * 0.7);\n            ctx.lineTo(cx + Math.cos(a2) * len * 0.7, cy + Math.sin(a2) * len * 0.7);\n          }\n        }\n        break;\n      }\n    }\n  }\n\n  _fractalTriangle(ctx, x, y, size, angle, depth) {\n    if (depth <= 0 || size < 3) {\n      for (let j = 0; j < 3; j++) {\n        const a = angle + j * 2.094;\n        j === 0 ? ctx.moveTo(x + Math.cos(a) * size, y + Math.sin(a) * size)\n                 : ctx.lineTo(x + Math.cos(a) * size, y + Math.sin(a) * size);\n      }\n      ctx.closePath();\n      return;\n    }\n    for (let j = 0; j < 3; j++) {\n      const a = angle + j * 2.094;\n      j === 0 ? ctx.moveTo(x + Math.cos(a) * size, y + Math.sin(a) * size)\n               : ctx.lineTo(x + Math.cos(a) * size, y + Math.sin(a) * size);\n    }\n    ctx.closePath();\n    for (let j = 0; j < 3; j++) {\n      const a = angle + j * 2.094;\n      this._fractalTriangle(ctx, x + Math.cos(a) * size * 0.5, y + Math.sin(a) * size * 0.5, size * 0.45, angle + 0.2, depth - 1);\n    }\n  }\n\n  dispose() { this.active = false; this._ro?.disconnect(); }\n}\n","/**\n * Card Tilt System\n *\n * Maps mouse/touch position over registered elements to:\n *   1. CSS 3D transforms (perspective + rotateX/Y) with smooth interpolation\n *   2. Visualizer parameter offsets (4D rotation, speed, chaos, density, hue)\n *   3. CSS custom properties for specular highlights and glare effects\n *\n * Designed to compose with scroll-driven choreography:\n *   - Choreography sets `el.dataset.scrollTransform` for scale/position\n *   - This system prepends perspective + rotation\n *   - Both coexist without conflict\n *\n * Usage:\n *   const tilt = new CardTiltSystem({ maxTilt: 18 });\n *   tilt.register(cardEl, canvasAdapter, { affectsRotation: true });\n *   tilt.setTilt(cardEl, 0.5, -0.3);   // programmatic\n *   tilt.releaseTilt(cardEl);           // return to mouse control\n *   tilt.dispose();\n */\nexport class CardTiltSystem {\n  constructor(options = {}) {\n    this.maxTilt = options.maxTilt || 15;\n    this.perspective = options.perspective || 1200;\n    this.smoothing = options.smoothing || 0.12;\n    this.returnSpeed = options.returnSpeed || 0.06;\n    this.cards = new Map();\n    this._active = true;\n    this._rafId = null;\n    // Scroll velocity tracking for push displacement (Event 18)\n    this._scrollY = 0;\n    this._scrollVelocity = 0;\n    this._lastScrollTime = 0;\n    this._initScrollTracking();\n    this._startLoop();\n  }\n\n  /**\n   * Register an element for tilt tracking.\n   * @param {HTMLElement} el - The card/element to tilt\n   * @param {object|null} adapter - Visualizer adapter (setParams/setParam), or null for CSS-only\n   * @param {object} config - Per-card configuration overrides\n   */\n  register(el, adapter = null, config = {}) {\n    if (!el || this.cards.has(el)) return;\n\n    const entry = {\n      el,\n      adapter,\n      cfg: {\n        maxTilt: config.maxTilt ?? this.maxTilt,\n        perspective: config.perspective ?? this.perspective,\n        sensitivity: config.sensitivity ?? 1.0,\n        // Parameter mapping toggles\n        affectsRotation: config.affectsRotation !== false,\n        affectsSpeed: config.affectsSpeed ?? false,\n        affectsChaos: config.affectsChaos ?? false,\n        affectsDensity: config.affectsDensity ?? false,\n        affectsHue: config.affectsHue ?? false,\n        // Mapping scales\n        rotationScale: config.rotationScale ?? 1.2,\n        speedScale: config.speedScale ?? 0.4,\n        chaosScale: config.chaosScale ?? 0.25,\n        densityScale: config.densityScale ?? 0.25,\n        hueScale: config.hueScale ?? 25,\n      },\n      // Smoothed current\n      tx: 0, ty: 0,\n      // Raw target\n      gx: 0, gy: 0,\n      hovering: false,\n      programmatic: false,\n    };\n\n    // Per-card event wiring\n    const onEnter = () => { entry.hovering = true; };\n    const onLeave = () => {\n      entry.hovering = false;\n      if (!entry.programmatic) { entry.gx = 0; entry.gy = 0; }\n    };\n    const onMove = (e) => {\n      if (entry.programmatic) return;\n      const r = el.getBoundingClientRect();\n      entry.gx = ((e.clientX - r.left) / r.width * 2 - 1) * entry.cfg.sensitivity;\n      entry.gy = ((e.clientY - r.top) / r.height * 2 - 1) * entry.cfg.sensitivity;\n    };\n    const onTouchMove = (e) => {\n      if (entry.programmatic || !e.touches.length) return;\n      entry.hovering = true;\n      const t = e.touches[0], r = el.getBoundingClientRect();\n      entry.gx = ((t.clientX - r.left) / r.width * 2 - 1) * entry.cfg.sensitivity;\n      entry.gy = ((t.clientY - r.top) / r.height * 2 - 1) * entry.cfg.sensitivity;\n    };\n\n    entry._h = { onEnter, onLeave, onMove, onTouchMove };\n    el.addEventListener('mouseenter', onEnter);\n    el.addEventListener('mouseleave', onLeave);\n    el.addEventListener('mousemove', onMove);\n    el.addEventListener('touchmove', onTouchMove, { passive: true });\n    el.addEventListener('touchend', onLeave);\n\n    el.style.transformStyle = 'preserve-3d';\n    this.cards.set(el, entry);\n    return entry;\n  }\n\n  unregister(el) {\n    const e = this.cards.get(el);\n    if (!e) return;\n    const h = e._h;\n    el.removeEventListener('mouseenter', h.onEnter);\n    el.removeEventListener('mouseleave', h.onLeave);\n    el.removeEventListener('mousemove', h.onMove);\n    el.removeEventListener('touchmove', h.onTouchMove);\n    el.removeEventListener('touchend', h.onLeave);\n    el.style.transform = '';\n    this.cards.delete(el);\n  }\n\n  /** Update the adapter reference (e.g. after GPU context swap). */\n  setAdapter(el, adapter) {\n    const e = this.cards.get(el);\n    if (e) e.adapter = adapter;\n  }\n\n  /** Programmatic tilt (-1..1 range). */\n  setTilt(el, x, y) {\n    const e = this.cards.get(el);\n    if (!e) return;\n    e.programmatic = true;\n    e.gx = x; e.gy = y;\n  }\n\n  /** Release programmatic control; return to mouse-driven. */\n  releaseTilt(el) {\n    const e = this.cards.get(el);\n    if (!e) return;\n    e.programmatic = false;\n    if (!e.hovering) { e.gx = 0; e.gy = 0; }\n  }\n\n  // ─── Internal ──────────────────────────────────────────────\n\n  _initScrollTracking() {\n    let lastY = window.scrollY || 0;\n    const onScroll = () => {\n      const now = performance.now();\n      const dt = now - this._lastScrollTime;\n      const newY = window.scrollY || 0;\n      if (dt > 0) {\n        const rawV = (newY - lastY) / (dt / 1000);\n        // Smooth velocity\n        this._scrollVelocity += (rawV - this._scrollVelocity) * 0.15;\n      }\n      lastY = newY;\n      this._scrollY = newY;\n      this._lastScrollTime = now;\n    };\n    window.addEventListener('scroll', onScroll, { passive: true });\n  }\n\n  _startLoop() {\n    const tick = () => {\n      if (!this._active) return;\n      this._update();\n      this._rafId = requestAnimationFrame(tick);\n    };\n    this._rafId = requestAnimationFrame(tick);\n  }\n\n  _update() {\n    for (const e of this.cards.values()) {\n      const spd = (e.hovering || e.programmatic) ? this.smoothing : this.returnSpeed;\n      e.tx += (e.gx - e.tx) * spd;\n      e.ty += (e.gy - e.ty) * spd;\n\n      // Snap to zero\n      if (!e.hovering && !e.programmatic &&\n          Math.abs(e.tx) < 0.002 && Math.abs(e.ty) < 0.002) {\n        e.tx = 0; e.ty = 0;\n      }\n\n      this._css(e);\n      this._params(e);\n    }\n  }\n\n  _css(e) {\n    const { el, tx, ty, cfg } = e;\n    const rotY = tx * cfg.maxTilt;\n    const rotX = -ty * cfg.maxTilt;\n    const scrollT = el.dataset.scrollTransform || '';\n\n    // Scroll-push displacement (Event 18): scroll velocity tilts cards backward\n    const scrollPush = Math.max(-8, Math.min(8, this._scrollVelocity * 0.002));\n    const scrollTy = Math.max(-12, Math.min(12, this._scrollVelocity * 0.003));\n    const totalRotX = rotX + scrollPush;\n\n    el.style.transform =\n      `perspective(${cfg.perspective}px) rotateX(${totalRotX.toFixed(2)}deg) rotateY(${rotY.toFixed(2)}deg) translateY(${scrollTy.toFixed(1)}px) ${scrollT}`;\n\n    // CSS custom properties for specular/glare\n    const intensity = Math.min(1, Math.sqrt(tx * tx + ty * ty));\n    el.style.setProperty('--tilt-x', tx.toFixed(3));\n    el.style.setProperty('--tilt-y', ty.toFixed(3));\n    el.style.setProperty('--tilt-intensity', intensity.toFixed(3));\n    el.style.setProperty('--tilt-angle', `${(Math.atan2(ty, tx) * 180 / Math.PI).toFixed(1)}deg`);\n    el.style.setProperty('--specular-x', `${((tx + 1) * 50).toFixed(1)}%`);\n    el.style.setProperty('--specular-y', `${((ty + 1) * 50).toFixed(1)}%`);\n  }\n\n  _params(e) {\n    const { adapter, tx, ty, cfg } = e;\n    if (!adapter || !adapter.active) return;\n\n    const intensity = Math.min(1, Math.sqrt(tx * tx + ty * ty));\n    // Also factor in scroll velocity for reactivity\n    const scrollIntensity = Math.min(1, Math.abs(this._scrollVelocity) / 3000);\n    const combinedIntensity = Math.max(intensity, scrollIntensity);\n    if (combinedIntensity < 0.01) return; // Dead zone\n\n    const p = {};\n\n    if (cfg.affectsRotation) {\n      // Map tilt to 3D rotation planes (XY, XZ)\n      p.rot4dXY = ty * cfg.rotationScale;\n      p.rot4dXZ = tx * cfg.rotationScale;\n      // Scroll velocity drives 4D rotation (Event 18: \"scroll drives 4th dimension\")\n      const scrollRot = scrollIntensity * cfg.rotationScale * 0.5;\n      p.rot4dYW = (adapter.params?.rot4dYW || 0) + tx * cfg.rotationScale * 0.3 + scrollRot;\n    }\n\n    if (cfg.affectsSpeed) {\n      const speedBoost = 1 + combinedIntensity * cfg.speedScale;\n      p.speed = (adapter.params?.speed || 1.0) * speedBoost;\n    }\n\n    if (cfg.affectsChaos) {\n      const base = adapter.params?.chaos ?? 0.2;\n      p.chaos = Math.min(1, base + combinedIntensity * cfg.chaosScale);\n    }\n\n    if (cfg.affectsDensity) {\n      const base = adapter.params?.gridDensity ?? 24;\n      p.gridDensity = Math.max(4, base * (1 - combinedIntensity * cfg.densityScale));\n    }\n\n    if (cfg.affectsHue) {\n      const base = adapter.params?.hue ?? 200;\n      p.hue = (base + tx * cfg.hueScale + 360) % 360;\n    }\n\n    adapter.setParams(p);\n  }\n\n  dispose() {\n    this._active = false;\n    if (this._rafId) cancelAnimationFrame(this._rafId);\n    for (const el of [...this.cards.keys()]) this.unregister(el);\n  }\n}\n","/**\n * Landing Page Configuration\n *\n * All parameter presets for each visualization section.\n * Morph stages define the 6-stage scroll-locked morphing experience.\n * Parameter coordination rules:\n *   - Density DROPS as elements expand (inverse relationship)\n *   - Speed and chaos RISE during dramatic moments, settle in calm phases\n *   - Rotations accumulate through stages for continuous motion\n */\n\nexport const heroParams = {\n  geometry: 11, hue: 210, gridDensity: 28, speed: 0.4,\n  intensity: 0.75, chaos: 0.05, morphFactor: 0.6,\n  rot4dXW: 0.15, rot4dYW: 0.08, dimension: 3.6, saturation: 0.9,\n};\n\n// ── Morph Experience: 6 stages across 1200vh ──\n// Each stage defines target parameters; choreography interpolates between them.\n// density and expansion are inversely coordinated.\nexport const morphStages = [\n  {\n    name: 'Emergence', sub: 'A lattice awakens in four dimensions',\n    geometry: 3, hue: 200, gridDensity: 10, speed: 0.25,\n    chaos: 0.03, intensity: 0.55, morphFactor: 0.3, dimension: 3.9,\n    rot4dXW: 0.1, rot4dYW: 0, rot4dZW: 0,\n  },\n  {\n    name: 'Dimensional Shift', sub: 'Projections ripple through hyperspace',\n    geometry: 11, hue: 270, gridDensity: 14, speed: 0.5,\n    chaos: 0.12, intensity: 0.7, morphFactor: 0.6, dimension: 3.5,\n    rot4dXW: 0.8, rot4dYW: 0.3, rot4dZW: 0,\n  },\n  {\n    name: 'Three Voices', sub: 'Quantum \\u00b7 Holographic \\u00b7 Faceted',\n    geometry: 4, hue: 310, gridDensity: 8, speed: 0.9,\n    chaos: 0.25, intensity: 0.8, morphFactor: 0.8, dimension: 3.4,\n    rot4dXW: 1.2, rot4dYW: 0.6, rot4dZW: 0.3,\n  },\n  {\n    name: 'Convergence', sub: 'All engines synchronize',\n    geometry: 16, hue: 45, gridDensity: 38, speed: 0.55,\n    chaos: 0.04, intensity: 0.88, morphFactor: 1.1, dimension: 3.2,\n    rot4dXW: 2.0, rot4dYW: 1.0, rot4dZW: 0.5,\n  },\n  {\n    name: 'Spectral Rupture', sub: 'The fourth dimension breaks through',\n    geometry: 5, hue: 0, gridDensity: 5, speed: 2.2,\n    chaos: 0.75, intensity: 0.95, morphFactor: 1.6, dimension: 3.0,\n    rot4dXW: 4.0, rot4dYW: 2.5, rot4dZW: 1.8,\n  },\n  {\n    name: 'Resolution', sub: 'Settled into crystalline order',\n    geometry: 7, hue: 180, gridDensity: 24, speed: 0.45,\n    chaos: 0.08, intensity: 0.7, morphFactor: 0.5, dimension: 3.6,\n    rot4dXW: 0.5, rot4dYW: 0.2, rot4dZW: 0,\n  },\n];\n\n// ── Trinity (kept for system swap logic reference) ──\nexport const trinityParams = [\n  { geometry: 3, hue: 195, gridDensity: 24, speed: 0.5, intensity: 0.8, chaos: 0.08, morphFactor: 0.5, dimension: 3.5, saturation: 0.85 },\n  { geometry: 4, hue: 310, gridDensity: 18, speed: 0.4, intensity: 0.85, chaos: 0.12, morphFactor: 0.4, dimension: 3.7, saturation: 0.9 },\n  { geometry: 1, hue: 45, gridDensity: 32, speed: 0.6, intensity: 0.75, chaos: 0.03, morphFactor: 0.8, dimension: 3.4, saturation: 0.8 },\n];\n\nexport const energyCardParams = {\n  geometry: 7, hue: 180, gridDensity: 26, speed: 0.6,\n  intensity: 0.65, chaos: 0.08, morphFactor: 0.7, dimension: 3.5, saturation: 0.85,\n};\n\nexport const energyBgParams = {\n  geometry: 6, hue: 270, gridDensity: 24, speed: 0.5,\n  intensity: 0.7, chaos: 0.18, dimension: 3.4, morphFactor: 0.8, saturation: 0.9,\n};\n\nexport const agentBgParams = {\n  geometry: 5, hue: 240, gridDensity: 22, speed: 0.5,\n  intensity: 0.75, chaos: 0.25, dimension: 3.5, morphFactor: 0.8, saturation: 0.85,\n};\n\nexport const playgroundDefaults = {\n  geometry: 3, hue: 200, gridDensity: 24, speed: 1.0,\n  morphFactor: 0.5, chaos: 0.2, intensity: 0.7,\n  dimension: 3.5,\n  rot4dXW: 0, rot4dYW: 0, rot4dZW: 0,\n  rot4dXY: 0, rot4dXZ: 0, rot4dYZ: 0,\n};\n\nexport const ctaParams = {\n  geometry: 5, hue: 160, gridDensity: 24, speed: 0.5,\n  intensity: 0.75, chaos: 0.25, dimension: 3.5, morphFactor: 0.7, saturation: 0.9,\n};\n\n// ── Opening Cinematic: VIB3CODE text mask over GPU canvas ──\nexport const openingParams = {\n  geometry: 11, hue: 220, gridDensity: 22, speed: 0.3,\n  intensity: 0.5, chaos: 0.05, morphFactor: 0.6, dimension: 3.8,\n  rot4dXW: 0.1, rot4dYW: 0.05, saturation: 0.85,\n};\n\n// ── Parallax Triptych: two visualizer columns ──\nexport const parallaxParams = {\n  left:  { geometry: 2, hue: 195, gridDensity: 22, speed: 0.4, intensity: 0.65, chaos: 0.15, morphFactor: 0.6, dimension: 3.5, saturation: 0.85 },\n  right: { geometry: 4, hue: 310, gridDensity: 18, speed: 0.5, intensity: 0.65, chaos: 0.2, morphFactor: 0.7, dimension: 3.4, saturation: 0.9 },\n};\n","/**\n * GSAP Scroll Choreography — v3: Depth Illusion Engine\n *\n * Architecture:\n *   Opening (800vh) → Hero → Morph (1200vh) → Playground → Triptych →\n *   Cascade → Energy → Agent → CTA\n *\n * NEW in v3:\n *   - Depth Illusion Engine: density-as-distance, faux shadows, push-pull\n *   - 6 Coordination Modes: opposition, convergence, call-response,\n *     heartbeat, energy-conservation, crossfade\n *   - Mathematical Intertwining: Lissajous rotation, sine interference,\n *     complementary hue breathing, exponential crescendo\n *   - Accent effects: glow seams, vignettes, chromatic borders, scanlines\n *   - Per-section depth plane choreography with CSS scale/blur/shadow\n */\n\nimport { QuantumAdapter, HolographicAdapter, FacetedAdapter } from './adapters.js';\nimport { morphStages, trinityParams, energyCardParams, openingParams, parallaxParams } from './config.js';\n\n// ─── Morph State ─────────────────────────────────────────────\nconst morphFactories = [QuantumAdapter, HolographicAdapter, FacetedAdapter];\nlet morphCurrent = -1;\nlet morphSwapLock = false;\nlet morphLastStage = -1;\n\n// ─── Core Math Helpers ───────────────────────────────────────\nfunction smoothstep(p) { return p * p * (3 - 2 * p); }\nfunction lerp(a, b, t) { return a + (b - a) * t; }\nfunction clamp01(v) { return Math.max(0, Math.min(1, v)); }\n\n// ═══════════════════════════════════════════════════════════════\n//  DEPTH ILLUSION ENGINE\n// ═══════════════════════════════════════════════════════════════\n\n/** Faux shadow: driven by depth factor (0=far, 1=close) */\nfunction updateDepthShadow(el, depthFactor) {\n  if (!el) return;\n  el.style.setProperty('--shadow-sx', lerp(1.4, 0.7, depthFactor).toFixed(2));\n  el.style.setProperty('--shadow-sy', lerp(0.3, 1.1, depthFactor).toFixed(2));\n  el.style.setProperty('--shadow-blur', lerp(18, 4, depthFactor) + 'px');\n  el.style.setProperty('--shadow-opacity', lerp(0.15, 0.55, depthFactor).toFixed(2));\n}\n\n/** Vignette tightens as element approaches */\nfunction updateVignette(el, density) {\n  if (!el) return;\n  const d = clamp01(1 - (density - 4) / 52);\n  el.style.setProperty('--vignette-strength', lerp(0.08, 0.45, d).toFixed(2));\n  el.style.setProperty('--vignette-inner', lerp(55, 30, d) + '%');\n}\n\n/** Chromatic aberration border driven by rotation speed */\nfunction updateChroma(container, adapter) {\n  if (!container || !adapter?.params) return;\n  const rotSpd = Math.abs(adapter.params.rot4dXW || 0) + Math.abs(adapter.params.rot4dYW || 0);\n  const off = Math.min(4, rotSpd * 0.4);\n  const h = adapter.params.hue || 200;\n  container.style.setProperty('--chroma-offset', off + 'px');\n  container.style.setProperty('--chroma-hue-a', Math.round(h - 30));\n  container.style.setProperty('--chroma-hue-b', Math.round(h + 30));\n}\n\n/** Glow seam between two visualizers: chaos × chaos → seam brightness */\nfunction updateGlowSeam(seamEl, a, b) {\n  if (!seamEl) return;\n  const cA = a?.params?.chaos || 0, cB = b?.params?.chaos || 0;\n  const energy = (cA + cB) * 3 + cA * cB * 10;\n  const intensity = Math.min(0.9, energy);\n  const hue = ((a?.params?.hue || 200) + (b?.params?.hue || 200)) / 2;\n  seamEl.style.setProperty('--seam-intensity', intensity.toFixed(2));\n  seamEl.style.setProperty('--seam-hue', Math.round(hue));\n  seamEl.style.setProperty('--seam-blur', lerp(8, 2, intensity) + 'px');\n}\n\n/** Scanlines drift with scroll */\nfunction updateScanlines(container, p) {\n  if (!container) return;\n  container.querySelectorAll('.scanline').forEach((line, i) => {\n    const y = ((p * 2 + i / 3) % 1) * 100;\n    line.style.setProperty('--scan-y', y + '%');\n    line.style.setProperty('--scan-hue', Math.round(200 + p * 160));\n  });\n}\n\n/** Depth approach: density-as-distance with CSS depth illusion */\nfunction depthApproach(progress, adapter, container, shadowEl) {\n  const p = smoothstep(progress);\n  adapter.setParams({\n    gridDensity: lerp(55, 8, p),\n    intensity: lerp(0.25, 0.9, p),\n    speed: lerp(0.15, 1.2, p),\n    dimension: lerp(4.2, 3.0, p),\n  });\n  if (container) {\n    container.style.transform = `scale(${lerp(0.65, 1.25, p)})`;\n    container.style.filter = `blur(${lerp(4, 0, p)}px)`;\n    container.style.boxShadow = `0 ${lerp(2, 35, p)}px ${lerp(4, 70, p)}px rgba(0,0,0,${lerp(0.1, 0.5, p)})`;\n  }\n  if (shadowEl) updateDepthShadow(shadowEl, p);\n}\n\n/** Depth retreat: element recedes */\nfunction depthRetreat(progress, adapter, container, shadowEl) {\n  const p = smoothstep(progress);\n  adapter.setParams({\n    gridDensity: lerp(8, 55, p),\n    intensity: lerp(0.9, 0.15, p),\n    speed: lerp(1.2, 0.05, p),\n    dimension: lerp(3.0, 4.5, p),\n    chaos: lerp(0.35, 0.02, p),\n  });\n  if (container) {\n    container.style.transform = `scale(${lerp(1.25, 0.45, p)})`;\n    container.style.filter = `blur(${lerp(0, 8, p)}px)`;\n    container.style.boxShadow = `0 ${lerp(35, 0, p)}px ${lerp(70, 0, p)}px rgba(0,0,0,${lerp(0.5, 0.05, p)})`;\n  }\n  if (shadowEl) updateDepthShadow(shadowEl, 1 - p);\n}\n\n// ═══════════════════════════════════════════════════════════════\n//  MATHEMATICAL INTERTWINING\n// ═══════════════════════════════════════════════════════════════\n\n/** Lissajous rotation intertwining between two systems */\nfunction lissajousRotations(t, adA, adB, ratio) {\n  const r = ratio || 1.5;\n  adA.setParam('rot4dXW', Math.sin(t * 2) * Math.PI);\n  adA.setParam('rot4dYW', Math.cos(t * 2) * Math.PI * 0.7);\n  adB.setParam('rot4dXW', Math.sin(t * 2 * r) * Math.PI);\n  adB.setParam('rot4dYW', Math.cos(t * 2 * r + Math.PI / 4) * Math.PI * 0.7);\n}\n\n/** Sine-product interference: beating density patterns */\nfunction sineInterference(progress, adA, adB) {\n  const wA = Math.sin(progress * Math.PI * 3);\n  const wB = Math.sin(progress * Math.PI * 5);\n  adA.setParam('gridDensity', 10 + wA * wA * 30);\n  adB.setParam('gridDensity', 10 + wB * wB * 30);\n  return (wA * wB + 1) / 2;\n}\n\n/** Complementary hue breathing with chaos collision */\nfunction complementaryBreathing(time, scrollP, adA, adB) {\n  const rate = 0.5 + scrollP * 2;\n  const breath = Math.sin(time / 1000 * rate * Math.PI * 2);\n  const base = 200 + scrollP * 160;\n  const comp = (base + 180) % 360;\n  const hA = lerp(base, comp, (breath + 1) / 2);\n  const hB = lerp(comp, base, (breath + 1) / 2);\n  adA.setParam('hue', hA);\n  adB.setParam('hue', hB);\n  if (Math.abs(hA - hB) < 15) {\n    const spike = (15 - Math.abs(hA - hB)) / 15 * 0.4;\n    adA.setParam('chaos', Math.min(0.7, (adA.params?.chaos || 0.1) + spike));\n    adB.setParam('chaos', Math.min(0.7, (adB.params?.chaos || 0.1) + spike));\n  }\n}\n\n/** Exponential build: slow start, explosive acceleration */\nfunction exponentialBuild(progress, adapter) {\n  const e = Math.pow(progress, 3);\n  adapter.setParams({ speed: 0.3 + e * 2.5, chaos: 0.05 + e * 0.65, intensity: 0.4 + e * 0.5, gridDensity: 20 + e * 35 });\n}\n\n/** Logarithmic calm: fast initial relief, slow settle */\nfunction logarithmicCalm(progress, adapter) {\n  const l = 1 - Math.pow(1 - progress, 3);\n  adapter.setParams({ speed: 2.8 - l * 2.5, chaos: 0.7 - l * 0.65, intensity: 0.9 - l * 0.5, gridDensity: 55 - l * 35 });\n}\n\n/** Opposition: parameter inversion */\nconst oppositionRules = {\n  hue: v => (v + 180) % 360,\n  rot4dXW: v => -v,\n  rot4dYW: v => -v * 0.7,\n  gridDensity: v => clamp01((64 - v) / 60) * 56 + 4,\n  intensity: v => Math.max(0.1, 1.0 - v),\n  speed: v => Math.max(0.05, 2.0 - v),\n  chaos: v => Math.max(0, 0.7 - v),\n};\n\nfunction applyOpposition(primary, secondary, params) {\n  primary.setParams(params);\n  const opp = {};\n  for (const [k, fn] of Object.entries(oppositionRules)) {\n    if (params[k] !== undefined) opp[k] = fn(params[k]);\n  }\n  secondary.setParams(opp);\n}\n\n/**\n * Interpolate between two morph stage parameter sets.\n * Handles geometry as discrete snap at midpoint, everything else as continuous lerp.\n */\nfunction interpolateStages(stageA, stageB, t) {\n  const smooth = smoothstep(t);\n  return {\n    geometry: t < 0.5 ? stageA.geometry : stageB.geometry,\n    hue: lerp(stageA.hue, stageB.hue, smooth),\n    gridDensity: lerp(stageA.gridDensity, stageB.gridDensity, smooth),\n    speed: lerp(stageA.speed, stageB.speed, smooth),\n    chaos: lerp(stageA.chaos, stageB.chaos, smooth),\n    intensity: lerp(stageA.intensity, stageB.intensity, smooth),\n    morphFactor: lerp(stageA.morphFactor, stageB.morphFactor, smooth),\n    dimension: lerp(stageA.dimension, stageB.dimension, smooth),\n    rot4dXW: lerp(stageA.rot4dXW, stageB.rot4dXW, smooth),\n    rot4dYW: lerp(stageA.rot4dYW, stageB.rot4dYW, smooth),\n    rot4dZW: lerp(stageA.rot4dZW, stageB.rot4dZW, smooth),\n  };\n}\n\n// ─── Morph System Swap (with flash) ─────────────────────────\nfunction createMorphSystem(pool, sysIdx) {\n  if (pool.has('morph')) pool.release('morph');\n  const initParams = trinityParams[sysIdx] || trinityParams[0];\n  const adapter = pool.acquire('morph', 'morph-canvas', morphFactories[sysIdx], initParams);\n  morphCurrent = adapter ? sysIdx : -1;\n  return adapter;\n}\n\nfunction swapMorphSystem(pool, newIdx) {\n  if (newIdx === morphCurrent || morphSwapLock) return;\n  morphSwapLock = true;\n  const flash = document.getElementById('morphFlash');\n\n  // Safety timeout: release lock after 1s even if GSAP fails\n  const safetyTimer = setTimeout(() => { morphSwapLock = false; }, 1000);\n\n  gsap.to(flash, { opacity: 0.85, duration: 0.08, ease: 'power2.in', onComplete: () => {\n    createMorphSystem(pool, newIdx);\n    requestAnimationFrame(() => {\n      requestAnimationFrame(() => {\n        gsap.to(flash, { opacity: 0, duration: 0.2, ease: 'power2.out', onComplete: () => {\n          clearTimeout(safetyTimer);\n          morphSwapLock = false;\n        }});\n      });\n    });\n  }});\n}\n\nfunction updateMorphUI(stageIdx) {\n  if (stageIdx === morphLastStage) return;\n  morphLastStage = stageIdx;\n\n  const stage = morphStages[stageIdx];\n  const titleEl = document.getElementById('morphTitle');\n  const subEl = document.getElementById('morphSub');\n  const counterEl = document.getElementById('morphCounter');\n\n  // Animate label out then in\n  if (titleEl) {\n    gsap.to(titleEl, { opacity: 0, y: -15, duration: 0.2, ease: 'power2.in', onComplete: () => {\n      titleEl.textContent = stage.name;\n      gsap.to(titleEl, { opacity: 1, y: 0, duration: 0.5, ease: 'power3.out' });\n    }});\n  }\n  if (subEl) {\n    gsap.to(subEl, { opacity: 0, y: -8, duration: 0.15, ease: 'power2.in', onComplete: () => {\n      subEl.textContent = stage.sub;\n      gsap.to(subEl, { opacity: 1, y: 0, duration: 0.4, delay: 0.1, ease: 'power2.out' });\n    }});\n  }\n  if (counterEl) {\n    counterEl.innerHTML = `<span class=\"current\">0${stageIdx + 1}</span> / 06`;\n  }\n\n  // Update dots\n  document.querySelectorAll('.morph-dot').forEach((d, i) => {\n    d.classList.toggle('active', i === stageIdx);\n  });\n}\n\n// ─── Section Initializers ─────────────────────────────────────\n\nexport function initScrollProgress() {\n  gsap.to('#scrollProgress', {\n    scaleX: 1, ease: 'none',\n    scrollTrigger: { trigger: document.body, start: 'top top', end: 'bottom bottom', scrub: 0.1 },\n  });\n}\n\n// ─── OPENING CINEMATIC (800vh) ──────────────────────────────\n// 5 phases: dark canvas → text appears → mask constrains canvas to letters →\n// lattice layers parallax in → text fades, lattice locks, transition to hero\n\nexport function initOpening(pool, createHero) {\n  const overlay = document.getElementById('openingOverlay');\n  const chars = document.querySelectorAll('.opening-char');\n  const lattice1 = document.getElementById('lattice1');\n  const lattice2 = document.getElementById('lattice2');\n  const lattice3 = document.getElementById('lattice3');\n  const openingSub = document.querySelector('.opening-sub span');\n\n  ScrollTrigger.create({\n    trigger: '#openingSection',\n    start: 'top top',\n    end: 'bottom bottom',\n    pin: '#openingPinned',\n    scrub: 0.6,\n    onEnter: () => {\n      pool.acquire('opening', 'opening-canvas', QuantumAdapter, openingParams);\n    },\n    onLeave: () => {\n      pool.release('opening');\n    },\n    onEnterBack: () => {\n      pool.release('hero');\n      pool.acquire('opening', 'opening-canvas', QuantumAdapter, openingParams);\n    },\n    onLeaveBack: () => {\n      pool.release('opening');\n    },\n    onUpdate: (self) => {\n      const p = self.progress;\n      const adapter = pool.get('opening');\n\n      // ── DEPTH TUNNEL: density-driven approach/retreat through phases ──\n      const vignette = document.getElementById('openingVignette');\n      const scanlines = document.getElementById('openingScanlines');\n      const canvasWrap = document.getElementById('openingCanvasWrap');\n\n      if (adapter) {\n        const wave = Math.sin(p * Math.PI * 6);\n\n        // Phase 1 (0-15%): emerge from maximum distance\n        // Phase 2 (15-55%): approach — density drops, intensity rises\n        // Phase 3 (55-75%): hold at medium depth, oscillate\n        // Phase 4 (75-95%): retreat to distance\n        // Phase 5 (95-100%): iris close\n        let density, intensity, speed, dim, chaos;\n        if (p < 0.15) {\n          // DISTANT: high density, dim, slow\n          const t = p / 0.15;\n          density = lerp(60, 45, smoothstep(t));\n          intensity = lerp(0.0, 0.3, smoothstep(t));\n          speed = lerp(0.05, 0.2, t);\n          dim = 4.3;\n          chaos = 0.02;\n        } else if (p < 0.55) {\n          // APPROACH: density drops, scale grows, sharpens\n          const t = (p - 0.15) / 0.4;\n          density = lerp(45, 14, smoothstep(t));\n          intensity = lerp(0.3, 0.75, smoothstep(t));\n          speed = lerp(0.2, 0.9, t);\n          dim = lerp(4.3, 3.3, t);\n          chaos = lerp(0.02, 0.25, smoothstep(t));\n        } else if (p < 0.75) {\n          // HOLD + OSCILLATE: breathing depth\n          const t = (p - 0.55) / 0.2;\n          const breathe = Math.sin(t * Math.PI * 3) * 0.3;\n          density = 14 + breathe * 8;\n          intensity = 0.75 + breathe * 0.1;\n          speed = 0.9 + breathe * 0.3;\n          dim = 3.3 + breathe * 0.2;\n          chaos = 0.25 + Math.abs(breathe) * 0.15;\n        } else if (p < 0.95) {\n          // RETREAT: density rises, dims, slows\n          const t = (p - 0.75) / 0.2;\n          density = lerp(14, 50, smoothstep(t));\n          intensity = lerp(0.75, 0.15, smoothstep(t));\n          speed = lerp(0.9, 0.1, t);\n          dim = lerp(3.3, 4.3, t);\n          chaos = lerp(0.25, 0.02, smoothstep(t));\n        } else {\n          // IRIS CLOSE: maximum distance, nearly invisible\n          const t = (p - 0.95) / 0.05;\n          density = lerp(50, 60, t);\n          intensity = lerp(0.15, 0.0, t);\n          speed = 0.05;\n          dim = 4.5;\n          chaos = 0.0;\n        }\n\n        adapter.setParams({\n          intensity,\n          rot4dXW: p * Math.PI * 4,\n          rot4dYW: Math.sin(p * Math.PI * 2) * 2,\n          rot4dZW: p * Math.PI * 0.8,\n          hue: 220 + p * 100 + wave * 15,\n          gridDensity: density,\n          chaos,\n          speed,\n          morphFactor: 0.6 + Math.sin(p * Math.PI * 2) * 0.4,\n          dimension: dim,\n          geometry: p < 0.2 ? 11 : p < 0.5 ? 3 : p < 0.75 ? 4 : 7,\n        });\n\n        // CSS depth container: scale and blur match density\n        if (canvasWrap) {\n          const depthFactor = clamp01(1 - (density - 4) / 52);\n          canvasWrap.style.transform = `scale(${lerp(0.85, 1.1, depthFactor)})`;\n        }\n\n        // Vignette tightens as depth increases\n        updateVignette(vignette, density);\n        // Scanlines drift\n        updateScanlines(scanlines, p);\n      }\n\n      // ── Phase 2: Text appears letter by letter (12-35%) ──\n      const textIn = clamp01((p - 0.12) / 0.22);\n      const textOut = smoothstep(clamp01((p - 0.74) / 0.22));\n      chars.forEach((c, i) => {\n        const charP = clamp01((textIn - i * 0.07) / 0.14);\n        const ease = smoothstep(charP);\n        gsap.set(c, {\n          opacity: ease * (1 - textOut),\n          y: (1 - ease) * 80 + textOut * -60,\n          scale: 0.7 + ease * 0.3 - textOut * 0.1,\n          rotationX: (1 - ease) * 12,\n        });\n      });\n\n      // ── Phase 3: Overlay mask (canvas visible only through letters) ──\n      const maskIn = smoothstep(clamp01((p - 0.28) / 0.2));\n      const maskOut = smoothstep(clamp01((p - 0.74) / 0.2));\n      if (overlay) overlay.style.opacity = maskIn * (1 - maskOut);\n\n      // ── Subtitle ──\n      if (openingSub) {\n        const subIn = smoothstep(clamp01((p - 0.36) / 0.08));\n        const subOut = smoothstep(clamp01((p - 0.68) / 0.08));\n        gsap.set(openingSub, {\n          opacity: subIn * (1 - subOut),\n          y: (1 - subIn) * 20,\n        });\n      }\n\n      // ── Phase 4: Lattice layers slide in with parallax (45-75%) ──\n      const latticeP = clamp01((p - 0.45) / 0.3);\n      const lockP = clamp01((p - 0.82) / 0.15);\n\n      if (lattice1) {\n        const rot = lerp(latticeP * 6, Math.round(latticeP * 6 / 15) * 15, smoothstep(lockP));\n        gsap.set(lattice1, {\n          opacity: smoothstep(latticeP) * 0.7 * (1 - smoothstep(clamp01((p - 0.92) / 0.08))),\n          rotation: rot,\n          x: (1 - smoothstep(latticeP)) * -120,\n          y: (latticeP - 0.5) * -50,\n        });\n      }\n      if (lattice2) {\n        const rot2 = lerp(-latticeP * 4 + 2, Math.round((-latticeP * 4 + 2) / 12) * 12, smoothstep(lockP));\n        gsap.set(lattice2, {\n          opacity: smoothstep(clamp01((latticeP - 0.1) / 0.9)) * 0.55 * (1 - smoothstep(clamp01((p - 0.92) / 0.08))),\n          rotation: rot2,\n          x: (1 - smoothstep(latticeP)) * 100,\n          y: (latticeP - 0.5) * -35,\n        });\n      }\n      if (lattice3) {\n        const rot3 = lerp(latticeP * 9, Math.round(latticeP * 9 / 18) * 18, smoothstep(lockP));\n        gsap.set(lattice3, {\n          opacity: smoothstep(clamp01((latticeP - 0.2) / 0.8)) * 0.4 * (1 - smoothstep(clamp01((p - 0.9) / 0.1))),\n          rotation: rot3,\n          y: (latticeP - 0.5) * -70,\n        });\n      }\n    },\n  });\n}\n\n// ─── SCROLL-DRIVEN COLOR THEME ──────────────────────────────\n// Root CSS hue shifts gradually across the page for cohesion\n\nexport function initScrollColorTheme() {\n  ScrollTrigger.create({\n    trigger: document.body,\n    start: 'top top',\n    end: 'bottom bottom',\n    scrub: 0.5,\n    onUpdate: (self) => {\n      const p = self.progress;\n      const hue = Math.round(210 + p * 140);\n      document.documentElement.style.setProperty('--scroll-hue', hue);\n    },\n  });\n}\n\n// ─── BLUR CASCADE REVEALS ───────────────────────────────────\n// Elements with .blur-reveal start blurred, clear on scroll entry\n\nexport function initBlurReveals() {\n  document.querySelectorAll('.blur-reveal').forEach(el => {\n    ScrollTrigger.create({\n      trigger: el, start: 'top 85%', once: true,\n      onEnter: () => el.classList.add('revealed'),\n    });\n  });\n}\n\nexport function initHero(pool) {\n  // Hero GPU lifecycle — acquire when entering, release on leave\n  ScrollTrigger.create({\n    trigger: '.hero', start: 'top 80%', end: 'bottom top',\n    onEnter: () => {\n      if (!pool.has('hero')) {\n        pool.acquire('hero', 'hero-canvas', QuantumAdapter, {\n          geometry: 11, hue: 210, gridDensity: 28, speed: 0.4,\n          intensity: 0.75, chaos: 0.05, morphFactor: 0.6,\n          rot4dXW: 0.15, rot4dYW: 0.08, dimension: 3.6, saturation: 0.9,\n        });\n      }\n    },\n    onEnterBack: () => {\n      if (!pool.has('hero')) {\n        pool.acquire('hero', 'hero-canvas', QuantumAdapter, {\n          geometry: 11, hue: 210, gridDensity: 28, speed: 0.4,\n          intensity: 0.75, chaos: 0.05, morphFactor: 0.6,\n          rot4dXW: 0.15, rot4dYW: 0.08, dimension: 3.6, saturation: 0.9,\n        });\n      }\n    },\n  });\n\n  const tl = gsap.timeline({ delay: 0.2 });\n\n  // Badge entrance\n  tl.to('#heroBadge', { opacity: 1, y: 0, duration: 1.0, ease: 'power3.out' });\n\n  // Title: character cascade\n  const title = document.getElementById('heroTitle');\n  if (title) {\n    const text = title.textContent;\n    title.innerHTML = text.split('').map(c =>\n      c === ' ' ? ' ' : `<span class=\"char\">${c}</span>`\n    ).join('');\n    const chars = title.querySelectorAll('.char');\n    chars.forEach((char) => {\n      gsap.set(char, { y: 80 + Math.random() * 60, opacity: 0 });\n    });\n    tl.to(chars, {\n      opacity: 1, y: 0,\n      duration: 0.8, stagger: 0.06,\n      ease: 'power4.out',\n    }, '-=0.5');\n  }\n\n  tl.to('#heroSub', { opacity: 1, y: 0, duration: 0.9, ease: 'power2.out' }, '-=0.3');\n  tl.to('#heroSystemLabel', { opacity: 1, duration: 0.6 }, '-=0.4');\n  tl.to('#heroScroll', { opacity: 1, duration: 0.8 }, '-=0.2');\n\n  // Scroll-driven hero parameter choreography\n  ScrollTrigger.create({\n    trigger: '.hero', start: 'top top', end: 'bottom top', scrub: 0.3,\n    onUpdate: (self) => {\n      const p = self.progress;\n      const hero = pool.get('hero');\n      if (!hero) return;\n      const ease = smoothstep(p);\n      const late = clamp01((p - 0.4) / 0.6);\n      const burst = clamp01((p - 0.7) / 0.3);\n\n      hero.setParams({\n        rot4dXY: ease * 0.4, rot4dXZ: ease * 0.25,\n        rot4dXW: late * Math.PI * 1.5,\n        rot4dYW: late * Math.PI * 0.8,\n        rot4dZW: burst * Math.PI * 1.2,\n        geometry: p < 0.25 ? 3 : p < 0.55 ? 2 : p < 0.8 ? 4 : 6,\n        gridDensity: 28 + ease * 36 + Math.sin(p * Math.PI * 6) * 8,\n        hue: 210 + ease * 80 + Math.sin(p * Math.PI * 4) * 20,\n        chaos: 0.05 + late * 0.4 + burst * 0.2,\n        intensity: 0.75 + ease * 0.2 + burst * 0.05,\n        morphFactor: 0.6 + ease * 1.2,\n        dimension: 3.6 - ease * 0.5,\n        saturation: 0.9 + late * 0.1,\n      });\n    },\n  });\n\n  // Hero content exit: parallax up + fade\n  gsap.to('#heroContent', {\n    opacity: 0, y: -150, ease: 'none',\n    scrollTrigger: { trigger: '.hero', start: '25% top', end: 'bottom top', scrub: 1.0 },\n  });\n  gsap.to('#heroScroll', {\n    opacity: 0, ease: 'none',\n    scrollTrigger: { trigger: '.hero', start: '10% top', end: '25% top', scrub: 0.3 },\n  });\n}\n\n// ─── MORPH EXPERIENCE (1200vh) ──────────────────────────────\n// 6 stages: Emergence → Dimensional Shift → Three Voices →\n//           Convergence → Spectral Rupture → Resolution\n\nexport function initMorph(pool, createHero) {\n  const morphCard = document.getElementById('morphCard');\n  const morphGlow = document.getElementById('morphGlow');\n  const morphVoices = document.querySelectorAll('.morph-voice');\n  const morphFill = document.getElementById('morphProgressFill');\n  const NUM_STAGES = morphStages.length;\n\n  ScrollTrigger.create({\n    trigger: '#morphSection', start: 'top top', end: 'bottom bottom',\n    pin: '#morphPinned', scrub: 0.6,\n    onEnter: () => {\n      pool.release('hero');\n      pool.release('opening');\n      createMorphSystem(pool, 0);\n      updateMorphUI(0);\n    },\n    onLeave: () => {\n      pool.release('morph');\n      morphCurrent = -1;\n    },\n    onEnterBack: () => {\n      createMorphSystem(pool, 2);\n      updateMorphUI(5);\n    },\n    onLeaveBack: () => {\n      pool.release('morph');\n      morphCurrent = -1;\n      createHero();\n    },\n    onUpdate: (self) => {\n      const p = self.progress;\n\n      // ── Progress bar ──\n      if (morphFill) morphFill.style.width = `${p * 100}%`;\n\n      // ── Stage index and local progress within stage ──\n      const stageFloat = p * NUM_STAGES;\n      const stageIdx = Math.min(Math.floor(stageFloat), NUM_STAGES - 1);\n      const localP = stageFloat - stageIdx;\n\n      // ── Update UI (label, counter, dots) ──\n      updateMorphUI(stageIdx);\n\n      // ── System swaps: Quantum (0-1), Holographic (2-3), Faceted (4-5) ──\n      const targetSys = stageIdx < 2 ? 0 : stageIdx < 4 ? 1 : 2;\n      if (targetSys !== morphCurrent && !morphSwapLock) {\n        swapMorphSystem(pool, targetSys);\n      }\n\n      // ── Interpolate parameters between current and next stage ──\n      const nextIdx = Math.min(stageIdx + 1, NUM_STAGES - 1);\n      const params = interpolateStages(morphStages[stageIdx], morphStages[nextIdx], localP);\n\n      // ── Additional organic motion: sine modulation on top of interpolation ──\n      const wave = Math.sin(p * Math.PI * 8);\n      const pulse = Math.sin(localP * Math.PI);\n      params.hue += wave * 15;\n      params.gridDensity += pulse * 4;\n      params.rot4dXW += Math.sin(p * Math.PI * 3) * 0.3;\n      params.intensity += pulse * 0.05;\n\n      // ── Apply to adapter ──\n      const adapter = pool.get('morph');\n      if (adapter) adapter.setParams(params);\n\n      // ── MORPH CARD DEPTH + CHROMATIC EFFECTS ──\n      const morphShadow = document.getElementById('morphShadow');\n      updateChroma(morphCard, adapter);\n      // Card shape morphs through stages:\n      //   Stage 0: Small circle appears (scale 0→1)\n      //   Stage 1: Circle grows to rounded rectangle\n      //   Stage 2: Card holds, three voice labels appear\n      //   Stage 3: Card grows larger with golden convergence glow\n      //   Stage 4: Card expands massively (near full-screen), chaos glow\n      //   Stage 5: Card shrinks to medium, calms down\n      if (morphCard) {\n        const glowHue = params.hue;\n        morphCard.style.setProperty('--morph-glow', `hsla(${glowHue}, 70%, 50%, ${0.08 + params.chaos * 0.2})`);\n\n        if (stageIdx === 0) {\n          // Emergence: circle appears\n          const s = smoothstep(localP);\n          gsap.set(morphCard, {\n            width: lerp(80, 120, s),\n            height: lerp(80, 120, s),\n            borderRadius: '50%',\n            scale: s,\n            x: '-50%', y: '-50%',\n          });\n          morphCard.classList.toggle('glowing', localP > 0.3);\n        } else if (stageIdx === 1) {\n          // Dimensional Shift: circle → rounded rect\n          const s = smoothstep(localP);\n          gsap.set(morphCard, {\n            width: lerp(120, 340, s),\n            height: lerp(120, 220, s),\n            borderRadius: lerp(50, 24, s) + '%',\n            scale: 1,\n            x: '-50%', y: '-50%',\n          });\n          morphCard.classList.add('glowing');\n          updateDepthShadow(morphShadow, smoothstep(localP) * 0.5);\n        } else if (stageIdx === 2) {\n          // Three Voices: card holds, voice labels appear\n          gsap.set(morphCard, {\n            width: 340, height: 220, borderRadius: '24px',\n            scale: 1, x: '-50%', y: '-50%',\n          });\n          // Animate voice labels in\n          morphVoices.forEach((v, i) => {\n            const delay = i * 0.08;\n            const show = localP > 0.15 + delay;\n            gsap.to(v, {\n              opacity: show ? 1 : 0,\n              y: show ? 0 : 30,\n              scale: show ? 1 : 0.8,\n              duration: 0.4, ease: 'power3.out',\n            });\n          });\n        } else if (stageIdx === 3) {\n          // Convergence: card grows, voice labels hide\n          const s = smoothstep(localP);\n          gsap.set(morphCard, {\n            width: lerp(340, 500, s),\n            height: lerp(220, 350, s),\n            borderRadius: '24px',\n            scale: 1, x: '-50%', y: '-50%',\n          });\n          // Density coordination: as card grows, density drops\n          if (adapter) adapter.setParam('gridDensity', params.gridDensity * lerp(1, 0.7, s));\n          // Hide voices\n          morphVoices.forEach(v => {\n            gsap.to(v, { opacity: 0, y: -20, scale: 0.8, duration: 0.3, ease: 'power2.in' });\n          });\n        } else if (stageIdx === 4) {\n          // Spectral Rupture: card expands massively\n          const s = smoothstep(localP);\n          const cardW = lerp(500, window.innerWidth * 0.85, s);\n          const cardH = lerp(350, window.innerHeight * 0.75, s);\n          gsap.set(morphCard, {\n            width: cardW, height: cardH,\n            borderRadius: lerp(24, 16, s) + 'px',\n            scale: 1, x: '-50%', y: '-50%',\n          });\n          morphCard.classList.add('glowing');\n          // Density drops as card expands (inverse relationship)\n          if (adapter) adapter.setParam('gridDensity', params.gridDensity * lerp(0.7, 0.3, s));\n          // Speed and chaos amplified during rupture\n          if (adapter) {\n            adapter.setParam('speed', params.speed * lerp(1, 1.5, s));\n            adapter.setParam('chaos', params.chaos * lerp(1, 1.3, s));\n          }\n          // Card at max foreground depth\n          updateDepthShadow(morphShadow, 0.5 + s * 0.5);\n        } else {\n          // Resolution: card shrinks back to medium\n          const s = smoothstep(localP);\n          gsap.set(morphCard, {\n            width: lerp(window.innerWidth * 0.85, 380, s),\n            height: lerp(window.innerHeight * 0.75, 240, s),\n            borderRadius: lerp(16, 24, s) + 'px',\n            scale: 1, x: '-50%', y: '-50%',\n          });\n          morphCard.classList.toggle('glowing', localP < 0.7);\n          // Density recovers as card shrinks\n          if (adapter) adapter.setParam('gridDensity', params.gridDensity * lerp(0.3, 1, s));\n        }\n      }\n    },\n  });\n}\n\n// ─── PARALLAX TRIPTYCH ──────────────────────────────────────\n// All 3 GPU systems rendering simultaneously with cross-system coordination:\n//   Quantum (left) ↔ Holographic (center, behind text) ↔ Faceted (right)\n// Coordination: shared heartbeat, energy conservation, triadic hues,\n//   phase-locked 4D rotation, density cross-feed, convergence event\n\nexport function initTriptych(pool) {\n  const left = document.getElementById('triptychLeft');\n  const right = document.getElementById('triptychRight');\n\n  const centerInitParams = {\n    ...parallaxParams.left,\n    hue: 280, geometry: 3, intensity: 0.6, gridDensity: 20,\n    chaos: 0.1, speed: 0.5, saturation: 0.75,\n  };\n\n  // ── GPU Lifecycle: acquire all 3 real systems ──\n  const acquireAll = () => {\n    pool.acquire('triLeft', 'tri-left-canvas', QuantumAdapter, parallaxParams.left);\n    pool.acquire('triCenter', 'tri-center-canvas', HolographicAdapter, centerInitParams);\n    pool.acquire('triRight', 'tri-right-canvas', FacetedAdapter, parallaxParams.right);\n  };\n  const releaseAll = () => {\n    pool.release('triLeft');\n    pool.release('triCenter');\n    pool.release('triRight');\n  };\n\n  ScrollTrigger.create({\n    trigger: '#triptychSection', start: 'top 90%', end: 'bottom top',\n    onEnter: acquireAll,\n    onLeave: releaseAll,\n    onEnterBack: acquireAll,\n    onLeaveBack: releaseAll,\n  });\n\n  // ── 3-System Cross-Coordinated Choreography with DEPTH PLANES ──\n  const center = document.getElementById('triptychCenter');\n  const triSeamL = document.getElementById('triSeamLeft');\n  const triSeamR = document.getElementById('triSeamRight');\n  const triVigL = document.getElementById('triVignetteLeft');\n  const triVigC = document.getElementById('triVignetteCenter');\n  const triVigR = document.getElementById('triVignetteRight');\n  const triShadL = document.getElementById('triShadowLeft');\n  const triShadR = document.getElementById('triShadowRight');\n\n  ScrollTrigger.create({\n    trigger: '#triptychSection', start: 'top bottom', end: 'bottom top',\n    scrub: 0.5,\n    onUpdate: (self) => {\n      const p = self.progress;\n\n      // ═══════ CLIP-PATH SPLIT-SCREEN ═══════\n      const root = document.documentElement;\n      const mouseXPct = parseFloat(root.style.getPropertyValue('--mouse-x') || '50%') || 50;\n      const mouseShift = (mouseXPct / 100 - 0.5) * 6;\n\n      const splitLeft = 34 + (p - 0.5) * 12 + mouseShift;\n      const splitRight = 66 + (p - 0.5) * 12 + mouseShift;\n\n      const conv = Math.max(0, 1 - Math.abs(p - 0.5) * 4);\n      const cSplitLeft = lerp(splitLeft, 33.33, conv * 0.5);\n      const cSplitRight = lerp(splitRight, 66.66, conv * 0.5);\n\n      if (left) left.style.clipPath = `inset(0 ${100 - cSplitLeft}% 0 0)`;\n      if (center) center.style.clipPath = `inset(0 ${100 - cSplitRight}% 0 ${cSplitLeft}%)`;\n      if (right) right.style.clipPath = `inset(0 0 0 ${cSplitRight}%)`;\n\n      root.style.setProperty('--tri-split-left', `${cSplitLeft}%`);\n      root.style.setProperty('--tri-split-right', `${cSplitRight}%`);\n\n      // ═══════ DEPTH PLANE SYSTEM ═══════\n      // Phase 1 (0-30%): L=FOREGROUND, C=MID, R=BACK\n      // Phase 2 (30-50%): L retreats, R advances (DEPTH SWAP)\n      // Phase 3 (50-70%): R=FOREGROUND, C=MID, L=BACK (mirror)\n      // Phase 4 (70-85%): All converge to same depth\n      // Phase 5 (85-100%): Crystallization — all retreat together\n      let depthL, depthC, depthR; // 0=far, 1=close\n      if (p < 0.3) {\n        const t = p / 0.3;\n        depthL = lerp(0.9, 0.85, t);\n        depthC = 0.5;\n        depthR = lerp(0.15, 0.2, t);\n      } else if (p < 0.5) {\n        // DEPTH SWAP — dramatic crossing\n        const t = (p - 0.3) / 0.2;\n        const s = smoothstep(t);\n        depthL = lerp(0.85, 0.15, s);\n        depthC = 0.5 + Math.sin(t * Math.PI) * 0.2; // center rises then falls\n        depthR = lerp(0.2, 0.9, s);\n      } else if (p < 0.7) {\n        const t = (p - 0.5) / 0.2;\n        depthL = lerp(0.15, 0.15, t);\n        depthC = 0.5;\n        depthR = lerp(0.9, 0.85, t);\n      } else if (p < 0.85) {\n        // CONVERGENCE: all → same depth\n        const t = (p - 0.7) / 0.15;\n        const s = smoothstep(t);\n        depthL = lerp(0.15, 0.55, s);\n        depthC = lerp(0.5, 0.55, s);\n        depthR = lerp(0.85, 0.55, s);\n      } else {\n        // CRYSTALLIZATION: all retreat together\n        const t = (p - 0.85) / 0.15;\n        const s = smoothstep(t);\n        depthL = depthC = depthR = lerp(0.55, 0.1, s);\n      }\n\n      // Apply depth CSS to containers\n      const applyDepthCSS = (el, depth) => {\n        if (!el) return;\n        const scale = lerp(0.88, 1.12, depth);\n        const blur = lerp(3, 0, depth);\n        // Only apply parallax Y offset, not full depth scale (clip-path handles width)\n        el.style.transform = `translateY(${(p - 0.5) * lerp(-40, -120, depth)}px) scale(${scale})`;\n        el.style.filter = blur > 0.5 ? `blur(${blur}px)` : 'none';\n      };\n      applyDepthCSS(left, depthL);\n      applyDepthCSS(right, depthR);\n\n      // Shadows respond to depth\n      updateDepthShadow(triShadL, depthL);\n      updateDepthShadow(triShadR, depthR);\n\n      // Vignettes tighten for foreground elements\n      const denFromDepth = d => lerp(50, 8, d);\n      updateVignette(triVigL, denFromDepth(depthL));\n      updateVignette(triVigC, denFromDepth(depthC));\n      updateVignette(triVigR, denFromDepth(depthR));\n\n      // ═══════ SHARED COORDINATION SIGNALS ═══════\n      const heartbeat = Math.sin(p * Math.PI * 2);\n      const pulse = Math.sin(p * Math.PI);\n      const convergence = conv;\n\n      // Triadic hue rotation\n      const baseHue = 200 + p * 160;\n      const hueL = baseHue % 360 + convergence * ((baseHue + 120) % 360 - baseHue % 360) * 0.6;\n      const hueC = (baseHue + 120) % 360;\n      const hueR = (baseHue + 240) % 360 + convergence * ((baseHue + 120) % 360 - (baseHue + 240) % 360) * 0.6;\n\n      // Depth-driven density: close=low density, far=high\n      const denL = denFromDepth(depthL) + heartbeat * 4;\n      const denC = denFromDepth(depthC) + heartbeat * 6;\n      const denR = denFromDepth(depthR) + heartbeat * 4;\n\n      // Depth-driven intensity: close=bright, far=dim\n      const intL = lerp(0.3, 0.85, depthL) + heartbeat * 0.1;\n      const intC = lerp(0.35, 0.8, depthC) + pulse * 0.15;\n      const intR = lerp(0.3, 0.85, depthR) - heartbeat * 0.08;\n\n      // Phase-locked 4D with LISSAJOUS intertwining\n      const rotBase = p * Math.PI * 4;\n      const t = p * Math.PI;\n      const xwL = Math.sin(t * 2) * Math.PI + rotBase * 0.3;\n      const xwC = rotBase + Math.PI * 2 / 3;\n      const xwR = Math.sin(t * 3) * Math.PI + rotBase * 0.3; // 3:2 ratio with L\n\n      // Call & response: left chaos → center speed → right morph\n      const chaosL = 0.1 + depthL * 0.3 + convergence * 0.2;\n      const speedC = 0.4 + chaosL * 0.8 + convergence * 0.8;\n      const morphR = 0.6 + speedC * 0.3;\n      const sharedSpeed = 0.4 + pulse * 0.6 + convergence * 1.0;\n\n      // ═══════ DEPTH SWAP CHAOS SPIKE ═══════\n      const swapChaos = (p > 0.35 && p < 0.5) ? Math.sin((p - 0.35) / 0.15 * Math.PI) * 0.35 : 0;\n\n      // ═══════ LEFT: QUANTUM ═══════\n      const triL = pool.get('triLeft');\n      if (triL) {\n        triL.setParams({\n          geometry: p < 0.3 ? 2 : p < 0.6 ? 3 : p < 0.85 ? 10 : 7,\n          hue: hueL,\n          rot4dXW: xwL,\n          rot4dYW: Math.sin(p * Math.PI * 2) * 2.0,\n          rot4dZW: p * Math.PI * 0.6,\n          gridDensity: Math.max(6, Math.min(55, denL)),\n          intensity: Math.min(0.95, intL),\n          chaos: chaosL + swapChaos,\n          morphFactor: 0.6 + Math.sin(p * Math.PI * 2) * 0.4,\n          speed: sharedSpeed * lerp(0.7, 1.3, depthL),\n          saturation: 0.85 + pulse * 0.1,\n        });\n      }\n\n      // ═══════ CENTER: HOLOGRAPHIC ═══════\n      const triC = pool.get('triCenter');\n      if (triC) {\n        triC.setParams({\n          geometry: p < 0.2 ? 3 : p < 0.4 ? 11 : p < 0.6 ? 6 : p < 0.8 ? 2 : 10,\n          hue: hueC,\n          rot4dXW: xwC,\n          rot4dYW: Math.cos(p * Math.PI * 2) * 1.5 + heartbeat * 0.5,\n          rot4dZW: -p * Math.PI * 0.3 + heartbeat * 0.4,\n          gridDensity: Math.max(6, Math.min(55, denC)),\n          intensity: Math.min(0.95, intC),\n          chaos: 0.1 + convergence * 0.4 + pulse * 0.1 + swapChaos,\n          morphFactor: 0.5 + convergence * 0.8 + heartbeat * 0.3,\n          speed: speedC,\n          saturation: 0.75 + convergence * 0.2,\n        });\n      }\n\n      // ═══════ RIGHT: FACETED ═══════\n      const triR = pool.get('triRight');\n      if (triR) {\n        triR.setParams({\n          geometry: p < 0.25 ? 12 : p < 0.5 ? 4 : p < 0.75 ? 20 : 5,\n          hue: hueR,\n          rot4dXW: xwR,\n          rot4dYW: Math.cos(p * Math.PI * 2) * 1.8,\n          rot4dZW: -p * Math.PI * 0.4,\n          gridDensity: Math.max(6, Math.min(55, denR)),\n          intensity: Math.min(0.95, intR),\n          chaos: 0.15 + depthR * 0.2 - convergence * 0.1 + swapChaos,\n          morphFactor: morphR,\n          speed: sharedSpeed * lerp(0.7, 1.3, depthR) * 0.9,\n          saturation: 0.9 + pulse * 0.08,\n        });\n      }\n\n      // ═══════ GLOW SEAMS — energy between adjacent systems ═══════\n      updateGlowSeam(triSeamL, triL, triC);\n      updateGlowSeam(triSeamR, triC, triR);\n    },\n  });\n}\n\n// ─── CASCADE — Inter-Card Ripple Coordination ────────────────\n// Active card: scale up, glow leaks, density drops\n// Ripple propagation: active card's energy echoes outward through ALL cards\n// with distance-based falloff — every card participates, none are idle.\n// Shared rotation phase ties all cards to a common 4D rhythm.\n\nexport function initCascade(pool, c2d) {\n  const cascadeCards = document.querySelectorAll('.cascade-card');\n  const cascadeTrack = document.getElementById('cascadeTrack');\n  const gpuLeftWrap = document.getElementById('cascadeGpuLeft');\n  const gpuRightWrap = document.getElementById('cascadeGpuRight');\n\n  // ── Dual GPU background lifecycle ──\n  ScrollTrigger.create({\n    trigger: '#cascadeSection', start: 'top 90%', end: 'bottom top',\n    onEnter: () => {\n      pool.acquire('casGpuL', 'cascade-gpu-left', QuantumAdapter, {\n        geometry: 2, hue: 200, gridDensity: 20, speed: 0.5,\n        intensity: 0.55, chaos: 0.15, dimension: 3.5, morphFactor: 0.6, saturation: 0.85,\n      });\n      pool.acquire('casGpuR', 'cascade-gpu-right', HolographicAdapter, {\n        geometry: 4, hue: 320, gridDensity: 18, speed: 0.4,\n        intensity: 0.5, chaos: 0.12, dimension: 3.6, morphFactor: 0.7, saturation: 0.8,\n      });\n    },\n    onLeave: () => { pool.release('casGpuL'); pool.release('casGpuR'); },\n    onEnterBack: () => {\n      pool.acquire('casGpuL', 'cascade-gpu-left', QuantumAdapter, {\n        geometry: 2, hue: 200, gridDensity: 20, speed: 0.5,\n        intensity: 0.55, chaos: 0.15, dimension: 3.5, morphFactor: 0.6, saturation: 0.85,\n      });\n      pool.acquire('casGpuR', 'cascade-gpu-right', HolographicAdapter, {\n        geometry: 4, hue: 320, gridDensity: 18, speed: 0.4,\n        intensity: 0.5, chaos: 0.12, dimension: 3.6, morphFactor: 0.7, saturation: 0.8,\n      });\n    },\n    onLeaveBack: () => { pool.release('casGpuL'); pool.release('casGpuR'); },\n  });\n\n  // ═══ 8-point polygon shapes for geometric morphing ═══\n  // All shapes have exactly 8 vertices so CSS can interpolate between them.\n  const SHAPES = {\n    // Nearly-full rectangle (rounded feel via vertex placement)\n    rect:    [[2,2],[50,0],[98,2],[100,50],[98,98],[50,100],[2,98],[0,50]],\n    // Hexagonal window\n    hex:     [[25,2],[75,2],[98,25],[98,75],[75,98],[25,98],[2,75],[2,25]],\n    // Diamond / rhombus\n    diamond: [[50,2],[80,20],[98,50],[80,80],[50,98],[20,80],[2,50],[20,20]],\n    // Octagon\n    oct:     [[28,2],[72,2],[98,28],[98,72],[72,98],[28,98],[2,72],[2,28]],\n    // Narrow slit — card appears small through this window\n    narrow:  [[15,12],[50,8],[85,12],[92,50],[85,88],[50,92],[15,88],[8,50]],\n  };\n\n  // Interpolate between two 8-point polygon shapes\n  function lerpShape(a, b, t) {\n    return 'polygon(' + a.map((pt, i) =>\n      `${pt[0] + (b[i][0] - pt[0]) * t}% ${pt[1] + (b[i][1] - pt[1]) * t}%`\n    ).join(', ') + ')';\n  }\n\n  // Shape sequence for the active card as it scrolls through\n  const shapeSeq = [SHAPES.rect, SHAPES.hex, SHAPES.diamond, SHAPES.oct, SHAPES.rect];\n\n  // Initialize card hue custom properties + frame elements\n  cascadeCards.forEach((card) => {\n    card.style.setProperty('--card-hue', card.dataset.hue);\n  });\n\n  // Stagger entrance — NO SCALE, just opacity + translateY\n  ScrollTrigger.create({\n    trigger: '#cascadeSection', start: 'top 75%', once: true,\n    onEnter: () => {\n      gsap.to('.cascade-card', {\n        opacity: 1, y: 0,\n        duration: 0.9, stagger: 0.15,\n        ease: 'power3.out',\n      });\n    },\n  });\n\n  // ─── Card hover interaction: mouse drives AmbientLattice params ──\n  cascadeCards.forEach((card, i) => {\n    card.addEventListener('mouseenter', () => {\n      const inst = c2d.get(`cas${i}`);\n      if (inst) inst.setParams({ speed: 1.8, chaos: 0.5, intensity: 0.95 });\n    });\n    card.addEventListener('mousemove', (e) => {\n      const inst = c2d.get(`cas${i}`);\n      if (!inst) return;\n      const rect = card.getBoundingClientRect();\n      const mx = (e.clientX - rect.left) / rect.width;\n      const my = (e.clientY - rect.top) / rect.height;\n      inst.setParam('mouseX', mx);\n      inst.setParam('mouseY', my);\n    });\n    card.addEventListener('mouseleave', () => {\n      const inst = c2d.get(`cas${i}`);\n      if (inst) inst.setParams({ speed: 0.7, chaos: 0.18, intensity: 0.85, mouseX: 0.5, mouseY: 0.5 });\n    });\n  });\n\n  // Cascade header reveal\n  ScrollTrigger.create({\n    trigger: '#cascadeSection', start: 'top 80%', once: true,\n    onEnter: () => {\n      gsap.from('.cascade-header', {\n        y: 40, opacity: 0, duration: 0.8, ease: 'power2.out',\n      });\n    },\n  });\n\n  if (cascadeTrack && cascadeCards.length > 0) {\n    const N = cascadeCards.length;\n\n    ScrollTrigger.create({\n      trigger: '#cascadeSection', start: 'top top', end: 'bottom bottom',\n      pin: '#cascadePinned', scrub: 0.5,\n      onUpdate: (self) => {\n        const p = self.progress;\n\n        // Cards are 80vw wide, end-to-end (no gap)\n        const vw = window.innerWidth / 100;\n        const cardW = 80 * vw;\n        const totalScroll = (N - 1) * cardW;\n        cascadeTrack.style.transform = `translateX(${-p * totalScroll}px)`;\n\n        const activeIdx = Math.min(Math.floor(p * N), N - 1);\n        const activeHue = parseInt(cascadeCards[activeIdx].dataset.hue);\n        const localP = (p * N) - activeIdx;\n        const pulse = Math.sin(localP * Math.PI);\n\n        // ═══ Shared rotation phase — all cards tied to a common 4D rhythm ═══\n        const sharedXW = p * Math.PI * 3;\n\n        // ═══ DUAL GPU BACKGROUND: DEPTH RESPONSE to active card ═══\n        const gpuL = pool.get('casGpuL');\n        const gpuR = pool.get('casGpuR');\n        const casSeam = document.getElementById('cascadeSeam');\n        const casVignette = document.getElementById('cascadeVignette');\n        const aCard = cascadeCards[activeIdx];\n        const aGeo = parseInt(aCard?.dataset.geo || '0');\n        const aHue = parseInt(aCard?.dataset.hue || '200');\n        const cardApproach = pulse;\n\n        if (gpuL) {\n          gpuL.setParams({\n            geometry: aGeo, hue: aHue,\n            rot4dXW: sharedXW,\n            rot4dYW: Math.sin(p * Math.PI * 2) * 1.5,\n            gridDensity: lerp(14, 50, cardApproach),\n            intensity: lerp(0.55, 0.2, cardApproach),\n            chaos: 0.1 + pulse * 0.25,\n            speed: 0.4 + pulse * 0.8,\n            morphFactor: 0.5 + localP * 0.6,\n          });\n        }\n        if (gpuR) {\n          gpuR.setParams({\n            geometry: (aGeo + 16) % 24,\n            hue: (aHue + 180) % 360,\n            rot4dXW: -sharedXW * 0.7,\n            rot4dYW: Math.cos(p * Math.PI * 2) * 1.2,\n            gridDensity: lerp(18, 52, cardApproach),\n            intensity: lerp(0.45, 0.18, cardApproach),\n            chaos: 0.12 + (1 - pulse) * 0.2,\n            speed: 0.3 + (1 - pulse) * 0.6,\n            morphFactor: 0.7 - localP * 0.3,\n          });\n        }\n\n        // Split line follows active card\n        const splitPct = 30 + activeIdx / Math.max(1, N - 1) * 40;\n        if (gpuLeftWrap) gpuLeftWrap.style.clipPath = `inset(0 ${100 - splitPct}% 0 0)`;\n        if (gpuRightWrap) gpuRightWrap.style.clipPath = `inset(0 0 0 ${splitPct}%)`;\n        updateGlowSeam(casSeam, gpuL, gpuR);\n        if (casSeam) casSeam.style.left = `${splitPct}%`;\n        if (casVignette) updateVignette(casVignette, gpuL?.params?.gridDensity || 20);\n\n        // ═══ PER-CARD: 3D TILT + GEOMETRIC MORPHING + FRACTAL ECHOES ═══\n        cascadeCards.forEach((card, i) => {\n          const inst = c2d.get(`cas${i}`);\n          if (!inst) return;\n          const hue = parseInt(card.dataset.hue);\n          const dist = Math.abs(i - activeIdx);\n          const ripple = Math.max(0, 1 - dist * 0.3) * pulse;\n          const phaseOffset = dist * Math.PI / 3;\n          const isActive = (i === activeIdx);\n\n          // ═══ 3D TILT — NO SCALE EVER ═══\n          // Active card tilts toward face-on (flat). Neighbors fan outward.\n          let tiltY, tiltX, tiltZ;\n          if (isActive) {\n            // Face-on when fully active, slight tilt during transition\n            tiltY = (1 - pulse) * (localP < 0.5 ? -15 : 15);\n            tiltX = -pulse * 3;\n            tiltZ = (1 - pulse) * (localP < 0.5 ? -2 : 2);\n          } else {\n            // Fan outward: cards to left tilt right, cards to right tilt left\n            const dir = i < activeIdx ? 1 : -1;\n            const tiltStrength = Math.min(dist * 18, 50);\n            tiltY = dir * tiltStrength;\n            tiltX = dist * 3;\n            tiltZ = dir * dist * 1.5;\n          }\n\n          card.style.transform = `perspective(1200px) rotateY(${tiltY}deg) rotateX(${tiltX}deg) rotateZ(${tiltZ}deg)`;\n          card.style.zIndex = isActive ? '10' : `${Math.max(1, 7 - dist)}`;\n          card.style.opacity = isActive ? '1' : `${Math.max(0.35, 1 - dist * 0.13)}`;\n\n          // ═══ GEOMETRIC MORPHING via clip-path on canvas-wrap ═══\n          // Active: morph through shape sequence. Inactive: narrow window.\n          const wrap = card.querySelector('.canvas-wrap');\n          const overlay = card.querySelector('.cascade-overlay');\n          const frame = card.querySelector('.card-frame');\n          let clipVal;\n\n          if (isActive) {\n            // Cycle through 4 shape transitions based on localP (0→1)\n            const phase = localP * (shapeSeq.length - 1);\n            const segIdx = Math.min(Math.floor(phase), shapeSeq.length - 2);\n            const segT = phase - segIdx;\n            clipVal = lerpShape(shapeSeq[segIdx], shapeSeq[segIdx + 1], segT);\n          } else {\n            // Narrower window the further away — controls perceived size\n            const inset = Math.min(3 + dist * 6, 22);\n            const r = 14 + dist * 3;\n            clipVal = `inset(${inset}% ${inset * 0.6}% ${inset}% ${inset * 0.6}% round ${r}px)`;\n          }\n\n          if (wrap) wrap.style.clipPath = clipVal;\n          if (overlay) overlay.style.clipPath = clipVal;\n          if (frame) frame.style.clipPath = clipVal;\n\n          // ═══ FRACTAL ECHOES via filter: drop-shadow ═══\n          // Active card gets offset drop-shadows that follow the geometric clip-path.\n          // This creates the illusion of the card duplicating/fracturing outward.\n          if (isActive) {\n            const echoOff = 5 + pulse * 16;\n            const a1 = (0.18 + pulse * 0.14).toFixed(2);\n            const a2 = (0.10 + pulse * 0.08).toFixed(2);\n            const a3 = (0.05 + pulse * 0.04).toFixed(2);\n            card.style.filter = [\n              `drop-shadow(${echoOff}px ${echoOff * 0.8}px 0px hsla(${hue}, 70%, 50%, ${a1}))`,\n              `drop-shadow(${echoOff * 2.2}px ${echoOff * 1.2}px 1px hsla(${hue}, 65%, 45%, ${a2}))`,\n              `drop-shadow(${-echoOff * 0.8}px ${echoOff * 1.5}px 0px hsla(${hue}, 60%, 40%, ${a3}))`,\n              `drop-shadow(${echoOff * 1.4}px ${-echoOff * 0.6}px 0px hsla(${hue}, 60%, 40%, ${a3}))`,\n            ].join(' ');\n            card.classList.add('leaking');\n            // Frame glow\n            card.style.setProperty('--frame-glow-size', `${18 + pulse * 35}px`);\n            card.style.setProperty('--frame-glow-alpha', `${0.12 + pulse * 0.18}`);\n            card.style.setProperty('--frame-border', `1px solid rgba(255,255,255,${0.06 + pulse * 0.12})`);\n          } else {\n            // Neighbors: subtle single echo if close, none if far\n            if (ripple > 0.08) {\n              const rOff = 3 + ripple * 10;\n              card.style.filter = `drop-shadow(${rOff}px ${rOff * 0.6}px 0px hsla(${hue}, 60%, 45%, ${(ripple * 0.12).toFixed(2)}))`;\n            } else {\n              card.style.filter = 'none';\n            }\n            card.classList.toggle('leaking', ripple > 0.15);\n            card.style.setProperty('--frame-glow-size', '0px');\n            card.style.setProperty('--frame-glow-alpha', '0');\n            card.style.setProperty('--frame-border', `1px solid rgba(255,255,255,${0.03 + ripple * 0.04})`);\n          }\n\n          // ═══ VISUALIZATION PARAMETERS ═══\n          // Active: low density (close/dramatic), high chaos/speed\n          // Inactive: high density (receded/ambient), low chaos\n          if (isActive) {\n            inst.setParams({\n              rot4dXW: sharedXW + localP * Math.PI * 2,\n              rot4dYW: Math.sin(localP * Math.PI) * 1.8,\n              rot4dZW: sharedXW * 0.4 + localP * 0.8,\n              intensity: 0.85 + pulse * 0.15,\n              gridDensity: Math.max(6, 22 - pulse * 14),\n              speed: 1.0 + pulse * 1.8,\n              chaos: 0.25 + pulse * 0.5,\n              hue: hue + pulse * 40,\n              morphFactor: 0.5 + localP * 1.2,\n              saturation: 0.95,\n            });\n          } else {\n            const hueBleed = ripple * 0.5;\n            const echoWave = Math.sin(localP * Math.PI + phaseOffset);\n            const echo = Math.max(0, echoWave) * ripple;\n            inst.setParams({\n              hue: hue + (activeHue - hue) * hueBleed,\n              intensity: 0.45 + ripple * 0.3,\n              gridDensity: 24 - ripple * 8 + echo * 5,\n              speed: 0.5 + echo * 0.7,\n              chaos: 0.1 + echo * 0.2,\n              morphFactor: 0.4 + echo * 0.5,\n              rot4dXW: sharedXW + phaseOffset * 0.4,\n              rot4dYW: Math.sin(sharedXW + phaseOffset) * 0.6 * ripple,\n              saturation: 0.75 + ripple * 0.15,\n            });\n          }\n        });\n      },\n    });\n  }\n}\n\n// ─── ENERGY TRANSFER ────────────────────────────────────────\n\nexport function initEnergy(pool) {\n  const energyBgInitParams = {\n    geometry: 6, hue: 270, gridDensity: 24, speed: 0.5,\n    intensity: 0.6, chaos: 0.15, dimension: 3.4, morphFactor: 0.8, saturation: 0.9,\n  };\n\n  // Dual GPU lifecycle: Quantum bg + Faceted card\n  ScrollTrigger.create({\n    trigger: '#energySection', start: 'top 80%', end: 'bottom top',\n    onEnter: () => {\n      pool.acquire('energyBg', 'energy-bg-canvas', QuantumAdapter, energyBgInitParams);\n      pool.acquire('energyCard', 'energy-card-canvas', FacetedAdapter, energyCardParams);\n    },\n    onLeave: () => { pool.release('energyBg'); pool.release('energyCard'); },\n    onEnterBack: () => {\n      pool.acquire('energyBg', 'energy-bg-canvas', QuantumAdapter, energyBgInitParams);\n      pool.acquire('energyCard', 'energy-card-canvas', FacetedAdapter, energyCardParams);\n    },\n    onLeaveBack: () => { pool.release('energyBg'); pool.release('energyCard'); },\n  });\n\n  // 7-Step Pinned 3D Card Timeline\n  const energyCard = document.getElementById('energyCard');\n  if (energyCard) {\n    const pinnedTl = gsap.timeline({\n      scrollTrigger: {\n        trigger: '#energySection', start: 'top top', end: 'bottom bottom',\n        pin: '#energyPinned', scrub: 0.5,\n      },\n    });\n\n    // Phase 1: Entrance from below with 3D tilt\n    pinnedTl.fromTo(energyCard,\n      { y: 200, opacity: 0, scale: 0.6, rotateX: -25 },\n      { y: 0, opacity: 1, scale: 1, rotateX: 0, duration: 0.3, ease: 'power3.out' }\n    );\n    // Phase 2: Overshoot with glow\n    pinnedTl.to(energyCard, {\n      scale: 1.06,\n      boxShadow: '0 50px 100px rgba(0,240,255,0.15), 0 0 80px rgba(168,85,247,0.12)',\n      duration: 0.08, ease: 'power2.out',\n    });\n    // Phase 3-4: Tilt wobble\n    pinnedTl.to(energyCard, { rotateY: 8, scale: 1.03, duration: 0.08, ease: 'power2.inOut' });\n    pinnedTl.to(energyCard, { rotateY: -8, scale: 1.02, duration: 0.08, ease: 'power2.inOut' });\n    // Phase 5: Settle\n    pinnedTl.to(energyCard, {\n      rotateY: 0, scale: 1,\n      boxShadow: '0 24px 80px rgba(0,0,0,0.5)',\n      duration: 0.12, ease: 'power2.out',\n    });\n    // Phase 6: Hold\n    pinnedTl.to(energyCard, { duration: 0.24 });\n    // Phase 7: Spin + exit\n    pinnedTl.to(energyCard, {\n      rotation: 360, scale: 0.7, y: -150, opacity: 0,\n      duration: 0.12, ease: 'power2.in',\n    });\n  }\n\n  // ★ PUSH-PULL DEPTH DANCE: Scroll-driven depth oscillation\n  // bg and card trade depth positions as the user scrolls\n  const energyBgWrap = document.getElementById('energyBgWrap');\n  const energyCardShadow = document.getElementById('energyCardShadow');\n  const energyBgVignette = document.getElementById('energyBgVignette');\n\n  ScrollTrigger.create({\n    trigger: '#energySection', start: 'top top', end: 'bottom bottom', scrub: 0.5,\n    onUpdate: (self) => {\n      const bg = pool.get('energyBg');\n      if (!bg) return;\n      const p = self.progress;\n      const card = pool.get('energyCard');\n      const pulse = Math.sin(p * Math.PI);\n\n      // ── PUSH-PULL DEPTH: 5 phases ──\n      let cardDepth, bgDepth; // 0=far, 1=close\n      if (p < 0.15) {\n        // Phase 1: card enters from MAX DEPTH, bg at foreground\n        const t = p / 0.15;\n        cardDepth = lerp(0.0, 0.3, smoothstep(t));\n        bgDepth = lerp(0.9, 0.8, t);\n      } else if (p < 0.35) {\n        // Phase 2: card approaches, bg retreats — cross at ~25%\n        const t = (p - 0.15) / 0.2;\n        cardDepth = lerp(0.3, 0.8, smoothstep(t));\n        bgDepth = lerp(0.8, 0.3, smoothstep(t));\n      } else if (p < 0.6) {\n        // Phase 3: HOLD — both moderate, tilt-interactive depth\n        const t = (p - 0.35) / 0.25;\n        const breathe = Math.sin(t * Math.PI * 2) * 0.15;\n        cardDepth = 0.7 + breathe;\n        bgDepth = 0.4 - breathe;\n      } else if (p < 0.8) {\n        // Phase 4: DRAIN — card retreats, bg surges forward\n        const t = (p - 0.6) / 0.2;\n        cardDepth = lerp(0.7, 0.2, smoothstep(t));\n        bgDepth = lerp(0.4, 0.85, smoothstep(t));\n      } else {\n        // Phase 5: EXIT SPIN — card spirals to distance\n        const t = (p - 0.8) / 0.2;\n        cardDepth = lerp(0.2, 0.0, smoothstep(t));\n        bgDepth = lerp(0.85, 0.5, smoothstep(t));\n      }\n\n      // ── Apply depth to params ──\n      const bgDensity = lerp(55, 8, bgDepth);\n      const cardDensity = lerp(55, 8, cardDepth);\n\n      // Background params\n      const bgHue = 270 + p * 80;\n      bg.setParams({\n        rot4dXW: p * Math.PI * 3 * (bgDepth > cardDepth ? 1 : -0.7),\n        rot4dYW: Math.sin(p * Math.PI * 2) * 1.5,\n        rot4dZW: p * Math.PI * 0.4,\n        hue: bgHue,\n        gridDensity: Math.max(8, Math.min(55, bgDensity)),\n        intensity: lerp(0.2, 0.85, bgDepth),\n        chaos: lerp(0.05, 0.4, bgDepth),\n        speed: lerp(0.1, 1.0, bgDepth),\n        morphFactor: 0.6 + pulse * 0.5,\n      });\n\n      // Card cross-feed\n      if (card) {\n        card.setParams({\n          gridDensity: Math.max(6, Math.min(50, cardDensity)),\n          intensity: lerp(0.15, 0.85, cardDepth),\n          speed: lerp(0.1, 1.2, cardDepth),\n          chaos: lerp(0.02, 0.35, cardDepth),\n          rot4dXW: p * Math.PI * 3 * (cardDepth > bgDepth ? 1 : -0.7) + (p > 0.8 ? (p - 0.8) / 0.2 * Math.PI * 4 : 0),\n        });\n        // Chromatic border driven by rotation\n        updateChroma(document.getElementById('energyCard'), card);\n      }\n\n      // CSS depth on bg container\n      if (energyBgWrap) {\n        energyBgWrap.style.transform = `scale(${lerp(0.92, 1.05, bgDepth)})`;\n        energyBgWrap.style.filter = bgDepth < 0.3 ? `blur(${lerp(4, 0, bgDepth / 0.3)}px)` : 'none';\n      }\n\n      // Card shadow responds to its depth\n      updateDepthShadow(energyCardShadow, cardDepth);\n      // Bg vignette\n      updateVignette(energyBgVignette, bgDensity);\n\n      // CROSS-POINT FLASH: when card and bg are at same depth\n      const depthDiff = Math.abs(cardDepth - bgDepth);\n      if (depthDiff < 0.1) {\n        const flash = (0.1 - depthDiff) / 0.1;\n        bg.setParam('chaos', Math.min(0.7, bg.params.chaos + flash * 0.3));\n        if (card) card.setParam('chaos', Math.min(0.7, (card.params.chaos || 0) + flash * 0.3));\n      }\n    },\n  });\n\n  // Energy transfer button interaction\n  const energyBtn = document.getElementById('energyBtn');\n  const energyFill = document.getElementById('energyFill');\n  if (energyBtn) {\n    let sweeping = false;\n    function energySweep() {\n      if (sweeping) return;\n      sweeping = true;\n      const card = pool.get('energyCard');\n      const bg = pool.get('energyBg');\n      if (!card && !bg) { sweeping = false; return; }\n\n      const tl = gsap.timeline({ onComplete: () => { sweeping = false; } });\n\n      // Drain card → background\n      if (card) tl.to(card.params, { intensity: 0.05, gridDensity: 4, chaos: 0.6, hue: 320, duration: 0.8, ease: 'power3.in', onUpdate: () => card.render() }, 0);\n      if (bg) tl.to(bg.params, { intensity: 0.8, gridDensity: 55, chaos: 0.5, hue: 180, morphFactor: 1.5, duration: 0.8, ease: 'power2.out', onUpdate: () => bg.render() }, 0);\n      tl.to(energyFill, { width: '5%', duration: 0.8, ease: 'power3.in' }, 0);\n\n      // Morph phase\n      if (card) tl.to(card.params, { hue: 270, geometry: 5, rot4dXW: Math.PI, duration: 0.6, ease: 'power2.inOut', onUpdate: () => card.render() }, 0.8);\n      if (bg) tl.to(bg.params, { hue: 60, geometry: 3, duration: 0.6, ease: 'power2.inOut', onUpdate: () => bg.render() }, 0.8);\n\n      // Card visual squeeze/release\n      tl.to('#energyCard', { scale: 0.94, rotateX: 5, borderColor: 'rgba(123,63,242,0.4)', boxShadow: '0 0 60px rgba(123,63,242,0.2)', duration: 0.5, ease: 'power2.in' }, 0);\n      tl.to('#energyCard', { scale: 1, rotateX: 0, borderColor: 'rgba(255,255,255,0.06)', boxShadow: '0 24px 80px rgba(0,0,0,0.5)', duration: 0.8, ease: 'elastic.out(1, 0.4)' }, 1.4);\n\n      // Restore\n      if (card) tl.to(card.params, { intensity: 0.6, gridDensity: 30, chaos: 0.1, hue: 180, geometry: 7, rot4dXW: 0, duration: 1.2, ease: 'elastic.out(1, 0.5)', onUpdate: () => card.render() }, 1.5);\n      if (bg) tl.to(bg.params, { intensity: 0.2, gridDensity: 16, chaos: 0.05, hue: 270, morphFactor: 0.5, geometry: 6, duration: 1.2, ease: 'elastic.out(1, 0.5)', onUpdate: () => bg.render() }, 1.5);\n      tl.to(energyFill, { width: '50%', duration: 1, ease: 'elastic.out(1, 0.5)' }, 1.5);\n    }\n\n    energyBtn.addEventListener('click', energySweep);\n    energyBtn.addEventListener('touchstart', (e) => { e.preventDefault(); energySweep(); });\n  }\n}\n\n// ─── AGENT — GPU Holographic Background ─────────────────────\n\nexport function initAgent(pool) {\n  ScrollTrigger.create({\n    trigger: '#agentSection', start: 'top 90%', end: 'bottom top',\n    onEnter: () => pool.acquire('agent', 'agent-canvas', HolographicAdapter, {\n      geometry: 3, hue: 240, gridDensity: 18, speed: 0.4,\n      intensity: 0.5, chaos: 0.15, dimension: 3.5, morphFactor: 0.6, saturation: 0.8,\n    }),\n    onLeave: () => pool.release('agent'),\n    onEnterBack: () => pool.acquire('agent', 'agent-canvas', HolographicAdapter, {\n      geometry: 3, hue: 240, gridDensity: 18, speed: 0.4,\n      intensity: 0.5, chaos: 0.15, dimension: 3.5, morphFactor: 0.6, saturation: 0.8,\n    }),\n    onLeaveBack: () => pool.release('agent'),\n  });\n\n  // Scroll-driven: holographic system evolves as user scrolls through cards\n  ScrollTrigger.create({\n    trigger: '#agentSection', start: 'top bottom', end: 'bottom top', scrub: 0.5,\n    onUpdate: (self) => {\n      const agent = pool.get('agent');\n      if (!agent) return;\n      const p = self.progress;\n      const pulse = Math.sin(p * Math.PI);\n      agent.setParams({\n        rot4dXW: p * Math.PI * 2,\n        rot4dYW: Math.sin(p * Math.PI * 2) * 1.0,\n        hue: 240 + p * 80 + pulse * 20,\n        gridDensity: 18 + pulse * 16,\n        intensity: 0.5 + pulse * 0.3,\n        speed: 0.4 + pulse * 0.5,\n        chaos: 0.15 + p * 0.2,\n        morphFactor: 0.6 + pulse * 0.4,\n      });\n    },\n  });\n}\n\n// ─── CTA — Dual GPU Finale (Quantum + Faceted dueling) ──────\n\nexport function initCTA(pool) {\n  // Dual GPU lifecycle: Quantum left + Faceted right\n  ScrollTrigger.create({\n    trigger: '#ctaSection', start: 'top 90%', end: 'bottom top',\n    onEnter: () => {\n      pool.acquire('ctaL', 'cta-canvas-left', QuantumAdapter, {\n        geometry: 5, hue: 200, gridDensity: 16, speed: 0.3,\n        intensity: 0.3, chaos: 0.1, dimension: 3.5, morphFactor: 0.5, saturation: 0.85,\n      });\n      pool.acquire('ctaR', 'cta-canvas-right', FacetedAdapter, {\n        geometry: 7, hue: 320, gridDensity: 20, speed: 0.4,\n        intensity: 0.3, chaos: 0.12, dimension: 3.4, morphFactor: 0.6, saturation: 0.9,\n      });\n    },\n    onLeave: () => { pool.release('ctaL'); pool.release('ctaR'); },\n    onEnterBack: () => {\n      pool.acquire('ctaL', 'cta-canvas-left', QuantumAdapter, {\n        geometry: 5, hue: 200, gridDensity: 16, speed: 0.3,\n        intensity: 0.3, chaos: 0.1, dimension: 3.5, morphFactor: 0.5, saturation: 0.85,\n      });\n      pool.acquire('ctaR', 'cta-canvas-right', FacetedAdapter, {\n        geometry: 7, hue: 320, gridDensity: 20, speed: 0.4,\n        intensity: 0.3, chaos: 0.12, dimension: 3.4, morphFactor: 0.6, saturation: 0.9,\n      });\n    },\n    onLeaveBack: () => { pool.release('ctaL'); pool.release('ctaR'); },\n  });\n\n  // ★ 3-ACT DEPTH STORY: opposition → crossover → unity\n  const ctaSeam = document.getElementById('ctaSeam');\n  const ctaVignette = document.getElementById('ctaVignette');\n  const ctaLeftWrap = document.getElementById('ctaGpuLeft');\n  const ctaRightWrap = document.getElementById('ctaGpuRight');\n\n  ScrollTrigger.create({\n    trigger: '#ctaSection', start: 'top bottom', end: 'bottom bottom', scrub: 1.0,\n    onUpdate: (self) => {\n      const ctaL = pool.get('ctaL');\n      const ctaR = pool.get('ctaR');\n      if (!ctaL && !ctaR) return;\n      const p = self.progress;\n      const pulse = Math.sin(p * Math.PI);\n\n      // ── ACT I (0-40%): MAXIMUM SEPARATION — opposite depth extremes\n      // ── ACT II (40-70%): DEPTH CROSSOVER — systems swap depth positions\n      // ── ACT III (70-100%): UNITY — converge to same params + depth\n      let depthL, depthR;\n      if (p < 0.4) {\n        // L=FOREGROUND, R=BACKGROUND\n        const t = p / 0.4;\n        depthL = lerp(0.9, 0.85, t);\n        depthR = lerp(0.1, 0.15, t);\n      } else if (p < 0.7) {\n        // CROSSOVER: L retreats, R advances\n        const t = (p - 0.4) / 0.3;\n        const s = smoothstep(t);\n        depthL = lerp(0.85, 0.15, s);\n        depthR = lerp(0.15, 0.85, s);\n      } else {\n        // UNITY: both converge to same depth\n        const t = (p - 0.7) / 0.3;\n        const s = smoothstep(t);\n        depthL = lerp(0.15, 0.55, s);\n        depthR = lerp(0.85, 0.55, s);\n      }\n\n      const denL = lerp(50, 8, depthL);\n      const denR = lerp(50, 8, depthR);\n      const conv = smoothstep(clamp01((p - 0.7) / 0.3));\n      const unifiedHue = 220;\n      const unifiedGeo = 11;\n\n      // CROSSOVER CHAOS: maximum energy at the crossing point (~55%)\n      const crossoverIntensity = (p > 0.45 && p < 0.65)\n        ? Math.sin((p - 0.45) / 0.2 * Math.PI) * 0.4 : 0;\n\n      if (ctaL) {\n        const hueL = lerp(200, unifiedHue, conv);\n        ctaL.setParams({\n          geometry: p < 0.3 ? 5 : p < 0.6 ? 2 : unifiedGeo,\n          hue: hueL + pulse * 20 * (1 - conv),\n          rot4dXW: p * Math.PI * 3,\n          rot4dYW: Math.sin(p * Math.PI * 2) * 1.5 * (1 - conv),\n          rot4dZW: p * Math.PI * 0.5,\n          gridDensity: Math.max(6, Math.min(55, denL)),\n          intensity: lerp(0.2, 0.85, depthL),\n          speed: lerp(0.15, 1.0, depthL),\n          chaos: lerp(0.02, 0.3, depthL) + crossoverIntensity,\n          morphFactor: 0.5 + p * 0.6,\n          saturation: 0.85 + conv * 0.1,\n        });\n      }\n      if (ctaR) {\n        const hueR = lerp(320, unifiedHue, conv);\n        ctaR.setParams({\n          geometry: p < 0.3 ? 7 : p < 0.6 ? 4 : unifiedGeo,\n          hue: hueR - pulse * 20 * (1 - conv),\n          rot4dXW: -p * Math.PI * 3 * (1 - conv) + p * Math.PI * 3 * conv,\n          rot4dYW: Math.cos(p * Math.PI * 2) * 1.5 * (1 - conv),\n          rot4dZW: -p * Math.PI * 0.5 * (1 - conv),\n          gridDensity: Math.max(6, Math.min(55, denR)),\n          intensity: lerp(0.2, 0.85, depthR),\n          speed: lerp(0.15, 1.0, depthR),\n          chaos: lerp(0.02, 0.3, depthR) + crossoverIntensity,\n          morphFactor: 0.6 + p * 0.5,\n          saturation: 0.9 + conv * 0.05,\n        });\n      }\n\n      // CSS depth on containers\n      if (ctaLeftWrap) {\n        ctaLeftWrap.style.filter = depthL < 0.3 ? `blur(${lerp(4, 0, depthL / 0.3)}px)` : 'none';\n      }\n      if (ctaRightWrap) {\n        ctaRightWrap.style.filter = depthR < 0.3 ? `blur(${lerp(4, 0, depthR / 0.3)}px)` : 'none';\n      }\n\n      // Diagonal split morphs toward vertical during convergence\n      if (ctaLeftWrap && ctaRightWrap) {\n        const topR = lerp(100, 50, conv);\n        const botL = lerp(0, 50, conv);\n        ctaLeftWrap.style.clipPath = `polygon(0 0, ${topR}% 0, ${botL}% 100%, 0 100%)`;\n        ctaRightWrap.style.clipPath = `polygon(${topR}% 0, 100% 0, 100% 100%, ${botL}% 100%)`;\n      }\n\n      // Glow seam: maximum at crossover, fades at unity\n      updateGlowSeam(ctaSeam, ctaL, ctaR);\n\n      // During crossover blend moment: overlap + screen blend\n      if (p > 0.5 && p < 0.6 && ctaLeftWrap && ctaRightWrap) {\n        const blendP = (p - 0.5) / 0.1;\n        const overlap = Math.sin(blendP * Math.PI) * 0.15;\n        ctaLeftWrap.style.opacity = `${1 - overlap}`;\n        ctaRightWrap.style.opacity = `${1 - overlap}`;\n      } else {\n        if (ctaLeftWrap) ctaLeftWrap.style.opacity = '1';\n        if (ctaRightWrap) ctaRightWrap.style.opacity = '1';\n      }\n\n      // Vignette: tightens during maximum depth separation, relaxes at unity\n      const maxDenBoth = Math.max(denL, denR);\n      updateVignette(ctaVignette, maxDenBoth);\n    },\n  });\n}\n\n// ─── Section Reveal Animations ──────────────────────────────\n\n// ─── SECTION TRANSITION PORTALS (replaces old faint veil system) ─────\n// CSS clip-path portals between sections: a growing shape reveals the next section\n// with glowing edges instead of a confusing faint glassmorphic square.\n// Also pulses divider gradients during transitions.\n\nexport function initSectionVeils() {\n  // Portal transitions at GPU swap boundaries\n  const portals = [\n    {\n      trigger: '#divider-hero-morph',\n      nextSection: '#morphSection',\n      hue: 220,\n    },\n    {\n      trigger: '#divider-morph-playground',\n      nextSection: '#playgroundSection',\n      hue: 280,\n    },\n    {\n      trigger: '#divider-playground-triptych',\n      nextSection: '#triptychSection',\n      hue: 190,\n    },\n    {\n      trigger: '#divider-cascade-energy',\n      nextSection: '#energySection',\n      hue: 310,\n    },\n  ];\n\n  // Hide the old veil entirely — we use per-section effects instead\n  const oldVeil = document.getElementById('sectionVeil');\n  if (oldVeil) oldVeil.style.display = 'none';\n\n  portals.forEach(({ trigger, nextSection, hue }) => {\n    const divider = document.querySelector(trigger);\n    const next = document.querySelector(nextSection);\n    if (!divider) return;\n\n    // Divider glow pulse during scroll-through\n    ScrollTrigger.create({\n      trigger: divider,\n      start: 'top 95%',\n      end: 'bottom 5%',\n      scrub: 0.2,\n      onUpdate: (self) => {\n        const p = self.progress;\n        const bell = Math.sin(p * Math.PI);\n        const intensity = bell * bell;\n\n        // SVG path glow via filter\n        const svg = divider.querySelector('svg');\n        if (svg) {\n          svg.style.filter = intensity > 0.05\n            ? `drop-shadow(0 0 ${12 * intensity}px hsla(${hue}, 70%, 55%, ${intensity * 0.4}))`\n            : 'none';\n        }\n\n        // Next section clip-path reveal: grows from center point\n        if (next && intensity > 0.01) {\n          const reveal = smoothstep(clamp01((p - 0.3) / 0.7));\n          if (reveal > 0 && reveal < 1) {\n            next.style.clipPath = `circle(${reveal * 120}% at 50% 0%)`;\n          } else if (reveal >= 1) {\n            next.style.clipPath = '';\n          }\n        }\n      },\n      onLeave: () => {\n        if (next) next.style.clipPath = '';\n        const svg = divider.querySelector('svg');\n        if (svg) svg.style.filter = 'none';\n      },\n      onLeaveBack: () => {\n        if (next) next.style.clipPath = '';\n        const svg = divider.querySelector('svg');\n        if (svg) svg.style.filter = 'none';\n      },\n    });\n  });\n}\n\n// ─── SCROLL VELOCITY BURST (Event 4) ─────────────────────────\n// Fast scrolling triggers chaos/speed burst on all visible AmbientLattice renderers\n\nexport function initScrollVelocityBurst(c2d) {\n  let lastScroll = 0;\n  let lastTime = 0;\n  let burstActive = false;\n  let burstCooldown = 0;\n  const VELOCITY_THRESHOLD = 2500; // px/s\n  const BURST_DECAY = 500; // ms\n\n  const tick = () => {\n    const now = performance.now();\n    const scrollY = window.scrollY || window.pageYOffset;\n    const dt = now - lastTime;\n\n    if (dt > 0 && lastTime > 0) {\n      const velocity = Math.abs(scrollY - lastScroll) / (dt / 1000);\n\n      if (velocity > VELOCITY_THRESHOLD && !burstActive && now > burstCooldown) {\n        burstActive = true;\n        burstCooldown = now + BURST_DECAY + 1000;\n        const burstFactor = Math.min(1, velocity / 5000);\n\n        // Apply burst to all AmbientLattice renderers\n        const origParams = new Map();\n        for (const [key, inst] of c2d.entries()) {\n          origParams.set(key, {\n            chaos: inst.params.chaos,\n            speed: inst.params.speed,\n            intensity: inst.params.intensity,\n          });\n          inst.setParams({\n            chaos: Math.min(1, inst.params.chaos + burstFactor * 0.4),\n            speed: inst.params.speed * (1 + burstFactor * 1.5),\n            intensity: Math.min(1, inst.params.intensity + burstFactor * 0.2),\n          });\n        }\n\n        // CSS burst\n        document.documentElement.style.setProperty('--burst-intensity', burstFactor.toFixed(2));\n\n        // Decay back\n        setTimeout(() => {\n          for (const [key, orig] of origParams.entries()) {\n            const inst = c2d.get(key);\n            if (inst) inst.setParams(orig);\n          }\n          document.documentElement.style.setProperty('--burst-intensity', '0');\n          burstActive = false;\n        }, BURST_DECAY);\n      }\n    }\n\n    lastScroll = scrollY;\n    lastTime = now;\n    requestAnimationFrame(tick);\n  };\n  requestAnimationFrame(tick);\n}\n\n// ─── PHASE SHIFT BRIDGES (Event 6) ─────────────────────────\n// Between triptych→cascade and cascade→energy: slow structure build → snap → chaos settle\n\nexport function initPhaseShiftBridges(pool, c2d) {\n  // Bridge 1: Between triptych exit and cascade\n  ScrollTrigger.create({\n    trigger: '#triptychSection',\n    start: '80% top',\n    end: 'bottom top',\n    scrub: 0.3,\n    onUpdate: (self) => {\n      const p = self.progress;\n      // Structure build: all 3 triptych GPU systems crystallize together\n      const triL = pool.get('triLeft');\n      const triC = pool.get('triCenter');\n      const triR = pool.get('triRight');\n      const sp = smoothstep(p);\n      if (triL) {\n        triL.setParams({\n          gridDensity: lerp(22, 55, sp),\n          speed: lerp(0.4, 0.08, sp),\n          chaos: lerp(0.15, 0.01, sp),\n          intensity: lerp(0.65, 0.9, sp),\n        });\n      }\n      if (triC) {\n        triC.setParams({\n          gridDensity: lerp(20, 50, sp),\n          speed: lerp(0.5, 0.06, sp),\n          chaos: lerp(0.1, 0.005, sp),\n          intensity: lerp(0.5, 0.85, sp),\n        });\n      }\n      if (triR) {\n        triR.setParams({\n          gridDensity: lerp(18, 50, sp),\n          speed: lerp(0.5, 0.1, sp),\n          chaos: lerp(0.2, 0.02, sp),\n          intensity: lerp(0.65, 0.85, sp),\n        });\n      }\n    },\n  });\n\n  // Bridge 2: Cascade entrance snap\n  ScrollTrigger.create({\n    trigger: '#cascadeSection',\n    start: 'top 90%',\n    end: 'top 60%',\n    scrub: 0.2,\n    onUpdate: (self) => {\n      const p = self.progress;\n      // Snap: cascade cards get a brief chaos burst at entrance\n      const snap = p > 0.4 && p < 0.7;\n      if (snap) {\n        for (let i = 0; i < 6; i++) {\n          const inst = c2d.get(`cas${i}`);\n          if (inst) {\n            inst.setParams({\n              chaos: 0.6 * (1 - Math.abs(p - 0.55) / 0.15),\n              speed: 2.0 * (1 - Math.abs(p - 0.55) / 0.15),\n            });\n          }\n        }\n      }\n    },\n  });\n}\n\n// ─── SPEED CRESCENDO → SILENCE (Event 14) ─────────────────\n// Pre-CTA: all visible elements accelerate, then instant silence, then gentle CTA fade\n\nexport function initSpeedCrescendo(pool) {\n  ScrollTrigger.create({\n    trigger: '#agentSection',\n    start: '60% top',\n    end: 'bottom top',\n    scrub: 0.4,\n    onUpdate: (self) => {\n      const p = self.progress;\n\n      // Phase A (0-80%): EXPONENTIAL BUILD — cubic acceleration\n      if (p < 0.8) {\n        const build = p / 0.8;\n        const agent = pool.get('agent');\n        if (agent) {\n          exponentialBuild(build, agent);\n          // Additional rotation drama on top\n          agent.setParam('rot4dXW', build * Math.PI * 4);\n          agent.setParam('rot4dYW', Math.sin(build * Math.PI * 3) * 2);\n        }\n        document.documentElement.style.setProperty('--crescendo-vignette', (Math.pow(build, 2) * 0.35).toFixed(2));\n      }\n\n      // Phase B (80-88%): THE SILENCE — instant death\n      if (p >= 0.8 && p < 0.88) {\n        const agent = pool.get('agent');\n        if (agent) {\n          agent.setParams({ speed: 0, chaos: 0, intensity: 0.02, gridDensity: 4 });\n        }\n        document.documentElement.style.setProperty('--crescendo-vignette', '0');\n        document.documentElement.style.setProperty('--silence-blackout', '1');\n      }\n\n      // Phase C (88-100%): LOGARITHMIC CALM — gentle rebirth\n      if (p >= 0.88) {\n        const rebirth = (p - 0.88) / 0.12;\n        const agent = pool.get('agent');\n        if (agent) {\n          logarithmicCalm(1 - rebirth, agent);\n          // Override to gentler values for rebirth\n          agent.setParams({\n            speed: rebirth * 0.3,\n            intensity: rebirth * 0.35,\n            gridDensity: 8 + rebirth * 10,\n            chaos: rebirth * 0.12,\n          });\n        }\n        document.documentElement.style.setProperty('--silence-blackout', (1 - smoothstep(rebirth)).toFixed(2));\n      }\n    },\n    onLeave: () => {\n      document.documentElement.style.setProperty('--crescendo-vignette', '0');\n      document.documentElement.style.setProperty('--silence-blackout', '0');\n    },\n    onLeaveBack: () => {\n      document.documentElement.style.setProperty('--crescendo-vignette', '0');\n      document.documentElement.style.setProperty('--silence-blackout', '0');\n    },\n  });\n}\n\nexport function initSectionReveals() {\n  // ── data-animate: 3D depth reveal (VISUAL-CODEX: 3D transform pattern) ──\n  const reveals = document.querySelectorAll('[data-animate]');\n  reveals.forEach(el => {\n    gsap.from(el, {\n      y: 60, opacity: 0, rotateX: 8, scale: 0.97,\n      filter: 'blur(4px)',\n      duration: 1.0, ease: 'power3.out',\n      scrollTrigger: { trigger: el, start: 'top 82%', once: true },\n    });\n  });\n\n  // ── Agent cards: center-based stagger (VISUAL-CODEX: stagger pattern) ──\n  const agentCards = document.querySelectorAll('.agent-card');\n  if (agentCards.length > 0) {\n    gsap.from(agentCards, {\n      y: 50, opacity: 0, scale: 0.92, rotateY: -5,\n      duration: 0.8,\n      stagger: { amount: 0.5, from: 'center' },\n      ease: 'power3.out',\n      scrollTrigger: { trigger: '.agent-grid', start: 'top 80%', once: true },\n    });\n  }\n\n  // ── Code blocks: blur cascade reveal (VISUAL-CODEX: filter cascade) ──\n  const codeBlocks = document.querySelectorAll('.code-block, .agent-tools');\n  codeBlocks.forEach((block, i) => {\n    gsap.from(block, {\n      y: 30, opacity: 0, scale: 0.97,\n      filter: 'blur(6px) brightness(0.7)',\n      duration: 0.8, delay: i * 0.1,\n      ease: 'power2.out',\n      scrollTrigger: { trigger: block, start: 'top 85%', once: true },\n    });\n  });\n\n  // ── CTA: three-phase entrance (VISUAL-CODEX: three-phase animation) ──\n  const ctaContent = document.querySelector('.cta-content');\n  if (ctaContent) {\n    const ctaTl = gsap.timeline({\n      scrollTrigger: { trigger: '#ctaSection', start: 'top 70%', once: true },\n    });\n    // Phase 1: fade up from depth\n    ctaTl.from(ctaContent, {\n      y: 100, opacity: 0, scale: 0.9, rotateX: 5,\n      filter: 'blur(8px)',\n      duration: 0.8, ease: 'power3.out',\n    });\n    // Phase 2: overshoot settle\n    ctaTl.to(ctaContent, {\n      scale: 1.02, duration: 0.2, ease: 'power2.out',\n    });\n    // Phase 3: final position\n    ctaTl.to(ctaContent, {\n      scale: 1, filter: 'blur(0px)',\n      duration: 0.3, ease: 'power2.inOut',\n    });\n  }\n\n  // ── Playground controls: wave stagger (VISUAL-CODEX: stagger suite) ──\n  const ctrlGroups = document.querySelectorAll('.ctrl-group');\n  if (ctrlGroups.length > 0) {\n    gsap.from(ctrlGroups, {\n      y: 25, opacity: 0, scale: 0.95,\n      duration: 0.5,\n      stagger: { amount: 0.6, from: 'start' },\n      ease: 'back.out(1.2)',\n      scrollTrigger: { trigger: '#playgroundControls', start: 'top 85%', once: true },\n    });\n  }\n\n  // ── Triptych stats: counter-up animation ──\n  document.querySelectorAll('.stat-number').forEach(el => {\n    ScrollTrigger.create({\n      trigger: el, start: 'top 85%', once: true,\n      onEnter: () => {\n        gsap.from(el, {\n          scale: 0.5, opacity: 0, y: 20,\n          duration: 0.6, ease: 'back.out(2)',\n        });\n      },\n    });\n  });\n\n  // ── Section dividers: subtle parallax (VISUAL-CODEX: parallax depth) ──\n  document.querySelectorAll('.section-divider').forEach(div => {\n    gsap.to(div, {\n      y: -15, ease: 'none',\n      scrollTrigger: {\n        trigger: div, start: 'top bottom', end: 'bottom top', scrub: 1.5,\n      },\n    });\n  });\n\n  // ── Footer ──\n  const footer = document.querySelector('footer');\n  if (footer) {\n    gsap.from(footer, {\n      y: 30, opacity: 0,\n      duration: 0.8, ease: 'power2.out',\n      scrollTrigger: { trigger: footer, start: 'top 92%', once: true },\n    });\n  }\n\n  // ── Divider glow coordination: scroll progress drives --divider-glow ──\n  document.querySelectorAll('.section-divider[id]').forEach(divider => {\n    ScrollTrigger.create({\n      trigger: divider, start: 'top 90%', end: 'bottom 10%', scrub: 0.2,\n      onUpdate: (self) => {\n        const bell = Math.sin(self.progress * Math.PI);\n        divider.style.setProperty('--divider-glow', (bell * bell * 0.35).toFixed(3));\n      },\n      onLeave: () => divider.style.setProperty('--divider-glow', '0'),\n      onLeaveBack: () => divider.style.setProperty('--divider-glow', '0'),\n    });\n  });\n\n  // ── Canvas wrapper breathing: activate when in viewport ──\n  document.querySelectorAll('.canvas-wrap').forEach(wrap => {\n    ScrollTrigger.create({\n      trigger: wrap, start: 'top bottom', end: 'bottom top',\n      onEnter: () => wrap.classList.add('breathing'),\n      onLeave: () => wrap.classList.remove('breathing'),\n      onEnterBack: () => wrap.classList.add('breathing'),\n      onLeaveBack: () => wrap.classList.remove('breathing'),\n    });\n  });\n\n}\n","/**\n * Overlay Choreography System — CSS Accent Layers + Multi-Instance Mirrors\n *\n * Adds coordinated CSS effects on TOP of visualizer canvases:\n *   1. GradientWashLayer — scroll-reactive gradient washes over canvas sections\n *   2. MirrorReflection — CSS transform duplicates of canvases (no resize, no new GPU)\n *   3. EdgeGlowRing — animated border glow rings that pulse with visualizer params\n *   4. ParticleField — lightweight CSS particle system driven by scroll + params\n *   5. CrossfadeBridge — smooth inter-section transitions with coordinated CSS + params\n *\n * Key constraint: NEVER resizes or moves the actual canvas. All effects are CSS-only\n * layers positioned absolutely on top via pointer-events:none overlays.\n */\n\n// ─── Math Helpers ──────────────────────────────────────────────\nconst clamp01 = v => Math.max(0, Math.min(1, v));\nconst lerp = (a, b, t) => a + (b - a) * t;\nconst smoothstep = p => p * p * (3 - 2 * p);\n\n// ═══════════════════════════════════════════════════════════════\n//  1. GRADIENT WASH LAYER\n//     Animated radial/conic gradient overlays that respond to\n//     scroll position and visualizer parameters (hue, intensity)\n// ═══════════════════════════════════════════════════════════════\n\nexport class GradientWashLayer {\n  /**\n   * @param {string} containerId - parent element to overlay\n   * @param {object} opts - { mode: 'radial'|'conic'|'sweep', blendMode, baseOpacity }\n   */\n  constructor(containerId, opts = {}) {\n    this.container = document.getElementById(containerId);\n    if (!this.container) return;\n\n    this.mode = opts.mode || 'radial';\n    this.blendMode = opts.blendMode || 'screen';\n    this.baseOpacity = opts.baseOpacity ?? 0.12;\n    this.hue = opts.hue ?? 200;\n    this.intensity = opts.intensity ?? 0.5;\n    this.angle = 0;\n\n    this.el = document.createElement('div');\n    this.el.className = 'overlay-gradient-wash';\n    this.el.setAttribute('aria-hidden', 'true');\n    Object.assign(this.el.style, {\n      position: 'absolute', inset: '0',\n      pointerEvents: 'none',\n      zIndex: opts.zIndex ?? '6',\n      mixBlendMode: this.blendMode,\n      opacity: '0',\n      transition: 'opacity 0.4s ease-out',\n      willChange: 'background, opacity',\n    });\n    this.container.style.position = this.container.style.position || 'relative';\n    this.container.appendChild(this.el);\n  }\n\n  update(scrollProgress, params = {}) {\n    if (!this.el) return;\n    const hue = params.hue ?? this.hue;\n    const intensity = clamp01(params.intensity ?? this.intensity);\n    const chaos = params.chaos ?? 0;\n    const time = performance.now() * 0.001;\n\n    this.angle += (0.3 + chaos * 2) * 0.016; // ~60fps increment\n\n    const alpha = this.baseOpacity * intensity;\n    const sat = 70 + chaos * 20;\n    const light = 45 + intensity * 15;\n\n    if (this.mode === 'radial') {\n      // Mouse-following radial wash\n      const cx = 50 + Math.sin(time * 0.3 + scrollProgress * Math.PI * 2) * 20;\n      const cy = 50 + Math.cos(time * 0.2 + scrollProgress * Math.PI) * 15;\n      this.el.style.background = `radial-gradient(\n        ellipse 80% 80% at ${cx}% ${cy}%,\n        hsla(${hue}, ${sat}%, ${light}%, ${alpha}) 0%,\n        hsla(${(hue + 60) % 360}, ${sat}%, ${light - 10}%, ${alpha * 0.4}) 40%,\n        transparent 75%\n      )`;\n    } else if (this.mode === 'conic') {\n      const rotation = this.angle * 57.3; // rad → deg\n      this.el.style.background = `conic-gradient(\n        from ${rotation}deg at 50% 50%,\n        hsla(${hue}, ${sat}%, ${light}%, ${alpha}) 0deg,\n        transparent 60deg,\n        hsla(${(hue + 120) % 360}, ${sat}%, ${light}%, ${alpha * 0.6}) 120deg,\n        transparent 180deg,\n        hsla(${(hue + 240) % 360}, ${sat}%, ${light}%, ${alpha * 0.4}) 240deg,\n        transparent 300deg,\n        hsla(${hue}, ${sat}%, ${light}%, ${alpha}) 360deg\n      )`;\n    } else {\n      // Sweep: diagonal linear gradient that shifts with scroll\n      const angle = scrollProgress * 360;\n      this.el.style.background = `linear-gradient(\n        ${angle}deg,\n        hsla(${hue}, ${sat}%, ${light}%, ${alpha}) 0%,\n        transparent 35%,\n        hsla(${(hue + 180) % 360}, ${sat}%, ${light}%, ${alpha * 0.5}) 65%,\n        transparent 100%\n      )`;\n    }\n\n    this.el.style.opacity = intensity > 0.05 ? '1' : '0';\n  }\n\n  dispose() {\n    this.el?.remove();\n  }\n}\n\n// ═══════════════════════════════════════════════════════════════\n//  2. MIRROR REFLECTION SYSTEM\n//     Creates CSS-only \"reflections\" of a canvas using CSS transforms.\n//     No GPU contexts, no canvas resize — just a clipped, blended copy\n//     via CSS mask-image + transform + opacity layering.\n// ═══════════════════════════════════════════════════════════════\n\nexport class MirrorReflection {\n  /**\n   * @param {string} sourceCanvasId - canvas to mirror\n   * @param {string} containerId - parent to place mirror in\n   * @param {object} opts - { position, opacity, blendMode, maskGradient, transforms }\n   */\n  constructor(sourceCanvasId, containerId, opts = {}) {\n    this.sourceCanvas = document.getElementById(sourceCanvasId);\n    this.container = document.getElementById(containerId);\n    if (!this.sourceCanvas || !this.container) return;\n\n    this.position = opts.position || 'below'; // 'below' | 'above' | 'left' | 'right'\n    this.baseOpacity = opts.opacity ?? 0.15;\n    this.blendMode = opts.blendMode || 'screen';\n\n    // Create the mirror container\n    this.el = document.createElement('div');\n    this.el.className = `overlay-mirror mirror-${this.position}`;\n    this.el.setAttribute('aria-hidden', 'true');\n\n    const posStyles = this._getPositionStyles();\n    Object.assign(this.el.style, {\n      position: 'absolute',\n      pointerEvents: 'none',\n      overflow: 'hidden',\n      mixBlendMode: this.blendMode,\n      opacity: String(this.baseOpacity),\n      zIndex: opts.zIndex ?? '3',\n      willChange: 'transform, opacity',\n      transition: 'opacity 0.5s ease-out, transform 0.3s ease-out',\n      ...posStyles,\n    });\n\n    // Fade mask: the reflection fades to transparent\n    const maskDir = this.position === 'below' ? 'to bottom'\n      : this.position === 'above' ? 'to top'\n      : this.position === 'left' ? 'to left' : 'to right';\n    this.el.style.maskImage = opts.maskGradient\n      || `linear-gradient(${maskDir}, rgba(0,0,0,0.7) 0%, transparent 80%)`;\n    this.el.style.webkitMaskImage = this.el.style.maskImage;\n\n    this.container.style.position = this.container.style.position || 'relative';\n    this.container.appendChild(this.el);\n    this._startCopyLoop();\n  }\n\n  _getPositionStyles() {\n    switch (this.position) {\n      case 'below': return {\n        left: '0', right: '0', top: '100%', height: '40%',\n        transform: 'scaleY(-1)',\n      };\n      case 'above': return {\n        left: '0', right: '0', bottom: '100%', height: '30%',\n        transform: 'scaleY(-1)',\n      };\n      case 'left': return {\n        right: '100%', top: '0', bottom: '0', width: '25%',\n        transform: 'scaleX(-1)',\n      };\n      case 'right': return {\n        left: '100%', top: '0', bottom: '0', width: '25%',\n        transform: 'scaleX(-1)',\n      };\n      default: return {};\n    }\n  }\n\n  _startCopyLoop() {\n    // Use a 2D canvas to periodically snapshot the source canvas\n    this._copyCanvas = document.createElement('canvas');\n    this._copyCtx = this._copyCanvas.getContext('2d', { alpha: true });\n    this._copyCanvas.style.cssText = 'width:100%;height:100%;display:block;';\n    this.el.appendChild(this._copyCanvas);\n\n    this._frameCount = 0;\n    this._copyLoop();\n  }\n\n  _copyLoop() {\n    if (!this.sourceCanvas || !this._copyCtx) return;\n\n    this._frameCount++;\n    // Copy every 3rd frame to save CPU (mirrors don't need full framerate)\n    if (this._frameCount % 3 === 0) {\n      const src = this.sourceCanvas;\n      const dst = this._copyCanvas;\n      if (src.width > 0 && src.height > 0) {\n        if (dst.width !== src.width || dst.height !== src.height) {\n          dst.width = src.width;\n          dst.height = src.height;\n        }\n        try {\n          this._copyCtx.drawImage(src, 0, 0);\n        } catch (_) { /* cross-origin or lost context, silently skip */ }\n      }\n    }\n\n    this._rafId = requestAnimationFrame(() => this._copyLoop());\n  }\n\n  /**\n   * Update mirror opacity/transform based on scroll or params\n   */\n  update(scrollProgress, params = {}) {\n    if (!this.el) return;\n    const intensity = clamp01(params.intensity ?? 0.5);\n    this.el.style.opacity = String(this.baseOpacity * intensity);\n\n    // Subtle parallax shift with scroll\n    const offset = (scrollProgress - 0.5) * 20;\n    const base = this._getPositionStyles().transform || '';\n    if (this.position === 'below' || this.position === 'above') {\n      this.el.style.transform = `${base} translateY(${offset}px)`;\n    } else {\n      this.el.style.transform = `${base} translateX(${offset}px)`;\n    }\n  }\n\n  dispose() {\n    if (this._rafId) cancelAnimationFrame(this._rafId);\n    this.el?.remove();\n  }\n}\n\n// ═══════════════════════════════════════════════════════════════\n//  3. EDGE GLOW RING\n//     Animated pulsing border glow that syncs with visualizer params.\n//     Uses box-shadow + pseudo-element conic gradient.\n// ═══════════════════════════════════════════════════════════════\n\nexport class EdgeGlowRing {\n  /**\n   * @param {string} targetId - element to apply glow ring to\n   * @param {object} opts - { baseSize, pulseScale, color }\n   */\n  constructor(targetId, opts = {}) {\n    this.target = document.getElementById(targetId);\n    if (!this.target) return;\n\n    this.baseSize = opts.baseSize ?? 8;\n    this.pulseScale = opts.pulseScale ?? 2.5;\n    this.hue = opts.hue ?? 200;\n\n    // Create pseudo-layer for the ring\n    this.el = document.createElement('div');\n    this.el.className = 'overlay-edge-glow';\n    this.el.setAttribute('aria-hidden', 'true');\n    Object.assign(this.el.style, {\n      position: 'absolute',\n      inset: `-${this.baseSize}px`,\n      borderRadius: 'inherit',\n      pointerEvents: 'none',\n      zIndex: opts.zIndex ?? '7',\n      opacity: '0',\n      transition: 'opacity 0.3s ease-out',\n    });\n\n    this.target.style.position = this.target.style.position || 'relative';\n    this.target.appendChild(this.el);\n  }\n\n  update(scrollProgress, params = {}) {\n    if (!this.el) return;\n    const hue = params.hue ?? this.hue;\n    const intensity = clamp01(params.intensity ?? 0.5);\n    const chaos = clamp01(params.chaos ?? 0);\n    const speed = params.speed ?? 1;\n    const time = performance.now() * 0.001;\n\n    const pulse = Math.sin(time * speed * 2) * 0.5 + 0.5;\n    const glowSize = this.baseSize + pulse * this.pulseScale * (1 + chaos);\n    const alpha = (0.15 + intensity * 0.3 + chaos * 0.15) * pulse;\n\n    this.el.style.boxShadow = [\n      `0 0 ${glowSize}px hsla(${hue}, 80%, 55%, ${alpha})`,\n      `inset 0 0 ${glowSize * 0.6}px hsla(${(hue + 30) % 360}, 70%, 50%, ${alpha * 0.5})`,\n    ].join(', ');\n\n    this.el.style.opacity = intensity > 0.1 ? '1' : '0';\n  }\n\n  dispose() {\n    this.el?.remove();\n  }\n}\n\n// ═══════════════════════════════════════════════════════════════\n//  4. CSS PARTICLE FIELD\n//     Lightweight scroll-driven particles using CSS animations.\n//     No canvas, no GPU — pure DOM + animation.\n//     Particles spawn at scroll events, drift with time, fade out.\n// ═══════════════════════════════════════════════════════════════\n\nexport class ParticleField {\n  /**\n   * @param {string} containerId - element to host particles\n   * @param {object} opts - { count, hue, spread, lifespan }\n   */\n  constructor(containerId, opts = {}) {\n    this.container = document.getElementById(containerId);\n    if (!this.container) return;\n\n    this.maxCount = opts.count ?? 20;\n    this.hue = opts.hue ?? 200;\n    this.spread = opts.spread ?? 200;\n    this.lifespan = opts.lifespan ?? 4000;\n    this.particles = [];\n\n    this.el = document.createElement('div');\n    this.el.className = 'overlay-particle-field';\n    this.el.setAttribute('aria-hidden', 'true');\n    Object.assign(this.el.style, {\n      position: 'absolute', inset: '0',\n      pointerEvents: 'none', overflow: 'hidden',\n      zIndex: opts.zIndex ?? '5',\n    });\n\n    this.container.style.position = this.container.style.position || 'relative';\n    this.container.appendChild(this.el);\n\n    // Seed initial particles\n    for (let i = 0; i < Math.floor(this.maxCount * 0.6); i++) {\n      this._spawn(true);\n    }\n  }\n\n  _spawn(randomStart = false) {\n    if (this.particles.length >= this.maxCount) return;\n\n    const p = document.createElement('span');\n    const size = 2 + Math.random() * 3;\n    const x = Math.random() * 100;\n    const y = Math.random() * 100;\n    const dx = (Math.random() - 0.5) * this.spread;\n    const dy = -20 - Math.random() * this.spread * 0.6;\n    const dur = this.lifespan * (0.6 + Math.random() * 0.8);\n    const delay = randomStart ? -Math.random() * dur : 0;\n    const hueShift = Math.random() * 60 - 30;\n\n    Object.assign(p.style, {\n      position: 'absolute',\n      left: `${x}%`, top: `${y}%`,\n      width: `${size}px`, height: `${size}px`,\n      borderRadius: '50%',\n      background: `hsla(${this.hue + hueShift}, 70%, 70%, 0.6)`,\n      boxShadow: `0 0 ${size * 2}px hsla(${this.hue + hueShift}, 70%, 60%, 0.3)`,\n      '--dx': `${dx}px`, '--dy': `${dy}px`,\n      '--particle-dur': `${dur}ms`,\n      animation: `particle-drift ${dur}ms linear infinite`,\n      animationDelay: `${delay}ms`,\n    });\n\n    this.el.appendChild(p);\n    this.particles.push(p);\n  }\n\n  update(scrollProgress, params = {}) {\n    if (!this.el) return;\n    this.hue = params.hue ?? this.hue;\n    const intensity = clamp01(params.intensity ?? 0.5);\n    const chaos = clamp01(params.chaos ?? 0);\n\n    // Adjust particle visibility based on intensity\n    this.el.style.opacity = String(0.3 + intensity * 0.7);\n\n    // Chaos spawns burst particles\n    if (chaos > 0.4 && this.particles.length < this.maxCount) {\n      this._spawn();\n    }\n\n    // Update particle hues (batch — only recolor every 60 frames)\n    if (!this._frameCount) this._frameCount = 0;\n    this._frameCount++;\n    if (this._frameCount % 60 === 0) {\n      this.particles.forEach((p, i) => {\n        const shift = Math.sin(i * 0.5) * 40;\n        p.style.background = `hsla(${this.hue + shift}, 70%, 70%, ${0.3 + intensity * 0.4})`;\n      });\n    }\n  }\n\n  dispose() {\n    this.el?.remove();\n    this.particles = [];\n  }\n}\n\n// ═══════════════════════════════════════════════════════════════\n//  5. CROSSFADE BRIDGE\n//     Smooth section-to-section transitions:\n//     - CSS overlay fades between section colors\n//     - Coordinates parameter ramps between outgoing/incoming adapters\n//     - Accent effects: border glow pulse, particle burst, gradient sweep\n//     All without resizing or touching the canvas itself.\n// ═══════════════════════════════════════════════════════════════\n\nexport class CrossfadeBridge {\n  /**\n   * @param {object} opts - { triggerSelector, outHue, inHue, duration }\n   */\n  constructor(opts = {}) {\n    this.outHue = opts.outHue ?? 200;\n    this.inHue = opts.inHue ?? 280;\n\n    // Create fixed overlay for bridge effect\n    this.el = document.createElement('div');\n    this.el.className = 'overlay-crossfade-bridge';\n    this.el.setAttribute('aria-hidden', 'true');\n    Object.assign(this.el.style, {\n      position: 'fixed', inset: '0',\n      pointerEvents: 'none',\n      zIndex: '45',\n      opacity: '0',\n      willChange: 'opacity, background',\n      transition: 'opacity 0.2s ease-out',\n    });\n    document.body.appendChild(this.el);\n  }\n\n  /**\n   * Drive the bridge effect from scroll progress (0-1 across the transition zone)\n   * @param {number} progress - 0=start of transition, 1=end\n   * @param {object} outAdapter - departing visualizer adapter\n   * @param {object} inAdapter - incoming visualizer adapter\n   */\n  update(progress, outAdapter, inAdapter) {\n    if (!this.el) return;\n    const p = clamp01(progress);\n\n    // Bell curve: peak at midpoint, zero at edges\n    const bell = Math.sin(p * Math.PI);\n    const bellSq = bell * bell;\n\n    // Gradient overlay: outHue fading to inHue\n    const hue = lerp(this.outHue, this.inHue, smoothstep(p));\n    const alpha = bellSq * 0.08;\n\n    this.el.style.background = `radial-gradient(\n      ellipse 120% 100% at 50% ${lerp(100, 0, p)}%,\n      hsla(${hue}, 60%, 50%, ${alpha}) 0%,\n      hsla(${hue}, 40%, 30%, ${alpha * 0.4}) 40%,\n      transparent 70%\n    )`;\n    this.el.style.opacity = bellSq > 0.01 ? '1' : '0';\n\n    // Cross-coordinate parameters on adapters\n    if (outAdapter && p < 0.7) {\n      const fadeOut = smoothstep(clamp01(p / 0.7));\n      outAdapter.setParams({\n        intensity: lerp(outAdapter.params?.intensity ?? 0.7, 0.1, fadeOut),\n        speed: lerp(outAdapter.params?.speed ?? 0.5, 0.05, fadeOut),\n        gridDensity: lerp(outAdapter.params?.gridDensity ?? 24, 55, fadeOut),\n      });\n    }\n\n    if (inAdapter && p > 0.3) {\n      const fadeIn = smoothstep(clamp01((p - 0.3) / 0.7));\n      inAdapter.setParams({\n        intensity: lerp(0.05, inAdapter.params?.intensity ?? 0.7, fadeIn),\n        speed: lerp(0.02, inAdapter.params?.speed ?? 0.5, fadeIn),\n        gridDensity: lerp(60, inAdapter.params?.gridDensity ?? 24, fadeIn),\n      });\n    }\n  }\n\n  dispose() {\n    this.el?.remove();\n  }\n}\n\n// ═══════════════════════════════════════════════════════════════\n//  6. SCROLL-SYNCED ACCENT CHOREOGRAPHER\n//     Master controller that coordinates all overlay systems\n//     with GSAP ScrollTrigger for per-section orchestration.\n// ═══════════════════════════════════════════════════════════════\n\nexport class AccentChoreographer {\n  constructor() {\n    this.layers = new Map();\n    this.bridges = [];\n    this._rafId = null;\n  }\n\n  /**\n   * Register an overlay layer with a section\n   * @param {string} key - unique identifier\n   * @param {object} layer - any overlay object with update(progress, params) method\n   * @param {object} opts - { section, adapter, paramSource }\n   */\n  register(key, layer, opts = {}) {\n    this.layers.set(key, { layer, opts });\n  }\n\n  /**\n   * Register a crossfade bridge between two sections\n   */\n  registerBridge(bridge, opts = {}) {\n    this.bridges.push({ bridge, ...opts });\n  }\n\n  /**\n   * Initialize all scroll triggers for registered layers.\n   * Call AFTER all GSAP ScrollTriggers are registered.\n   */\n  initScrollTriggers() {\n    if (typeof ScrollTrigger === 'undefined') return;\n\n    for (const [key, { layer, opts }] of this.layers.entries()) {\n      if (!opts.trigger) continue;\n      ScrollTrigger.create({\n        trigger: opts.trigger,\n        start: opts.start || 'top bottom',\n        end: opts.end || 'bottom top',\n        scrub: opts.scrub ?? 0.3,\n        onUpdate: (self) => {\n          const p = self.progress;\n          const adapter = typeof opts.adapter === 'function' ? opts.adapter() : opts.adapter;\n          const params = adapter?.params || {};\n          layer.update(p, params);\n        },\n      });\n    }\n\n    // Register bridge scroll triggers\n    for (const b of this.bridges) {\n      if (!b.trigger) continue;\n      ScrollTrigger.create({\n        trigger: b.trigger,\n        start: b.start || 'top 80%',\n        end: b.end || 'top 20%',\n        scrub: 0.2,\n        onUpdate: (self) => {\n          const outAdapter = typeof b.outAdapter === 'function' ? b.outAdapter() : b.outAdapter;\n          const inAdapter = typeof b.inAdapter === 'function' ? b.inAdapter() : b.inAdapter;\n          b.bridge.update(self.progress, outAdapter, inAdapter);\n        },\n      });\n    }\n  }\n\n  dispose() {\n    for (const [_, { layer }] of this.layers.entries()) {\n      layer.dispose?.();\n    }\n    for (const b of this.bridges) {\n      b.bridge.dispose?.();\n    }\n    this.layers.clear();\n    this.bridges = [];\n  }\n}\n\n// ═══════════════════════════════════════════════════════════════\n//  7. SECTION TRANSITION RIPPLE\n//     CSS-only radial ripple that fires at section boundaries.\n//     Expands from the section divider position, colored by the\n//     incoming section's theme, then fades.\n// ═══════════════════════════════════════════════════════════════\n\nexport class TransitionRipple {\n  constructor() {\n    this.el = document.createElement('div');\n    this.el.className = 'overlay-transition-ripple';\n    this.el.setAttribute('aria-hidden', 'true');\n    Object.assign(this.el.style, {\n      position: 'fixed',\n      left: '50%', top: '50%',\n      width: '0', height: '0',\n      borderRadius: '50%',\n      pointerEvents: 'none',\n      zIndex: '42',\n      opacity: '0',\n      transform: 'translate(-50%, -50%)',\n      willChange: 'width, height, opacity',\n    });\n    document.body.appendChild(this.el);\n    this._animating = false;\n  }\n\n  /**\n   * Fire a ripple expanding from a given Y position\n   * @param {number} hue - theme color\n   * @param {number} yPercent - vertical position (0-100%)\n   */\n  fire(hue, yPercent = 50) {\n    if (this._animating || typeof gsap === 'undefined') return;\n    this._animating = true;\n\n    const maxDim = Math.max(window.innerWidth, window.innerHeight) * 2.5;\n    this.el.style.top = `${yPercent}%`;\n    this.el.style.background = `radial-gradient(circle,\n      hsla(${hue}, 70%, 55%, 0.12) 0%,\n      hsla(${hue}, 60%, 45%, 0.06) 40%,\n      transparent 70%)`;\n\n    gsap.fromTo(this.el, {\n      width: 0, height: 0, opacity: 0.8,\n    }, {\n      width: maxDim, height: maxDim, opacity: 0,\n      duration: 1.2, ease: 'power2.out',\n      onComplete: () => { this._animating = false; },\n    });\n  }\n\n  dispose() {\n    this.el?.remove();\n  }\n}\n\n// ═══════════════════════════════════════════════════════════════\n//  8. MULTI-INSTANCE OVERLAY\n//     Creates the illusion of multiple visualizer copies stacked\n//     at different scales, opacities, and blend modes — all from\n//     ONE canvas, with CSS transforms only. No GPU duplication.\n//     The copies are ghosted echoes that lag behind the main canvas.\n// ═══════════════════════════════════════════════════════════════\n\nexport class MultiInstanceOverlay {\n  /**\n   * @param {string} sourceCanvasId - the real canvas\n   * @param {string} containerId - parent element\n   * @param {object} opts - { echoes: number, spacing, blendMode }\n   */\n  constructor(sourceCanvasId, containerId, opts = {}) {\n    this.sourceCanvas = document.getElementById(sourceCanvasId);\n    this.container = document.getElementById(containerId);\n    if (!this.sourceCanvas || !this.container) return;\n\n    this.echoCount = opts.echoes ?? 3;\n    this.spacing = opts.spacing ?? 0.06; // scale step per echo\n    this.blendMode = opts.blendMode || 'screen';\n    this.echoes = [];\n\n    for (let i = 0; i < this.echoCount; i++) {\n      const echo = document.createElement('div');\n      echo.className = 'overlay-multi-echo';\n      echo.setAttribute('aria-hidden', 'true');\n\n      const echoCanvas = document.createElement('canvas');\n      echoCanvas.style.cssText = 'width:100%;height:100%;display:block;';\n\n      const scaleFactor = 1 + (i + 1) * this.spacing;\n      const opacity = 0.08 - i * 0.02;\n\n      Object.assign(echo.style, {\n        position: 'absolute', inset: '0',\n        pointerEvents: 'none',\n        transform: `scale(${scaleFactor})`,\n        opacity: String(Math.max(0.01, opacity)),\n        mixBlendMode: this.blendMode,\n        zIndex: String(2 - i),\n        willChange: 'transform, opacity',\n        transition: 'transform 0.4s ease-out, opacity 0.4s ease-out',\n        // Subtle blur for depth-of-field effect\n        filter: `blur(${(i + 1) * 1.5}px)`,\n      });\n\n      echo.appendChild(echoCanvas);\n      this.container.appendChild(echo);\n      this.echoes.push({ el: echo, canvas: echoCanvas, ctx: echoCanvas.getContext('2d', { alpha: true }) });\n    }\n\n    this._frameCount = 0;\n    this._copyLoop();\n  }\n\n  _copyLoop() {\n    this._frameCount++;\n    // Echoes are intentionally laggy — copy every 5th frame for ghost effect\n    if (this._frameCount % 5 === 0 && this.sourceCanvas && this.sourceCanvas.width > 0) {\n      // Stagger: each echo copies at different intervals for temporal spread\n      const idx = Math.floor(this._frameCount / 5) % this.echoCount;\n      const echo = this.echoes[idx];\n      if (echo && echo.ctx) {\n        if (echo.canvas.width !== this.sourceCanvas.width) {\n          echo.canvas.width = this.sourceCanvas.width;\n          echo.canvas.height = this.sourceCanvas.height;\n        }\n        try {\n          echo.ctx.drawImage(this.sourceCanvas, 0, 0);\n        } catch (_) { /* silently skip */ }\n      }\n    }\n    this._rafId = requestAnimationFrame(() => this._copyLoop());\n  }\n\n  /**\n   * Update echo transforms based on scroll/params\n   */\n  update(scrollProgress, params = {}) {\n    if (!this.echoes.length) return;\n    const chaos = clamp01(params.chaos ?? 0);\n    const intensity = clamp01(params.intensity ?? 0.5);\n    const time = performance.now() * 0.001;\n\n    this.echoes.forEach((echo, i) => {\n      const drift = Math.sin(time * 0.5 + i * 1.2) * chaos * 3;\n      const baseScale = 1 + (i + 1) * this.spacing;\n      const chaosScale = baseScale + chaos * 0.04 * (i + 1);\n      const rotZ = Math.sin(time * 0.3 + i * 0.8) * chaos * 2;\n      const opacity = (0.08 - i * 0.02) * (0.5 + intensity * 0.5);\n\n      echo.el.style.transform = `scale(${chaosScale}) rotate(${rotZ}deg) translate(${drift}px, ${drift * 0.5}px)`;\n      echo.el.style.opacity = String(Math.max(0.01, opacity));\n    });\n  }\n\n  dispose() {\n    if (this._rafId) cancelAnimationFrame(this._rafId);\n    this.echoes.forEach(e => e.el.remove());\n    this.echoes = [];\n  }\n}\n\n// ═══════════════════════════════════════════════════════════════\n//  INIT: Setup all overlay effects for the landing page\n// ═══════════════════════════════════════════════════════════════\n\n/**\n * Initialize all overlay choreography effects.\n * @param {ContextPool} pool - GPU context pool\n * @returns {AccentChoreographer} orchestrator instance\n */\nexport function initOverlayChoreography(pool) {\n  const choreo = new AccentChoreographer();\n  const ripple = new TransitionRipple();\n\n  // ─── Hero: Gradient wash + edge glow ──────────────────────\n  const heroWash = new GradientWashLayer('heroContent', {\n    mode: 'radial', blendMode: 'screen', baseOpacity: 0.08, zIndex: '1',\n  });\n  const heroGlow = new EdgeGlowRing('heroContent', {\n    baseSize: 4, pulseScale: 3, hue: 210,\n  });\n  choreo.register('heroWash', heroWash, {\n    trigger: '.hero', start: 'top top', end: 'bottom top',\n    adapter: () => pool.get('hero'),\n  });\n  choreo.register('heroGlow', heroGlow, {\n    trigger: '.hero', start: 'top top', end: 'bottom top',\n    adapter: () => pool.get('hero'),\n  });\n\n  // ─── Morph: Conic gradient wash on the morph card ─────────\n  const morphWash = new GradientWashLayer('morphCard', {\n    mode: 'conic', blendMode: 'overlay', baseOpacity: 0.15, zIndex: '2',\n  });\n  choreo.register('morphWash', morphWash, {\n    trigger: '#morphSection', start: 'top top', end: 'bottom bottom',\n    adapter: () => pool.get('morph'),\n  });\n\n  // ─── Morph: Multi-instance echo on the morph canvas ───────\n  const morphEchoes = new MultiInstanceOverlay('morph-canvas', 'morphPinned', {\n    echoes: 2, spacing: 0.05, blendMode: 'screen',\n  });\n  choreo.register('morphEchoes', morphEchoes, {\n    trigger: '#morphSection', start: 'top top', end: 'bottom bottom',\n    adapter: () => pool.get('morph'),\n  });\n\n  // ─── Triptych: Particles in the center column ─────────────\n  const triParticles = new ParticleField('triptychCenter', {\n    count: 15, hue: 280, spread: 150, lifespan: 5000, zIndex: '8',\n  });\n  choreo.register('triParticles', triParticles, {\n    trigger: '#triptychSection', start: 'top bottom', end: 'bottom top',\n    adapter: () => pool.get('triCenter'),\n  });\n\n  // ─── Energy: Sweep gradient on background ─────────────────\n  const energyWash = new GradientWashLayer('energyBgWrap', {\n    mode: 'sweep', blendMode: 'screen', baseOpacity: 0.1, zIndex: '3',\n  });\n  choreo.register('energyWash', energyWash, {\n    trigger: '#energySection', start: 'top top', end: 'bottom bottom',\n    adapter: () => pool.get('energyBg'),\n  });\n\n  // ─── Energy card: Edge glow ring ──────────────────────────\n  const energyCardGlow = new EdgeGlowRing('energyCard', {\n    baseSize: 6, pulseScale: 4, hue: 180,\n  });\n  choreo.register('energyCardGlow', energyCardGlow, {\n    trigger: '#energySection', start: 'top top', end: 'bottom bottom',\n    adapter: () => pool.get('energyCard'),\n  });\n\n  // ─── CTA: Multi-instance echoes on left canvas ────────────\n  const ctaEchoes = new MultiInstanceOverlay('cta-canvas-left', 'ctaGpuLeft', {\n    echoes: 2, spacing: 0.04, blendMode: 'screen',\n  });\n  choreo.register('ctaEchoes', ctaEchoes, {\n    trigger: '#ctaSection', start: 'top bottom', end: 'bottom bottom',\n    adapter: () => pool.get('ctaL'),\n  });\n\n  // ─── CTA: Gradient wash on right canvas ───────────────────\n  const ctaWash = new GradientWashLayer('ctaGpuRight', {\n    mode: 'radial', blendMode: 'overlay', baseOpacity: 0.1, zIndex: '4',\n  });\n  choreo.register('ctaWash', ctaWash, {\n    trigger: '#ctaSection', start: 'top bottom', end: 'bottom bottom',\n    adapter: () => pool.get('ctaR'),\n  });\n\n  // ─── Agent: Particles floating across the section ─────────\n  const agentParticles = new ParticleField('agentSection', {\n    count: 12, hue: 240, spread: 120, lifespan: 6000, zIndex: '3',\n  });\n  choreo.register('agentParticles', agentParticles, {\n    trigger: '#agentSection', start: 'top bottom', end: 'bottom top',\n    adapter: () => pool.get('agent'),\n  });\n\n  // ─── CROSSFADE BRIDGES between sections ───────────────────\n  // Hero → Morph bridge\n  const heroMorphBridge = new CrossfadeBridge({ outHue: 210, inHue: 270 });\n  choreo.registerBridge(heroMorphBridge, {\n    trigger: '#divider-hero-morph',\n    start: 'top 90%', end: 'bottom 10%',\n    outAdapter: () => pool.get('hero'),\n    inAdapter: () => pool.get('morph'),\n  });\n\n  // Morph → Playground bridge\n  const morphPlayBridge = new CrossfadeBridge({ outHue: 280, inHue: 200 });\n  choreo.registerBridge(morphPlayBridge, {\n    trigger: '#divider-morph-playground',\n    start: 'top 90%', end: 'bottom 10%',\n    outAdapter: () => pool.get('morph'),\n    inAdapter: () => pool.get('playground'),\n  });\n\n  // Cascade → Energy bridge\n  const casEnergyBridge = new CrossfadeBridge({ outHue: 320, inHue: 270 });\n  choreo.registerBridge(casEnergyBridge, {\n    trigger: '#divider-cascade-energy',\n    start: 'top 90%', end: 'bottom 10%',\n    outAdapter: () => pool.get('casGpuL'),\n    inAdapter: () => pool.get('energyBg'),\n  });\n\n  // ─── TRANSITION RIPPLES at section boundaries ─────────────\n  if (typeof ScrollTrigger !== 'undefined') {\n    const ripplePoints = [\n      { trigger: '#divider-hero-morph', hue: 220 },\n      { trigger: '#divider-morph-playground', hue: 280 },\n      { trigger: '#divider-playground-triptych', hue: 190 },\n      { trigger: '#divider-cascade-energy', hue: 310 },\n    ];\n\n    ripplePoints.forEach(({ trigger, hue }) => {\n      const el = document.querySelector(trigger);\n      if (!el) return;\n      ScrollTrigger.create({\n        trigger: el, start: 'top 60%', once: false,\n        onEnter: () => {\n          const rect = el.getBoundingClientRect();\n          const yPct = ((rect.top + rect.height / 2) / window.innerHeight) * 100;\n          ripple.fire(hue, yPct);\n        },\n      });\n    });\n  }\n\n  // ─── Initialize all scroll triggers ───────────────────────\n  choreo.initScrollTriggers();\n\n  // ─── Quaternion-to-CSS bridge ─────────────────────────────\n  // Feeds the active visualizer's 4D rotation state to CSS custom\n  // properties so CSS-only effects can react to the 4D rotation.\n  // Throttled to ~20fps to avoid layout thrashing.\n  const root = document.documentElement;\n  const adapterKeys = ['hero', 'morph', 'triCenter', 'energyCard', 'agent', 'ctaL', 'playground'];\n  let lastQFrame = 0;\n\n  function quaternionCSSBridge() {\n    const now = performance.now();\n    if (now - lastQFrame < 50) { requestAnimationFrame(quaternionCSSBridge); return; }\n    lastQFrame = now;\n\n    // Find the first visible adapter with params\n    for (const key of adapterKeys) {\n      const adapter = pool.get(key);\n      if (!adapter?.params) continue;\n      const p = adapter.params;\n      root.style.setProperty('--q-xw', (p.rot4dXW ?? 0).toFixed(3));\n      root.style.setProperty('--q-yw', (p.rot4dYW ?? 0).toFixed(3));\n      root.style.setProperty('--q-zw', (p.rot4dZW ?? 0).toFixed(3));\n      root.style.setProperty('--q-intensity', clamp01(p.intensity ?? 0.5).toFixed(3));\n      root.style.setProperty('--overlay-hue', Math.round(p.hue ?? 200));\n      root.style.setProperty('--overlay-intensity', clamp01(p.intensity ?? 0.5).toFixed(3));\n      break;\n    }\n    requestAnimationFrame(quaternionCSSBridge);\n  }\n  requestAnimationFrame(quaternionCSSBridge);\n\n  return choreo;\n}\n","/**\n * Reveal Choreography System — Multi-Layer Parallax Overlay\n *\n * Creates solid/glass overlay layers OVER the visualizer canvases.\n * These layers move, split, iris, and dissolve to reveal the visualizers\n * through negative space, replacing the old rectangular section transitions.\n *\n * Architecture:\n *   1. Persistent parallax field (subtle depth texture, 0.3x scroll speed)\n *   2. Section transition layers (unique per boundary):\n *      - Opening→Hero: Iris aperture expanding from center\n *      - Hero→Morph: Diagonal bars from corners criss-crossing\n *      - Morph→Playground: Column split sliding aside\n *      - Playground→Triptych: Glass panels retracting\n *      - Triptych→Cascade: Bezel bars from all 4 edges forming checkerboard\n *      - Cascade→Energy: Concentric iris opening\n *      - Energy→Agent: Diagonal wipe\n *      - Agent→CTA: Checkerboard stagger dissolve\n *   3. Persistent glassmorphic accent strips (3 floating panels)\n *\n * Dependencies: GSAP 3.12+, ScrollTrigger\n */\n\nexport function initRevealChoreography() {\n    if (typeof gsap === 'undefined' || typeof ScrollTrigger === 'undefined') {\n        console.warn('[reveal] GSAP/ScrollTrigger not available, skipping reveal layers');\n        return;\n    }\n\n    gsap.registerPlugin(ScrollTrigger);\n\n    // ── Create DOM layers ──\n    createParallaxField();\n    createSectionTransitions();\n    createFloatingAccents();\n    createGlowLines();\n}\n\n/* ═══════════════════════════════════════════\n   PARALLAX DEPTH FIELD\n   Subtle geometric overlay moving at 0.3x scroll\n   ═══════════════════════════════════════════ */\nfunction createParallaxField() {\n    const field = document.createElement('div');\n    field.className = 'reveal-layer parallax-field';\n    field.id = 'parallaxField';\n    field.setAttribute('aria-hidden', 'true');\n    document.body.appendChild(field);\n\n    // Parallax: field moves at 30% of scroll speed\n    gsap.to(field, {\n        yPercent: -15,\n        ease: 'none',\n        scrollTrigger: {\n            trigger: document.body,\n            start: 'top top',\n            end: 'bottom bottom',\n            scrub: 0.5,\n        }\n    });\n}\n\n/* ═══════════════════════════════════════════\n   SECTION TRANSITION LAYERS\n   Each section boundary gets a unique reveal pattern\n   ═══════════════════════════════════════════ */\nfunction createSectionTransitions() {\n    // 1. Opening → Hero: Iris aperture\n    createIrisTransition(\n        '#openingSection',\n        '#main',\n        { x: 50, y: 50, startRadius: 0, endRadius: 85 }\n    );\n\n    // 2. Hero → Morph: Diagonal bars from corners\n    createDiagonalBarTransition(\n        '#main',\n        '#morphSection',\n        { count: 10, angle: -20, staggerFrom: 'edges' }\n    );\n\n    // 3. Morph → Playground: Column split\n    createColumnSplitTransition(\n        '#morphSection',\n        '#playgroundSection',\n        { cols: 6, glass: true }\n    );\n\n    // 4. Playground → Triptych: Glass panel retraction\n    createGlassPanelTransition(\n        '#playgroundSection',\n        '#triptychSection'\n    );\n\n    // 5. Triptych → Cascade: Bezel bars criss-cross into checkerboard\n    createBezelBarTransition(\n        '#triptychSection',\n        '#cascadeSection',\n        { barsPerEdge: 5 }\n    );\n\n    // 6. Cascade → Energy: Iris\n    createIrisTransition(\n        '#cascadeSection',\n        '#energySection',\n        { x: 50, y: 40, startRadius: 0, endRadius: 90 }\n    );\n\n    // 7. Energy → Agent: Diagonal wipe\n    createDiagonalBarTransition(\n        '#energySection',\n        '#agentSection',\n        { count: 6, angle: 25, staggerFrom: 'start' }\n    );\n\n    // 8. Agent → CTA: Checkerboard dissolve\n    createCheckerboardTransition(\n        '#agentSection',\n        '#ctaSection',\n        { cols: 10, rows: 6 }\n    );\n}\n\n\n/* ── IRIS APERTURE ── */\nfunction createIrisTransition(triggerSel, nextSel, opts) {\n    const trigger = document.querySelector(triggerSel);\n    const next = document.querySelector(nextSel);\n    if (!trigger || !next) return;\n\n    // Create the iris overlay (solid bg with circular hole)\n    const iris = document.createElement('div');\n    iris.className = 'reveal-layer--absolute reveal-iris--invert';\n    iris.setAttribute('aria-hidden', 'true');\n    iris.style.cssText = `\n        position: absolute; inset: -2px; z-index: 20; pointer-events: none;\n        --iris-radius: ${opts.startRadius}px;\n        --iris-x: ${opts.x}%;\n        --iris-y: ${opts.y}%;\n    `;\n    next.style.position = 'relative';\n    next.appendChild(iris);\n\n    // Concentric ring accents\n    for (let i = 0; i < 3; i++) {\n        const ring = document.createElement('div');\n        ring.className = 'iris-ring';\n        ring.style.cssText = `--ring-scale: ${0.3 + i * 0.2}; --ring-opacity: 0;`;\n        iris.appendChild(ring);\n    }\n\n    const maxR = Math.max(window.innerWidth, window.innerHeight) * (opts.endRadius / 100);\n\n    gsap.to(iris, {\n        '--iris-radius': `${maxR}px`,\n        ease: 'power2.inOut',\n        scrollTrigger: {\n            trigger: next,\n            start: 'top 90%',\n            end: 'top 20%',\n            scrub: 0.5,\n        },\n        onComplete: () => { iris.style.display = 'none'; }\n    });\n\n    // Animate rings\n    const rings = iris.querySelectorAll('.iris-ring');\n    rings.forEach((ring, i) => {\n        gsap.to(ring, {\n            '--ring-scale': 1 + i * 0.3,\n            '--ring-opacity': 0.4 - i * 0.1,\n            ease: 'power1.out',\n            scrollTrigger: {\n                trigger: next,\n                start: `top ${95 - i * 5}%`,\n                end: `top ${40 - i * 5}%`,\n                scrub: 0.5,\n            }\n        });\n    });\n}\n\n\n/* ── DIAGONAL BARS ── */\nfunction createDiagonalBarTransition(triggerSel, nextSel, opts) {\n    const next = document.querySelector(nextSel);\n    if (!next) return;\n\n    const container = document.createElement('div');\n    container.className = 'section-reveal-layer';\n    container.setAttribute('aria-hidden', 'true');\n    next.appendChild(container);\n\n    const bars = [];\n    for (let i = 0; i < opts.count; i++) {\n        const bar = document.createElement('div');\n        bar.className = 'reveal-bar reveal-bar--diag';\n        const yPos = (i / opts.count) * 100;\n        bar.style.cssText = `\n            top: ${yPos}%;\n            --bar-angle: ${opts.angle}deg;\n            --bar-count: ${opts.count};\n            background: var(--bg);\n        `;\n        container.appendChild(bar);\n        bars.push(bar);\n    }\n\n    // Stagger bars sliding out\n    const stagger = opts.staggerFrom === 'edges'\n        ? { from: 'edges', each: 0.03 }\n        : { from: 'start', each: 0.04 };\n\n    gsap.fromTo(bars, {\n        '--bar-tx': '0%',\n        opacity: 1\n    }, {\n        '--bar-tx': (i) => i % 2 === 0 ? '120%' : '-120%',\n        opacity: 0,\n        stagger,\n        ease: 'power2.inOut',\n        scrollTrigger: {\n            trigger: next,\n            start: 'top 85%',\n            end: 'top 15%',\n            scrub: 0.5,\n        }\n    });\n}\n\n\n/* ── COLUMN SPLIT ── */\nfunction createColumnSplitTransition(triggerSel, nextSel, opts) {\n    const next = document.querySelector(nextSel);\n    if (!next) return;\n\n    const container = document.createElement('div');\n    container.className = 'section-reveal-layer reveal-columns';\n    container.setAttribute('aria-hidden', 'true');\n    container.style.display = 'flex';\n    next.appendChild(container);\n\n    const cols = [];\n    for (let i = 0; i < opts.cols; i++) {\n        const col = document.createElement('div');\n        col.className = `reveal-col ${opts.glass ? 'reveal-col--glass' : ''}`;\n        container.appendChild(col);\n        cols.push(col);\n    }\n\n    // Columns slide out alternating left/right\n    gsap.fromTo(cols, {\n        xPercent: 0\n    }, {\n        xPercent: (i) => i % 2 === 0 ? -120 : 120,\n        stagger: { from: 'center', each: 0.02 },\n        ease: 'power3.inOut',\n        scrollTrigger: {\n            trigger: next,\n            start: 'top 80%',\n            end: 'top 10%',\n            scrub: 0.5,\n        }\n    });\n}\n\n\n/* ── GLASS PANEL RETRACTION ── */\nfunction createGlassPanelTransition(triggerSel, nextSel) {\n    const next = document.querySelector(nextSel);\n    if (!next) return;\n\n    const positions = ['top', 'bottom', 'left', 'right'];\n    const panels = [];\n\n    positions.forEach(pos => {\n        const panel = document.createElement('div');\n        panel.className = `reveal-glass-panel reveal-glass-panel--${pos}`;\n        panel.setAttribute('aria-hidden', 'true');\n        next.style.position = 'relative';\n        next.appendChild(panel);\n        panels.push({ el: panel, pos });\n    });\n\n    // Each panel slides off in its direction\n    panels.forEach(({ el, pos }) => {\n        const prop = (pos === 'top' || pos === 'bottom') ? 'yPercent' : 'xPercent';\n        const val = (pos === 'top' || pos === 'left') ? -110 : 110;\n\n        gsap.fromTo(el, {\n            [prop]: 0,\n            opacity: 1\n        }, {\n            [prop]: val,\n            opacity: 0,\n            ease: 'power2.inOut',\n            scrollTrigger: {\n                trigger: next,\n                start: 'top 85%',\n                end: 'top 15%',\n                scrub: 0.5,\n            }\n        });\n    });\n}\n\n\n/* ── BEZEL BARS (from all 4 edges → checkerboard) ── */\nfunction createBezelBarTransition(triggerSel, nextSel, opts) {\n    const next = document.querySelector(nextSel);\n    if (!next) return;\n\n    const container = document.createElement('div');\n    container.className = 'section-reveal-layer';\n    container.setAttribute('aria-hidden', 'true');\n    next.appendChild(container);\n\n    const bars = [];\n    const dirs = ['from-top', 'from-bottom', 'from-left', 'from-right'];\n\n    dirs.forEach((dir, di) => {\n        for (let i = 0; i < opts.barsPerEdge; i++) {\n            const bar = document.createElement('div');\n            bar.className = `bezel-bar bezel-bar--${dir}`;\n\n            const isVert = dir === 'from-top' || dir === 'from-bottom';\n            const pos = (i / opts.barsPerEdge) * 100 + (100 / opts.barsPerEdge / 2);\n\n            if (isVert) {\n                bar.style.left = `${pos}%`;\n                bar.style.width = `${100 / opts.barsPerEdge}%`;\n            } else {\n                bar.style.top = `${pos}%`;\n                bar.style.height = `${100 / opts.barsPerEdge}%`;\n            }\n\n            container.appendChild(bar);\n            bars.push({ el: bar, dir, idx: i, group: di });\n        }\n    });\n\n    // Phase 1: Bars enter from edges (form checkerboard)\n    const tl = gsap.timeline({\n        scrollTrigger: {\n            trigger: next,\n            start: 'top 90%',\n            end: 'top 5%',\n            scrub: 0.5,\n        }\n    });\n\n    // First half: bars slide in to form pattern\n    bars.forEach(({ el, dir, idx }) => {\n        const isVert = dir === 'from-top' || dir === 'from-bottom';\n        const prop = isVert ? 'yPercent' : 'xPercent';\n        const enterVal = dir.includes('top') || dir.includes('left') ? -100 : 100;\n\n        tl.fromTo(el,\n            { [prop]: enterVal },\n            { [prop]: 0, duration: 0.4, ease: 'power2.out' },\n            idx * 0.03\n        );\n    });\n\n    // Second half: bars slide out the other side\n    bars.forEach(({ el, dir, idx }) => {\n        const isVert = dir === 'from-top' || dir === 'from-bottom';\n        const prop = isVert ? 'yPercent' : 'xPercent';\n        const exitVal = dir.includes('top') || dir.includes('left') ? 100 : -100;\n\n        tl.to(el,\n            { [prop]: exitVal, duration: 0.4, ease: 'power2.in' },\n            0.5 + idx * 0.03\n        );\n    });\n}\n\n\n/* ── CHECKERBOARD DISSOLVE ── */\nfunction createCheckerboardTransition(triggerSel, nextSel, opts) {\n    const next = document.querySelector(nextSel);\n    if (!next) return;\n\n    const checker = document.createElement('div');\n    checker.className = 'section-reveal-layer reveal-checker';\n    checker.setAttribute('aria-hidden', 'true');\n    checker.style.cssText = `--checker-cols: ${opts.cols}; --checker-rows: ${opts.rows};`;\n    next.appendChild(checker);\n\n    const tiles = [];\n    for (let r = 0; r < opts.rows; r++) {\n        for (let c = 0; c < opts.cols; c++) {\n            const tile = document.createElement('div');\n            tile.className = 'checker-tile';\n            checker.appendChild(tile);\n            tiles.push(tile);\n        }\n    }\n\n    // Stagger dissolve from center outward\n    gsap.fromTo(tiles, {\n        scale: 1,\n        opacity: 1\n    }, {\n        scale: 0.5,\n        opacity: 0,\n        stagger: {\n            grid: [opts.rows, opts.cols],\n            from: 'center',\n            amount: 0.8\n        },\n        ease: 'power2.inOut',\n        scrollTrigger: {\n            trigger: next,\n            start: 'top 85%',\n            end: 'top 15%',\n            scrub: 0.5,\n        }\n    });\n}\n\n\n/* ═══════════════════════════════════════════\n   FLOATING GLASSMORPHIC ACCENT STRIPS\n   3 persistent panels at different parallax rates\n   ═══════════════════════════════════════════ */\nfunction createFloatingAccents() {\n    const accents = [\n        { width: '35vw', height: '2px', top: '25%', left: '10%', angle: -8, speed: 0.4, color: 'quantum' },\n        { width: '25vw', height: '2px', top: '55%', right: '5%', angle: 12, speed: 0.6, color: 'faceted' },\n        { width: '40vw', height: '2px', top: '75%', left: '30%', angle: -4, speed: 0.3, color: 'holographic' },\n    ];\n\n    const colorMap = {\n        quantum: 'rgba(0,240,255,0.15)',\n        faceted: 'rgba(168,85,247,0.12)',\n        holographic: 'rgba(244,63,94,0.1)',\n    };\n\n    accents.forEach((a, i) => {\n        const strip = document.createElement('div');\n        strip.className = 'reveal-layer';\n        strip.setAttribute('aria-hidden', 'true');\n        strip.style.cssText = `\n            position: fixed;\n            width: ${a.width};\n            height: ${a.height};\n            top: ${a.top};\n            ${a.left ? `left: ${a.left};` : ''}\n            ${a.right ? `right: ${a.right};` : ''}\n            background: linear-gradient(90deg, transparent, ${colorMap[a.color]}, transparent);\n            transform: rotate(${a.angle}deg);\n            z-index: 9;\n            pointer-events: none;\n            mix-blend-mode: screen;\n            opacity: 0.7;\n        `;\n        document.body.appendChild(strip);\n\n        // Parallax at different rates\n        gsap.to(strip, {\n            yPercent: -50 * a.speed,\n            ease: 'none',\n            scrollTrigger: {\n                trigger: document.body,\n                start: 'top top',\n                end: 'bottom bottom',\n                scrub: 0.3,\n            }\n        });\n    });\n}\n\n\n/* ═══════════════════════════════════════════\n   GLOW LINES\n   Replace ugly SVG dividers with luminous accent lines\n   at section boundaries\n   ═══════════════════════════════════════════ */\nfunction createGlowLines() {\n    const boundaries = [\n        { section: '#main', position: 'bottom', color: 'rgba(0,240,255,0.3)', angle: null },\n        { section: '#morphSection', position: 'top', color: 'rgba(0,240,255,0.2)', angle: -3 },\n        { section: '#morphSection', position: 'bottom', color: 'rgba(168,85,247,0.3)', angle: null },\n        { section: '#playgroundSection', position: 'bottom', color: 'rgba(168,85,247,0.2)', angle: 2 },\n        { section: '#triptychSection', position: 'bottom', color: 'rgba(244,63,94,0.3)', angle: null },\n        { section: '#cascadeSection', position: 'bottom', color: 'rgba(0,240,255,0.25)', angle: -1 },\n        { section: '#energySection', position: 'bottom', color: 'rgba(168,85,247,0.25)', angle: null },\n        { section: '#agentSection', position: 'bottom', color: 'rgba(244,63,94,0.2)', angle: 3 },\n    ];\n\n    boundaries.forEach(b => {\n        const section = document.querySelector(b.section);\n        if (!section) return;\n\n        const line = document.createElement('div');\n        if (b.angle) {\n            line.className = 'glow-line glow-line--diag';\n            line.style.cssText = `\n                --glow-color: ${b.color};\n                --diag-angle: ${b.angle}deg;\n                ${b.position}: 0;\n            `;\n        } else {\n            line.className = 'glow-line glow-line--h';\n            line.style.cssText = `\n                --glow-color: ${b.color};\n                ${b.position}: 0;\n            `;\n        }\n        line.setAttribute('aria-hidden', 'true');\n        section.style.position = 'relative';\n        section.appendChild(line);\n\n        // Subtle pulse as section enters view\n        gsap.fromTo(line, {\n            opacity: 0,\n            scaleX: 0.3\n        }, {\n            opacity: 1,\n            scaleX: 1,\n            ease: 'power2.out',\n            scrollTrigger: {\n                trigger: section,\n                start: b.position === 'top' ? 'top 80%' : 'bottom 80%',\n                end: b.position === 'top' ? 'top 30%' : 'bottom 30%',\n                scrub: 0.3,\n            }\n        });\n    });\n}\n","/**\n * VIB3+ Landing Page — Boot Script v3\n *\n * Section order:\n *   Opening (800vh) → Hero → Morph (1200vh) → Playground → Triptych →\n *   Cascade → Energy → Agent → CTA\n *\n * Systems:\n *   1. ContextPool manages GPU context budget (max 3 concurrent)\n *   2. Adapters wrap each visualization system with a uniform interface\n *   3. Choreography drives shader parameters from scroll position\n *   4. CardTiltSystem maps mouse/touch → CSS 3D transforms + visualizer params\n *   5. Opening cinematic: VIB3CODE text mask over GPU canvas, lattice parallax\n *   6. Morph section: 6 stages with system swaps, parameter coordination\n *   7. Section dividers: SVG shapes hide canvas edge lines\n *   8. Blur cascade reveals + scroll-driven color theming (VISUAL-CODEX patterns)\n *\n * GPU Context Budget (see DOCS/SCROLL_TIMELINE_v3.md):\n *   Opening ......... 1 (Quantum)\n *   Hero ............ 1 (Quantum)\n *   Morph ........... 1 (Q → H → F rotating)\n *   Playground ...... 1 (Q/H/F, user-controlled)\n *   Triptych ........ 3 (Q + H + F split-screen)\n *   Cascade ......... 2 (Q + H dual GPU background) + Canvas2D cards\n *   Energy .......... 2 (Q background + F card)\n *   Agent ........... 1 (Holographic)\n *   CTA ............. 2 (Q + F dueling finale)\n *   MAX CONCURRENT .. 3 (pool auto-evicts oldest on overflow)\n */\n\nimport { ContextPool } from './ContextPool.js';\nimport { QuantumAdapter, HolographicAdapter, FacetedAdapter, AmbientLattice } from './adapters.js';\nimport { CardTiltSystem } from './CardTiltSystem.js';\nimport {\n  heroParams, playgroundDefaults,\n  parallaxParams, openingParams,\n} from './config.js';\nimport {\n  initScrollProgress, initOpening, initHero, initMorph,\n  initTriptych, initCascade, initEnergy, initCTA,\n  initAgent,\n  initSectionReveals, initScrollColorTheme, initBlurReveals,\n  initSectionVeils, initScrollVelocityBurst, initPhaseShiftBridges,\n  initSpeedCrescendo,\n} from './choreography.js';\nimport { initOverlayChoreography } from './overlay-choreography.js';\nimport { initRevealChoreography } from './reveal-choreography.js';\n\n// ─── State ────────────────────────────────────────────────────\n\nconst pool = new ContextPool(3);\nconst c2d = new Map();\nlet tiltSystem = null;\n\n// ─── Playground GPU State ─────────────────────────────────────\n\nconst pgFactories = [QuantumAdapter, HolographicAdapter, FacetedAdapter];\nconst pgNames = ['Quantum', 'Holographic', 'Faceted'];\nlet pgSystemIdx = 0;\n\nfunction getPlayground() {\n  return pool.get('playground');\n}\n\nfunction acquirePlayground() {\n  const adapter = pool.acquire(\n    'playground', 'playground-canvas',\n    pgFactories[pgSystemIdx], playgroundDefaults\n  );\n  const errEl = document.getElementById('pgError');\n  if (!adapter) {\n    console.error(`[Playground] Failed to acquire ${pgNames[pgSystemIdx]} GPU context`);\n    if (errEl) errEl.style.display = 'flex';\n  } else {\n    if (errEl) errEl.style.display = 'none';\n    // Always sync slider values — covers scroll-triggered re-acquire\n    adapter.setParams(readSliderValues());\n  }\n  return adapter;\n}\n\nfunction releasePlayground() {\n  pool.release('playground');\n}\n\nfunction switchPlaygroundSystem(idx) {\n  if (idx === pgSystemIdx && pool.has('playground')) return;\n  pgSystemIdx = idx;\n  releasePlayground();\n  const adapter = acquirePlayground();\n  if (adapter) {\n    adapter.setParams(readSliderValues());\n  }\n}\n\nfunction readSliderValues() {\n  const params = {};\n  const sliderParams = [\n    'hue', 'gridDensity', 'speed', 'chaos',\n    'morphFactor', 'intensity', 'dimension', 'saturation',\n    'rot4dXW', 'rot4dYW', 'rot4dZW',\n    'rot4dXY', 'rot4dXZ', 'rot4dYZ',\n  ];\n  sliderParams.forEach(param => {\n    const input = document.getElementById(`ctrl-${param}`);\n    if (input) params[param] = parseFloat(input.value);\n  });\n  const geoSelect = document.getElementById('ctrl-geometry');\n  if (geoSelect) params.geometry = parseInt(geoSelect.value);\n  return params;\n}\n\n// ─── GPU System: Hero ─────────────────────────────────────────\n\nfunction createHero() {\n  return pool.acquire('hero', 'hero-canvas', QuantumAdapter, heroParams);\n}\n\n// ─── Ambient Lattice Instances (Canvas 2D accent — no GPU) ──────\n// Lightweight atmospheric backgrounds — NOT system impersonation.\n// Triptych columns now use real GPU adapters (Quantum + Faceted).\n\nfunction initAmbientCanvases() {\n  // Cascade cards — bright vivid accent behind card content\n  document.querySelectorAll('.cascade-card').forEach((card, i) => {\n    c2d.set(`cas${i}`, new AmbientLattice(`cas-${i}`, {\n      geometry: parseInt(card.dataset.geo),\n      hue: parseInt(card.dataset.hue),\n      gridDensity: 24, speed: 0.8, intensity: 0.9, chaos: 0.22,\n      morphFactor: 0.9, dimension: 3.3, saturation: 0.95,\n    }));\n  });\n\n  // Section backgrounds — NOW GPU-driven (see SCROLL_TIMELINE_v3.md)\n  // Energy bg, Agent, CTA are all handled by GPU adapters in choreography.\n  // No Canvas2D for these sections.\n}\n\n// ─── Card Tilt System ──────────────────────────────────────────\n// Registers cascade cards and energy card for mouse-driven 3D tilt\n// with visualizer parameter mapping (rotation, speed, chaos, density)\n\nfunction initTiltSystem() {\n  tiltSystem = new CardTiltSystem({\n    maxTilt: 18,\n    perspective: 1200,\n    smoothing: 0.1,\n    returnSpeed: 0.06,\n  });\n\n  // Register cascade cards with their AmbientLattice adapters\n  document.querySelectorAll('.cascade-card').forEach((card, i) => {\n    const adapter = c2d.get(`cas${i}`);\n    tiltSystem.register(card, adapter, {\n      maxTilt: 15,\n      sensitivity: 1.2,\n      affectsRotation: true,\n      affectsSpeed: true,\n      affectsChaos: true,\n      affectsDensity: true,\n      affectsHue: false,\n      rotationScale: 1.0,\n      speedScale: 0.3,\n      chaosScale: 0.2,\n      densityScale: 0.2,\n    });\n  });\n\n  // Register energy card (adapter set when GPU context is acquired)\n  const energyCard = document.getElementById('energyCard');\n  if (energyCard) {\n    tiltSystem.register(energyCard, null, {\n      maxTilt: 12,\n      sensitivity: 0.8,\n      affectsRotation: true,\n      affectsSpeed: false,\n      affectsChaos: true,\n      affectsDensity: false,\n      rotationScale: 0.8,\n      chaosScale: 0.15,\n    });\n  }\n\n  // Register agent cards (CSS-only tilt, no adapter)\n  document.querySelectorAll('.agent-card').forEach(card => {\n    tiltSystem.register(card, null, {\n      maxTilt: 8,\n      sensitivity: 0.6,\n    });\n  });\n}\n\n// ─── Parameters Playground (GPU-backed, full 6D) ─────────────\n\n// Wire slider/button controls only (no GPU context needed)\nfunction initPlaygroundControls() {\n  const sliderParams = [\n    'hue', 'gridDensity', 'speed', 'chaos',\n    'morphFactor', 'intensity', 'dimension', 'saturation',\n    'rot4dXW', 'rot4dYW', 'rot4dZW',\n    'rot4dXY', 'rot4dXZ', 'rot4dYZ',\n  ];\n\n  // Wire range sliders → live GPU adapter\n  sliderParams.forEach(param => {\n    const input = document.getElementById(`ctrl-${param}`);\n    const valEl = document.getElementById(`val-${param}`);\n    if (!input || !valEl) return;\n\n    input.addEventListener('input', () => {\n      const v = parseFloat(input.value);\n      valEl.textContent = Number.isInteger(v) ? v : v.toFixed(2);\n      const pg = getPlayground();\n      if (pg) pg.setParam(param, v);\n    });\n  });\n\n  // Wire geometry select\n  const geoSelect = document.getElementById('ctrl-geometry');\n  const geoVal = document.getElementById('val-geometry');\n  if (geoSelect && geoVal) {\n    geoSelect.addEventListener('change', () => {\n      const v = parseInt(geoSelect.value);\n      geoVal.textContent = v;\n      const pg = getPlayground();\n      if (pg) pg.setParam('geometry', v);\n    });\n  }\n\n  // Wire system type buttons (Quantum / Holographic / Faceted)\n  document.querySelectorAll('[data-pg-system]').forEach(btn => {\n    btn.addEventListener('click', () => {\n      const idx = parseInt(btn.dataset.pgSystem);\n      switchPlaygroundSystem(idx);\n      document.querySelectorAll('[data-pg-system]').forEach(b =>\n        b.classList.toggle('active', parseInt(b.dataset.pgSystem) === idx)\n      );\n    });\n  });\n\n  // ── Randomize + Reset ──\n  const sliderRanges = {\n    hue: [0, 360], gridDensity: [4, 80], speed: [0.1, 3], chaos: [0, 1],\n    morphFactor: [0, 2], intensity: [0.2, 1], dimension: [3.0, 4.5],\n    saturation: [0, 1],\n    rot4dXW: [0, 6.28], rot4dYW: [0, 6.28], rot4dZW: [0, 6.28],\n    rot4dXY: [0, 6.28], rot4dXZ: [0, 6.28], rot4dYZ: [0, 6.28],\n  };\n  const defaultSliders = {\n    hue: 200, gridDensity: 24, speed: 1.0, chaos: 0.2,\n    morphFactor: 0.5, intensity: 0.7, dimension: 3.5, saturation: 0.8,\n    rot4dXW: 0, rot4dYW: 0, rot4dZW: 0, rot4dXY: 0, rot4dXZ: 0, rot4dYZ: 0,\n  };\n\n  function setAllSliders(values) {\n    for (const [param, v] of Object.entries(values)) {\n      const input = document.getElementById(`ctrl-${param}`);\n      const valEl = document.getElementById(`val-${param}`);\n      if (input) { input.value = v; }\n      if (valEl) { valEl.textContent = Number.isInteger(v) ? v : v.toFixed(2); }\n    }\n    const pg = getPlayground();\n    if (pg) pg.setParams(values);\n  }\n\n  document.getElementById('btnRandomize')?.addEventListener('click', () => {\n    const randomized = {};\n    for (const [param, [lo, hi]] of Object.entries(sliderRanges)) {\n      randomized[param] = lo + Math.random() * (hi - lo);\n      if (param === 'hue' || param === 'gridDensity') randomized[param] = Math.round(randomized[param]);\n    }\n    // Random geometry too\n    const geo = Math.floor(Math.random() * 24);\n    randomized.geometry = geo;\n    const geoSelect = document.getElementById('ctrl-geometry');\n    const geoVal = document.getElementById('val-geometry');\n    if (geoSelect) geoSelect.value = geo;\n    if (geoVal) geoVal.textContent = geo;\n    setAllSliders(randomized);\n  });\n\n  document.getElementById('btnReset')?.addEventListener('click', () => {\n    setAllSliders(defaultSliders);\n    const geoSelect = document.getElementById('ctrl-geometry');\n    const geoVal = document.getElementById('val-geometry');\n    if (geoSelect) geoSelect.value = 3;\n    if (geoVal) geoVal.textContent = '3';\n    const pg = getPlayground();\n    if (pg) pg.setParam('geometry', 3);\n  });\n}\n\n// Install ScrollTrigger lifecycle for playground (called after GSAP loads)\nfunction initPlaygroundScrollTrigger() {\n  ScrollTrigger.create({\n    trigger: '#playgroundSection',\n    start: 'top 80%',\n    end: 'bottom top',\n    onEnter: acquirePlayground,\n    onLeave: releasePlayground,\n    onEnterBack: acquirePlayground,\n    onLeaveBack: releasePlayground,\n  });\n}\n\n// ─── Global Mouse/Touch Reactivity ─────────────────────────────\n// Tracks mouse position globally and feeds it to ALL visible renderers.\n// AmbientLattice gets mouseX/mouseY params; GPU adapters get rotation nudges.\n\nconst mouseState = { x: 0.5, y: 0.5, targetX: 0.5, targetY: 0.5, active: false };\n\nfunction initGlobalMouseReactivity() {\n  const root = document.documentElement;\n\n  const updateMouse = (clientX, clientY) => {\n    mouseState.targetX = clientX / window.innerWidth;\n    mouseState.targetY = clientY / window.innerHeight;\n    mouseState.active = true;\n    root.style.setProperty('--mouse-x', `${mouseState.targetX * 100}%`);\n    root.style.setProperty('--mouse-y', `${mouseState.targetY * 100}%`);\n    root.style.setProperty('--mouse-active', '1');\n  };\n\n  document.addEventListener('mousemove', (e) => updateMouse(e.clientX, e.clientY));\n  document.addEventListener('touchmove', (e) => {\n    if (e.touches.length) updateMouse(e.touches[0].clientX, e.touches[0].clientY);\n  }, { passive: true });\n\n  document.addEventListener('mouseleave', () => {\n    mouseState.active = false;\n    root.style.setProperty('--mouse-active', '0');\n  });\n}\n\nfunction feedMouseToRenderers() {\n  // Smooth interpolation\n  mouseState.x += (mouseState.targetX - mouseState.x) * 0.08;\n  mouseState.y += (mouseState.targetY - mouseState.y) * 0.08;\n  const mx = mouseState.x, my = mouseState.y;\n  const dx = mx - 0.5, dy = my - 0.5;\n\n  // Feed to all AmbientLattice instances\n  for (const inst of c2d.values()) {\n    inst.setParam('mouseX', mx);\n    inst.setParam('mouseY', my);\n  }\n\n  // Feed to visible GPU adapters — mouse interaction (non-additive)\n  if (mouseState.active) {\n    const gpuKeys = [\n      'hero', 'opening', 'playground', 'energyCard', 'energyBg',\n      'triLeft', 'triCenter', 'triRight',\n      'casGpuL', 'casGpuR',\n      'ctaL', 'ctaR', 'agent',\n    ];\n    for (const key of gpuKeys) {\n      const adapter = pool.get(key);\n      if (!adapter || !adapter.engine) continue;\n      // Feed mouse position directly to the engine's interaction handler\n      try { adapter.engine?.updateInteraction?.(mx, my, 0.6); } catch (_) { /* noop */ }\n    }\n  }\n}\n\n// ─── Render Loop (AmbientLattice + mouse reactivity) ──\n\nfunction renderLoop(ts) {\n  feedMouseToRenderers();\n  for (const inst of c2d.values()) inst.render(ts);\n  requestAnimationFrame(renderLoop);\n}\n\n// ─── Boot ─────────────────────────────────────────────────────\n\n// Start non-GSAP systems immediately (no CDN dependency)\ninitAmbientCanvases();\npool.acquire('opening', 'opening-canvas', QuantumAdapter, openingParams);\ninitPlaygroundControls();  // Wire sliders only — GPU context deferred\ninitTiltSystem();\ninitGlobalMouseReactivity();\nrequestAnimationFrame(renderLoop);\n\n// Lazy playground GPU acquisition (pre-GSAP fallback via IntersectionObserver).\n// When GSAP loads, this observer is replaced by a ScrollTrigger lifecycle.\nlet _pgObserver = null;\nconst pgSection = document.getElementById('playgroundSection');\nif (pgSection) {\n  _pgObserver = new IntersectionObserver(([entry]) => {\n    if (entry.isIntersecting && !pool.has('playground')) acquirePlayground();\n  }, { threshold: 0.1 });\n  _pgObserver.observe(pgSection);\n}\n\n// Clean up on page hide (mobile tab switching) — re-acquire on return\ndocument.addEventListener('visibilitychange', () => {\n  if (document.hidden) {\n    pool.releaseAll();\n  } else {\n    const openingSection = document.getElementById('openingSection');\n    if (openingSection) {\n      const rect = openingSection.getBoundingClientRect();\n      if (rect.top < window.innerHeight && rect.bottom > 0) {\n        pool.acquire('opening', 'opening-canvas', QuantumAdapter, openingParams);\n      } else if (window.scrollY < window.innerHeight * 2) {\n        createHero();\n      }\n    }\n    const pgSection = document.getElementById('playgroundSection');\n    if (pgSection) {\n      const rect = pgSection.getBoundingClientRect();\n      if (rect.top < window.innerHeight && rect.bottom > 0) {\n        acquirePlayground();\n      }\n    }\n    if (typeof ScrollTrigger !== 'undefined') {\n      ScrollTrigger.refresh();\n    }\n  }\n});\n\n// ─── GSAP Choreography (loads after CDN scripts) ─────────────\n// Waits for CDN scripts (GSAP, ScrollTrigger, Lenis) with 5s timeout.\n// If CDN is unreachable, gracefully degrades to static visuals.\n\nif (window.__cdnReady) {\n  window.__cdnReady.then(() => {\n    if (typeof gsap !== 'undefined' && typeof ScrollTrigger !== 'undefined') {\n      gsap.registerPlugin(ScrollTrigger);\n    } else {\n      console.warn('GSAP not loaded — scroll choreography disabled');\n      return;\n    }\n\n    // Lenis smooth scroll\n    if (typeof Lenis !== 'undefined') {\n      const lenis = new Lenis();\n      lenis.on('scroll', ScrollTrigger.update);\n      gsap.ticker.add((time) => lenis.raf(time * 1000));\n      gsap.ticker.lagSmoothing(0);\n    }\n\n    // Replace IntersectionObserver with ScrollTrigger for playground\n    if (_pgObserver) {\n      _pgObserver.disconnect();\n      _pgObserver = null;\n    }\n    initPlaygroundScrollTrigger();\n\n    // Full scroll choreography\n    initOpening(pool, createHero);\n    initScrollProgress();\n    initHero(pool);\n    initMorph(pool, createHero);\n    initTriptych(pool);\n    initCascade(pool, c2d);\n    initEnergy(pool);\n    initAgent(pool);\n    initCTA(pool);\n    initSectionReveals();\n    initSectionVeils();\n    initScrollColorTheme();\n    initBlurReveals();\n    initScrollVelocityBurst(c2d);\n    initPhaseShiftBridges(pool, c2d);\n    initSpeedCrescendo(pool);\n    initOverlayChoreography(pool);\n    initRevealChoreography();\n\n    // Energy card tilt adapter lifecycle\n    ScrollTrigger.create({\n      trigger: '#energySection', start: 'top 80%', end: 'bottom top',\n      onEnter: () => {\n        const adapter = pool.get('energyCard');\n        if (tiltSystem && adapter) {\n          tiltSystem.setAdapter(document.getElementById('energyCard'), adapter);\n        }\n      },\n    });\n  });\n} else {\n  console.warn('CDN loader not available — scroll choreography disabled');\n}\n"],"names":["ContextPool","max","key","_a","canvasId","Factory","opts","oldest","adapter","e","entry","canvas","gl","ext","old","parent","el","fresh","parentEl","dpr","DEFAULT_PARAMS","LAYER_ROLES","createLayerCanvases","parentCanvasId","placeholder","w","h","canvases","createdEls","role","zIndex","opacity","destroyLayerCanvases","wireInteraction","onMove","onLeave","handlers","t","r","unwireInteraction","observeResize","onResize","obs","QuantumAdapter","QuantumEngine","x","y","i","c","k","v","o","_b","HolographicAdapter","RealHolographicSystem","FacetedAdapter","FacetedSystem","_c","AmbientLattice","p","time","ctx","geo","base","core","cx","cy","sc","density","dim","sat","mx","my","mouseShift","bgR","bg","nebulaAlpha","n","nAng","nR","nx","ny","nGrad","nHue","halfDensity","f","ang","hShift","w4","pf","strokeAlpha","fillAlpha","warpHue","hR","wobble","a","glowR","glowGrad","glowHue","glowCount","gx","gy","dotR","dotGrad","edgeCount","sides","j","s","rot","s2","off","wobX","wobY","tr","to","tx","ty","kt","kr","twist","kx","ky","fl","fa","depth","wf","wave1","wave2","wy","cl","ca","ci","a2","len","prevA","prevLen","size","angle","CardTiltSystem","options","config","onEnter","onTouchMove","lastY","onScroll","now","dt","newY","rawV","tick","spd","cfg","rotY","rotX","scrollT","scrollPush","scrollTy","totalRotX","intensity","scrollIntensity","combinedIntensity","scrollRot","speedBoost","_d","_e","heroParams","morphStages","trinityParams","energyCardParams","playgroundDefaults","openingParams","parallaxParams","morphFactories","morphCurrent","morphSwapLock","morphLastStage","smoothstep","lerp","b","clamp01","updateDepthShadow","depthFactor","updateVignette","d","updateChroma","container","rotSpd","updateGlowSeam","seamEl","cA","cB","energy","hue","updateScanlines","line","exponentialBuild","progress","logarithmicCalm","l","interpolateStages","stageA","stageB","smooth","createMorphSystem","pool","sysIdx","initParams","swapMorphSystem","newIdx","flash","safetyTimer","updateMorphUI","stageIdx","stage","titleEl","subEl","counterEl","initScrollProgress","initOpening","createHero","overlay","chars","lattice1","lattice2","lattice3","openingSub","self","vignette","scanlines","canvasWrap","wave","speed","chaos","breathe","textIn","textOut","charP","ease","maskIn","maskOut","subIn","subOut","latticeP","lockP","rot2","rot3","initScrollColorTheme","initBlurReveals","initHero","tl","title","text","char","hero","late","burst","initMorph","morphCard","morphVoices","morphFill","NUM_STAGES","stageFloat","localP","targetSys","nextIdx","params","pulse","morphShadow","delay","show","cardW","cardH","initTriptych","left","right","centerInitParams","acquireAll","releaseAll","center","triSeamL","triSeamR","triVigL","triVigC","triVigR","triShadL","triShadR","root","splitLeft","splitRight","conv","cSplitLeft","cSplitRight","depthL","depthC","depthR","applyDepthCSS","scale","blur","denFromDepth","heartbeat","convergence","baseHue","hueL","hueC","hueR","denL","denC","denR","intL","intC","intR","rotBase","xwL","xwC","xwR","chaosL","speedC","morphR","sharedSpeed","swapChaos","triL","triC","triR","initCascade","c2d","cascadeCards","cascadeTrack","gpuLeftWrap","gpuRightWrap","SHAPES","lerpShape","pt","shapeSeq","card","inst","rect","N","totalScroll","activeIdx","activeHue","sharedXW","gpuL","gpuR","casSeam","casVignette","aCard","aGeo","aHue","cardApproach","splitPct","dist","ripple","phaseOffset","isActive","tiltY","tiltX","tiltZ","dir","tiltStrength","wrap","frame","clipVal","phase","segIdx","segT","inset","echoOff","a1","a3","rOff","hueBleed","echoWave","echo","initEnergy","energyBgInitParams","energyCard","pinnedTl","energyBgWrap","energyCardShadow","energyBgVignette","cardDepth","bgDepth","bgDensity","cardDensity","bgHue","depthDiff","energyBtn","energyFill","energySweep","sweeping","initAgent","agent","initCTA","ctaSeam","ctaVignette","ctaLeftWrap","ctaRightWrap","ctaL","ctaR","unifiedHue","unifiedGeo","crossoverIntensity","topR","botL","blendP","overlap","maxDenBoth","initSectionVeils","portals","oldVeil","trigger","nextSection","divider","next","bell","svg","reveal","initScrollVelocityBurst","lastScroll","lastTime","burstActive","burstCooldown","VELOCITY_THRESHOLD","BURST_DECAY","scrollY","velocity","burstFactor","origParams","orig","initPhaseShiftBridges","sp","initSpeedCrescendo","build","rebirth","initSectionReveals","agentCards","block","ctaContent","ctaTl","ctrlGroups","div","footer","GradientWashLayer","containerId","scrollProgress","alpha","light","rotation","EdgeGlowRing","targetId","glowSize","ParticleField","randomStart","dx","dy","dur","hueShift","shift","CrossfadeBridge","outAdapter","inAdapter","bellSq","fadeOut","fadeIn","_f","AccentChoreographer","layer","bridge","_","TransitionRipple","yPercent","maxDim","MultiInstanceOverlay","sourceCanvasId","echoCanvas","scaleFactor","idx","drift","chaosScale","rotZ","initOverlayChoreography","choreo","heroWash","heroGlow","morphWash","morphEchoes","triParticles","energyWash","energyCardGlow","ctaEchoes","ctaWash","agentParticles","heroMorphBridge","morphPlayBridge","casEnergyBridge","yPct","adapterKeys","lastQFrame","quaternionCSSBridge","initRevealChoreography","createParallaxField","createSectionTransitions","createFloatingAccents","createGlowLines","field","createIrisTransition","createDiagonalBarTransition","createColumnSplitTransition","createGlassPanelTransition","createBezelBarTransition","createCheckerboardTransition","triggerSel","nextSel","iris","ring","maxR","bars","bar","yPos","stagger","cols","col","positions","panels","pos","panel","prop","val","di","isVert","enterVal","exitVal","checker","tiles","tile","accents","colorMap","strip","section","tiltSystem","pgFactories","pgNames","pgSystemIdx","getPlayground","acquirePlayground","errEl","readSliderValues","releasePlayground","switchPlaygroundSystem","param","input","geoSelect","initAmbientCanvases","initTiltSystem","initPlaygroundControls","valEl","pg","geoVal","btn","sliderRanges","defaultSliders","setAllSliders","values","randomized","lo","hi","initPlaygroundScrollTrigger","mouseState","initGlobalMouseReactivity","updateMouse","clientX","clientY","feedMouseToRenderers","gpuKeys","renderLoop","ts","_pgObserver","pgSection","openingSection","lenis"],"mappings":"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"}