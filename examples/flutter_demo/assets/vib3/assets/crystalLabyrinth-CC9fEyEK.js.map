{"version":3,"file":"crystalLabyrinth-CC9fEyEK.js","sources":["../../src/experimental/GameLoop.js","../../src/experimental/LatticePhysics.js","../../src/experimental/PlayerController4D.js","../../src/experimental/LiveDirector.js","../../src/experimental/demos/CrystalLabyrinth.js"],"sourcesContent":["/**\n * GameLoop - Fixed-Timestep Physics Loop\n * \n * Provides a robust game loop that decouples physics updates (fixed step)\n * from rendering (variable step). This is crucial for consistent physics\n * and smooth rendering across different device capabilities.\n *\n * @experimental\n */\nexport class GameLoop {\n    /**\n     * @param {function(number)} updateFn - Physics update (fixed dt)\n     * @param {function(number)} renderFn - Render update (interpolated alpha)\n     * @param {number} step - Physics step size in seconds (default 1/60)\n     */\n    constructor(updateFn, renderFn, step = 1 / 60) {\n        this.updateFn = updateFn;\n        this.renderFn = renderFn;\n        this.step = step;\n        this.dt = 0;\n        this.last = 0;\n        this.now = 0;\n        this.accumulator = 0;\n        this.running = false;\n        this.rafId = null;\n\n        // Bind loop\n        this.frame = this.frame.bind(this);\n    }\n\n    start() {\n        if (this.running) return;\n        this.running = true;\n        this.last = performance.now();\n        this.accumulator = 0;\n        this.rafId = requestAnimationFrame(this.frame);\n        console.log('GameLoop: Started.');\n    }\n\n    stop() {\n        this.running = false;\n        if (this.rafId) {\n            cancelAnimationFrame(this.rafId);\n            this.rafId = null;\n        }\n        console.log('GameLoop: Stopped.');\n    }\n\n    frame(timestamp) {\n        if (!this.running) return;\n\n        this.now = timestamp;\n        // Cap dt to avoid \"spiral of death\" on lag spikes (max 1s)\n        this.dt = Math.min(1, (this.now - this.last) / 1000);\n        this.last = this.now;\n\n        this.accumulator += this.dt;\n\n        // Consume accumulator in fixed steps\n        while (this.accumulator >= this.step) {\n            this.updateFn(this.step);\n            this.accumulator -= this.step;\n        }\n\n        // Render with interpolation factor alpha\n        // alpha = accumulator / step\n        // Allows renderer to interpolate between previous and current physics state\n        this.renderFn(this.accumulator / this.step);\n\n        this.rafId = requestAnimationFrame(this.frame);\n    }\n}\n","/**\n * LatticePhysics - Function-Based Collision Detection\n * \n * Provides a physics engine for \"Lattice Worlds\" where geometry is defined\n * by mathematical density functions (SDFs, fractals).\n *\n * @experimental\n */\nexport class LatticePhysics {\n    constructor() {\n        this.gravity = 9.8; // m/sÂ²\n        this.friction = 0.95; // Velocity decay per step\n        this.densityThreshold = 0.8; // Collision threshold (0-1)\n    }\n\n    /**\n     * Update physics for all entities in the universe.\n     * @param {Map<string, object>} entities \n     * @param {number} dt \n     */\n    update(entities, dt) {\n        entities.forEach(entity => {\n            if (entity.physics && entity.active) {\n                this.updateEntity(entity, dt);\n            }\n        });\n    }\n\n    /**\n     * Update a single entity's physics state.\n     * @param {object} entity \n     * @param {number} dt \n     */\n    updateEntity(entity, dt) {\n        const { pos, vel, acc } = entity.physics;\n\n        // Apply forces (Gravity)\n        // In this abstract world, gravity pulls \"down\" in Y\n        acc.y -= this.gravity * dt;\n\n        // Integrate Velocity (Euler)\n        vel.x += acc.x * dt;\n        vel.y += acc.y * dt;\n        vel.z += acc.z * dt;\n\n        // Reset acceleration (forces are transient)\n        acc.x = 0; acc.y = 0; acc.z = 0;\n\n        // Collision Check (Projected Position)\n        const nextX = pos.x + vel.x * dt;\n        const nextY = pos.y + vel.y * dt;\n        const nextZ = pos.z + vel.z * dt;\n\n        // Sample density at next position\n        const density = this.getDensityAt(nextX, nextY, nextZ);\n\n        if (density > this.densityThreshold) {\n            // Collision!\n            // Simple response: Stop velocity component and push out\n            // A real engine would calculate surface normal from gradient\n            \n            // Simplified: Just stop movement and bounce slightly\n            vel.x *= -0.5;\n            vel.y *= -0.5;\n            vel.z *= -0.5;\n            \n            // Don't update position into solid\n        } else {\n            // Move freely\n            pos.x = nextX;\n            pos.y = nextY;\n            pos.z = nextZ;\n        }\n\n        // Apply Friction (Air/Ether drag)\n        vel.x *= this.friction;\n        vel.y *= this.friction;\n        vel.z *= this.friction;\n    }\n\n    /**\n     * Sample the \"world density\" at a given point.\n     * This mimics the shader's generation logic (e.g., fractal noise).\n     * @param {number} x \n     * @param {number} y \n     * @param {number} z \n     * @returns {number} Density 0.0 to 1.0\n     */\n    getDensityAt(x, y, z) {\n        // Mock function: simple floor plane at y = -2\n        if (y < -2) return 1.0;\n        \n        // Mock function: occasional \"floating islands\" based on sine waves\n        // simulating the VIB3 lattice structure\n        const noise = (Math.sin(x * 0.5) + Math.cos(z * 0.5)) * 0.5 + 0.5;\n        if (y > 0 && y < 1 && noise > 0.8) return 1.0;\n\n        return 0.0;\n    }\n}\n","/**\n * PlayerController4D - Navigation in Hyperspace\n * \n * Maps 2D/3D inputs (WASD, Mouse) into 4D motion vectors (X, Y, Z, W).\n * Handles movement, strafing, and \"portal rotation\" (XW/YW planes).\n *\n * @experimental\n */\nexport class PlayerController4D {\n    /**\n     * @param {HTMLElement} domElement - Element to listen for events on\n     * @param {object} engine - VIB3Engine instance to drive\n     */\n    constructor(domElement, engine) {\n        this.domElement = domElement;\n        this.engine = engine;\n        \n        // Input State\n        this.keys = { \n            w: false, a: false, s: false, d: false, \n            q: false, e: false, space: false, shift: false \n        };\n        \n        this.mouse = {\n            dx: 0, dy: 0, \n            down: false\n        };\n\n        // Player Physics State\n        this.velocity = { x: 0, y: 0, z: 0, w: 0 };\n        this.rotation = { x: 0, y: 0 }; // Looking direction (Pitch/Yaw)\n        this.portalRot = 0; // XW plane rotation\n\n        // Config\n        this.speed = 5.0;\n        this.sensitivity = 0.002;\n        this.damping = 0.9;\n\n        // Bind events\n        this.onKeyDown = this.onKeyDown.bind(this);\n        this.onKeyUp = this.onKeyUp.bind(this);\n        this.onMouseMove = this.onMouseMove.bind(this);\n        this.onMouseDown = this.onMouseDown.bind(this);\n        this.onMouseUp = this.onMouseUp.bind(this);\n        \n        this.setupListeners();\n    }\n\n    setupListeners() {\n        window.addEventListener('keydown', this.onKeyDown);\n        window.addEventListener('keyup', this.onKeyUp);\n        this.domElement.addEventListener('mousemove', this.onMouseMove);\n        this.domElement.addEventListener('mousedown', this.onMouseDown);\n        this.domElement.addEventListener('mouseup', this.onMouseUp);\n    }\n\n    onKeyDown(e) {\n        const k = e.key.toLowerCase();\n        if (this.keys.hasOwnProperty(k)) this.keys[k] = true;\n    }\n    \n    onKeyUp(e) {\n        const k = e.key.toLowerCase();\n        if (this.keys.hasOwnProperty(k)) this.keys[k] = false;\n    }\n\n    onMouseDown() { this.mouse.down = true; }\n    onMouseUp() { this.mouse.down = false; }\n    \n    onMouseMove(e) {\n        if (this.mouse.down) {\n            this.mouse.dx += e.movementX;\n            this.mouse.dy += e.movementY;\n        }\n    }\n\n    /**\n     * Update loop called by GameLoop.\n     * @param {number} dt \n     */\n    update(dt) {\n        // 1. Process Rotation (Mouse)\n        this.rotation.y -= this.mouse.dx * this.sensitivity; // Yaw\n        this.rotation.x -= this.mouse.dy * this.sensitivity; // Pitch\n        \n        // Clamp pitch to avoid flipping\n        this.rotation.x = Math.max(-Math.PI/2, Math.min(Math.PI/2, this.rotation.x));\n        \n        // Reset mouse delta (consumed)\n        this.mouse.dx = 0;\n        this.mouse.dy = 0;\n\n        // 2. Process Movement (WASD)\n        // Forward vector derived from Yaw\n        const fwdX = Math.sin(this.rotation.y);\n        const fwdZ = Math.cos(this.rotation.y);\n        const rightX = Math.cos(this.rotation.y); // Perpendicular\n        const rightZ = -Math.sin(this.rotation.y);\n\n        const moveSpeed = this.speed * dt;\n        \n        if (this.keys.w) {\n            this.velocity.x += fwdX * moveSpeed;\n            this.velocity.z -= fwdZ * moveSpeed; // WebGL Z is negative forward\n        }\n        if (this.keys.s) {\n            this.velocity.x -= fwdX * moveSpeed;\n            this.velocity.z += fwdZ * moveSpeed;\n        }\n        if (this.keys.a) {\n            this.velocity.x -= rightX * moveSpeed;\n            this.velocity.z += rightZ * moveSpeed;\n        }\n        if (this.keys.d) {\n            this.velocity.x += rightX * moveSpeed;\n            this.velocity.z -= rightZ * moveSpeed;\n        }\n        \n        // Vertical Movement (Space/Shift)\n        if (this.keys.space) this.velocity.y += moveSpeed;\n        if (this.keys.shift) this.velocity.y -= moveSpeed;\n\n        // 4D Portal Rotation (Q/E)\n        if (this.keys.q) this.portalRot -= moveSpeed;\n        if (this.keys.e) this.portalRot += moveSpeed;\n\n        // Apply Damping (Friction)\n        this.velocity.x *= this.damping;\n        this.velocity.y *= this.damping;\n        this.velocity.z *= this.damping;\n\n        // 3. Apply to VIB3Engine Parameters\n        // Map 4D position to shader uniforms (e.g., u_noiseOffset or camera pos)\n        // Here we map to rotation parameters as a proxy for camera movement\n        \n        // Visual feedback: Velocity tilts the view\n        this.engine.setParameter('rot4dXY', this.rotation.y + this.velocity.x * 0.1);\n        this.engine.setParameter('rot4dYZ', this.rotation.x + this.velocity.y * 0.1);\n        \n        // Portal rotation affects XW plane\n        this.engine.setParameter('rot4dXW', this.portalRot);\n\n        // \"Moving forward\" increases grid density/scale to simulate zooming through\n        // In a real implementation, we'd update a u_cameraPosition uniform\n    }\n    \n    destroy() {\n        window.removeEventListener('keydown', this.onKeyDown);\n        window.removeEventListener('keyup', this.onKeyUp);\n        this.domElement.removeEventListener('mousemove', this.onMouseMove);\n        this.domElement.removeEventListener('mousedown', this.onMouseDown);\n        this.domElement.removeEventListener('mouseup', this.onMouseUp);\n    }\n}\n","/**\n * LiveDirector - Autonomous Creative Agent\n * \n * An AI agent that analyzes user input (\"Audience Reaction\") and adjusts the\n * VIB3Universe in real-time to maintain engagement, flow, and narrative tension.\n *\n * @experimental\n */\nexport class LiveDirector {\n    constructor(universe) {\n        this.universe = universe;\n        this.active = false;\n        \n        // Audience State\n        this.audience = {\n            energy: 0.5, // 0.0 (Bored) -> 1.0 (Excited)\n            attention: 0.8, // 0.0 (Distracted) -> 1.0 (Focused)\n            sentiment: 0.0, // -1.0 (Negative) -> 1.0 (Positive)\n        };\n        \n        // Directing State\n        this.pacing = 'build'; // 'intro', 'build', 'climax', 'resolve'\n        this.lastActionTime = 0;\n        this.decisionInterval = 2000; // ms\n        \n        // Bind methods\n        this.update = this.update.bind(this);\n    }\n\n    /**\n     * Start the director loop.\n     */\n    start() {\n        if (this.active) return;\n        this.active = true;\n        this.lastActionTime = performance.now();\n        requestAnimationFrame(this.update);\n        console.log('LiveDirector: Started directing.');\n    }\n\n    /**\n     * Stop the director loop.\n     */\n    stop() {\n        this.active = false;\n        console.log('LiveDirector: Stopped directing.');\n    }\n\n    /**\n     * Feed audience input signal.\n     * @param {string} type - 'audio', 'video', 'input'\n     * @param {object} data - Analysis data\n     */\n    feedInput(type, data) {\n        if (type === 'audio') {\n            // Loud audio = high energy\n            this.audience.energy = Math.min(1.0, this.audience.energy + data.volume * 0.1);\n        } else if (type === 'input') {\n            // Interaction = high attention\n            this.audience.attention = Math.min(1.0, this.audience.attention + 0.05);\n        }\n        \n        // Decay logic runs in update loop\n    }\n\n    /**\n     * Main decision loop.\n     * @param {number} timestamp \n     */\n    update(timestamp) {\n        if (!this.active) return;\n        \n        const dt = (timestamp - this.lastActionTime);\n        \n        // Decay audience metrics over time\n        this.audience.energy = Math.max(0, this.audience.energy - 0.001);\n        this.audience.attention = Math.max(0, this.audience.attention - 0.0005);\n        \n        // Make a directing decision periodically\n        if (dt > this.decisionInterval) {\n            this.makeDecision();\n            this.lastActionTime = timestamp;\n        }\n        \n        requestAnimationFrame(this.update);\n    }\n\n    /**\n     * The \"Brain\" of the Director.\n     * Decides what to change based on current state.\n     */\n    makeDecision() {\n        const { energy, attention } = this.audience;\n        \n        console.log(`LiveDirector: Audience state - Energy: ${energy.toFixed(2)}, Attention: ${attention.toFixed(2)}`);\n        \n        // Strategy: Maintain a \"Sine Wave\" of tension\n        // If energy is too low, spike it. If too high, calm it down.\n        \n        if (attention < 0.3) {\n            // Lost attention -> TRIGGER EVENT\n            this.triggerEvent('focus_snap');\n        } else if (energy < 0.2) {\n            // Boring -> INCREASE INTENSITY\n            this.adjustGlobalParams({ speed: 1.5, chaos: 0.4 });\n        } else if (energy > 0.8) {\n            // Too frantic -> CALM DOWN\n            this.adjustGlobalParams({ speed: 0.5, chaos: 0.1 });\n        } else {\n            // Just right -> DO NOTHING or subtle shift\n            // Maybe drift hue slightly?\n        }\n    }\n\n    /**\n     * Execute a parameter adjustment across all actors.\n     * @param {object} params \n     */\n    adjustGlobalParams(params) {\n        console.log('LiveDirector: Adjusting global parameters', params);\n        this.universe.actors.forEach(actor => {\n            if (actor.animator) {\n                actor.animator.transition(params, 2000, 'easeInOut');\n            }\n        });\n    }\n\n    /**\n     * Trigger a specific scripted event.\n     * @param {string} eventName \n     */\n    triggerEvent(eventName) {\n        console.log(`LiveDirector: Triggering event '${eventName}'`);\n        // Example: Flash screen, spawn particle burst, etc.\n        if (eventName === 'focus_snap') {\n             // Quick snap zoom / flash\n             this.adjustGlobalParams({ intensity: 1.0, speed: 0.0 });\n             setTimeout(() => {\n                 this.adjustGlobalParams({ intensity: 0.5, speed: 1.0 });\n             }, 200);\n        }\n    }\n}\n","/**\n * CrystalLabyrinth.js - Vertical Slice Demo\n * \n * Implements the full \"Ultra\" stack:\n * - VIB3Universe (Multi-instance)\n * - VIB3Orchestrator (Game Loop)\n * - VIB3Compositor (Visuals)\n * - LatticePhysics (4D Collision)\n * - PlayerController4D (Input)\n * - LiveDirector (AI Pacing)\n *\n * @experimental\n */\nimport { VIB3Universe } from '../VIB3Universe.js';\nimport { GameLoop } from '../GameLoop.js';\nimport { LatticePhysics } from '../LatticePhysics.js';\nimport { PlayerController4D } from '../PlayerController4D.js';\nimport { LiveDirector } from '../LiveDirector.js';\n\nclass CrystalLabyrinthGame {\n    constructor() {\n        this.universe = new VIB3Universe('vib3-universe');\n        this.physics = new LatticePhysics();\n        this.director = new LiveDirector(this.universe);\n        \n        // Game State\n        this.score = 0;\n        this.health = 100;\n        this.isPlaying = false;\n        \n        // Entities\n        this.player = null; // The \"Camera\"\n        this.crystals = [];\n        this.shadows = [];\n\n        // UI\n        this.ui = {\n            score: document.getElementById('score'),\n            health: document.getElementById('health'),\n            overlay: document.getElementById('overlay'),\n            startBtn: document.getElementById('start-btn')\n        };\n\n        // Bind input\n        this.controller = new PlayerController4D(document.body, {\n            setParameter: (k, v) => this.updatePlayerView(k, v)\n        });\n\n        // Setup Loop\n        this.loop = new GameLoop(\n            (dt) => this.update(dt),\n            (alpha) => this.render(alpha)\n        );\n\n        this.init();\n    }\n\n    async init() {\n        // Create the \"World\" (Background Layer)\n        // A deep, slow-moving Holographic system representing the void\n        const world = await this.universe.spawnActor({\n            personality: 'neutral',\n            system: 'holographic',\n            geometry: 11, // Hypersphere\n            layer: { zIndex: 0, opacity: 0.4 }\n        });\n        \n        // Setup UI listeners\n        this.ui.startBtn.addEventListener('click', () => this.start());\n    }\n\n    start() {\n        this.isPlaying = true;\n        this.ui.overlay.classList.add('hidden');\n        \n        // Start Systems\n        this.universe.start();\n        this.loop.start();\n        this.director.start();\n        \n        // Spawn Level\n        this.spawnLevel();\n    }\n\n    async spawnLevel() {\n        // Spawn 5 Crystals (Pickups)\n        for (let i = 0; i < 5; i++) {\n            const crystal = await this.universe.spawnActor({\n                personality: 'heroic', // Bright, positive\n                system: 'faceted',\n                geometry: 7, // Crystal\n                layer: { zIndex: 10, blendMode: 'screen', opacity: 0.9 }\n            });\n            \n            // Random position in 4D space (mock)\n            crystal.physics = {\n                pos: { \n                    x: (Math.random() - 0.5) * 20,\n                    y: (Math.random() - 0.5) * 5,\n                    z: (Math.random() - 0.5) * 20 \n                },\n                vel: { x: 0, y: 0, z: 0 },\n                acc: { x: 0, y: 0, z: 0 }\n            };\n            \n            this.crystals.push(crystal);\n        }\n\n        // Spawn 3 Shadows (Enemies)\n        for (let i = 0; i < 3; i++) {\n            const shadow = await this.universe.spawnActor({\n                personality: 'glitch', // Chaotic, negative\n                system: 'quantum',\n                geometry: 16, // Spiky\n                layer: { zIndex: 5, blendMode: 'multiply', opacity: 0.7 }\n            });\n            \n            shadow.physics = {\n                pos: { x: 0, y: 0, z: -30 }, // Start far away\n                vel: { x: 0, y: 0, z: 0 },\n                acc: { x: 0, y: 0, z: 0 }\n            };\n            \n            this.shadows.push(shadow);\n        }\n    }\n\n    /**\n     * Physics Update (Fixed Timestep)\n     */\n    update(dt) {\n        if (!this.isPlaying) return;\n\n        // 1. Update Player Controls\n        this.controller.update(dt);\n        \n        // 2. Update Physics World\n        // Sync player controller state to physics engine?\n        // For now, controller handles movement directly.\n        \n        // 3. AI Logic (Shadows hunt player)\n        this.shadows.forEach(shadow => {\n            // Move towards player (0,0,0 relative to camera)\n            // In a real engine, we'd have absolute coordinates.\n            // Here, we simulate relative motion by updating parameters\n            \n            // Mock: Oscillate shadow intensity based on \"proximity\"\n            shadow.emote('panic', 0.5); \n        });\n\n        // 4. Check Collisions (Mock)\n        // If player is close to a crystal -> Collect\n        if (Math.random() < 0.005 && this.crystals.length > 0) {\n            this.collectCrystal(this.crystals.pop());\n        }\n    }\n\n    /**\n     * Render Update (Variable Timestep)\n     */\n    render(alpha) {\n        // Visual interpolation could happen here\n    }\n\n    updatePlayerView(key, value) {\n        // Broadcast player view changes to the World actor\n        // This makes the world rotate around the player\n        const world = this.universe.actors.get(this.universe.orchestrator.entities.keys().next().value);\n        if (world && world.engine) {\n            world.engine.setParameter(key, value);\n        }\n    }\n\n    collectCrystal(actor) {\n        this.score++;\n        this.ui.score.innerText = this.score;\n        \n        // FX\n        actor.emote('joy', 1.0, 500);\n        setTimeout(() => {\n            this.universe.despawnActor(actor.id);\n        }, 500);\n\n        if (this.score >= 5) {\n            this.win();\n        }\n    }\n\n    win() {\n        this.isPlaying = false;\n        this.ui.overlay.innerHTML = `\n            <h1 style=\"color: #0f0; text-shadow: 0 0 20px #0f0;\">SECTOR STABILIZED</h1>\n            <p>The lattice is secure.</p>\n            <button onclick=\"location.reload()\">Re-enter</button>\n        `;\n        this.ui.overlay.classList.remove('hidden');\n        this.loop.stop();\n    }\n}\n\n// Start Game\nnew CrystalLabyrinthGame();\n"],"names":["GameLoop","updateFn","renderFn","step","timestamp","LatticePhysics","entities","dt","entity","pos","vel","acc","nextX","nextY","nextZ","x","y","z","noise","PlayerController4D","domElement","engine","e","k","fwdX","fwdZ","rightX","rightZ","moveSpeed","LiveDirector","universe","type","data","energy","attention","params","actor","eventName","CrystalLabyrinthGame","VIB3Universe","v","alpha","i","crystal","shadow","key","value","world"],"mappings":"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"}